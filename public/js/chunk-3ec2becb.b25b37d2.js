(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ec2becb"],{1990:function(e,t,n){},5257:function(e,t,n){"use strict";var r=n("5530"),a=(n("caad"),n("2532"),n("b64b"),n("ac1f"),n("5319"),n("4de4"),n("d3b7"),n("6c02")),c=n("7a23");t["a"]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(a["d"])(),n=Object(a["c"])();e||(console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: "fieldname", desc: boolean}'),e=e||{field:"name",desc:!1});var o=Object(c["computed"])({immediate:!0,get:function(){return Object.keys(n.query).includes("sort-field")?{field:n.query["sort-field"],desc:Boolean(parseInt(n.query["sort-desc"]))}:e},set:function(e){var a={"sort-field":e.field,"sort-desc":e.desc?1:0},c=Object(r["a"])(Object(r["a"])({},n.query),a);t.replace({path:n.path,query:c})}}),l=Object(c["computed"])({set:function(e){var a=n.query,c=n.path,o=Object(r["a"])({},a);e?o=Object(r["a"])(Object(r["a"])({},a),{filter:e}):delete o.filter,t.replace({path:c,query:o})},get:function(){return n.query.filter},immediate:!0});return{sort:o,filter:l}}},b71e:function(e,t,n){"use strict";n("1990")},df40:function(e,t,n){"use strict";n.r(t);n("4e82"),n("4de4"),n("d3b7"),n("b0c0");var r=n("7a23"),a=Object(r["createElementVNode"])("h1",null,"Mail Log",-1),c={class:"mb-2"},o=Object(r["createTextVNode"])("Filter: "),l={key:0},i=["onClick"];function s(e,t,n,s,d,u){var b=Object(r["resolveComponent"])("data-table"),m=Object(r["resolveComponent"])("mail-detail"),f=Object(r["resolveComponent"])("modal-dialog"),p=Object(r["resolveComponent"])("custom-email-form");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[a,Object(r["createVNode"])(b,{fields:d.fields,data:u.getPage,"row-class":"cursor-pointer","row-click-handler":u.showMailDetail,sort:s.sort,"onUpdate:sort":t[1]||(t[1]=function(e){return s.sort=e}),"page-size":20,paginated:"",ref:"dataTable"},{header:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",c,[o,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return s.filter=e})},null,512),[[r["vModelText"],s.filter]])])]})),"cell-to":Object(r["withCtx"])((function(e){var t=e.item;return[Object(r["createElementVNode"])("ul",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.to,(function(e){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:e.address},[e.name?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",l,Object(r["toDisplayString"])(e.name)+" - ",1)):Object(r["createCommentVNode"])("",!0),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.address),1)])})),128))])]})),"cell-actions":Object(r["withCtx"])((function(t){var n=t.item;return[Object(r["createElementVNode"])("div",null,[e.hasPermission("people-manage")?(Object(r["openBlock"])(),Object(r["createElementBlock"])("button",{key:0,class:"btn btn-xs",onClick:Object(r["withModifiers"])((function(e){return u.initResend(n)}),["stop"])},"Resend",8,i)):Object(r["createCommentVNode"])("",!0)])]})),_:1},8,["fields","data","row-click-handler","sort"]),(Object(r["openBlock"])(),Object(r["createBlock"])(r["Teleport"],{to:"body"},[Object(r["createVNode"])(f,{modelValue:d.showDetail,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d.showDetail=e})},{default:Object(r["withCtx"])((function(){return[e.hasPermission("people-manage")?(Object(r["openBlock"])(),Object(r["createBlock"])(m,{key:0,mail:d.currentEmail,onResend:t[2]||(t[2]=function(e){return u.initResend(d.currentEmail)})},null,8,["mail"])):Object(r["createCommentVNode"])("",!0)]})),_:1},8,["modelValue"]),Object(r["createVNode"])(f,{title:"Resend Email",modelValue:d.showResendDialog,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d.showResendDialog=e})},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(p,{"mail-data":d.currentEmail,onSent:u.cleanupResend,onCanceled:u.cleanupResend},null,8,["mail-data","onSent","onCanceled"])]})),_:1},8,["modelValue"])]))])}var d=n("1da1"),u=(n("96cf"),n("b64b"),n("a15b"),n("f96b")),b=n("85b1"),m=n("e328"),f=n("5257"),p={props:{},setup:function(){var e=Object(f["a"])({field:"created_at",desc:!0}),t=e.sort,n=e.filter;return{sort:t,filter:n}},data:function(){return{showDetail:!1,fields:[{name:"to",sortable:!0,type:Array,resolveValue:function(e){var t=Object.keys(e.to);return 0==t.length?"":1==t.length?t[0]:t.join("; ")}},{name:"subject",sortable:!0,type:String},{name:"created_at",label:"Sent at",sortable:!0,resolveValue:function(e){return Object(m["c"])(e.created_at)},resolveSort:function(e){return e.created_at},type:String},{name:"actions",label:"",sortable:!1}],data:[],currentEmail:{},showResendDialog:!1}},watch:{filter:{immediate:!0,handler:function(){this.triggerSearch&&this.triggerSearch()}},sort:{deep:!0,immediate:!0,handler:function(){console.log("sorted"),this.triggerSearch&&this.triggerSearch()}}},methods:{getPage:function(e,t,n,r){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function c(){var o,l;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return c.prev=0,o={page:e,page_size:t,"sort[field]":n.field.name,"sort[dir]":n.desc?"DESC":"ASC","where[filterString]":a.filter},c.next=4,u["a"].get("/api/mail-log",{params:o}).then((function(e){return e.data}));case 4:return l=c.sent,r(l.total),c.abrupt("return",l.data);case 9:c.prev=9,c.t0=c["catch"](0),alert(c.t0);case 12:case"end":return c.stop()}}),c,null,[[0,9]])})))()},showMailDetail:function(e){this.currentEmail=e,this.showDetail=!0},initResend:function(e){this.currentEmail=e,this.showResendDialog=!0},cleanupResend:function(){this.currentEmail={},this.showResendDialog=!1,this.getMailLog()}},created:function(){var e=this;this.triggerSearch=Object(b["a"])((function(){return e.$refs.dataTable.getItems()}),500)}},h=(n("b71e"),n("6b0d")),j=n.n(h);const O=j()(p,[["render",s]]);t["default"]=O}}]);
//# sourceMappingURL=chunk-3ec2becb.b25b37d2.js.map