{"version":3,"sources":["webpack:///./src/views/AnnualUpdatesList.vue","webpack:///./src/components/annual_updates/AnnualUpdateTable.vue","webpack:///./src/components/annual_updates/AnnualUpdateTable.vue?1d77","webpack:///./src/views/AnnualUpdatesList.vue?0085","webpack:///./src/composables/router_aware_sort_and_filter.js","webpack:///./src/views/AnnualUpdatesList.vue?62ef"],"names":["class","_createElementBlock","_createElementVNode","_toDisplayString","$options","for_year","_ctx","start","end","$data","length","$event","_Fragment","_renderList","window","value","key","id","_hoisted_3","_createVNode","_component_tabs_container","_component_tab_item","label","_hoisted_4","_createBlock","_component_annual_update_table","items","_hoisted_5","$setup","placeholder","onClick","_component_data_table","data","fields","sort","cell-action","_withCtx","item","_component_router_link","to","name","params","props","type","Array","required","sortable","resolveValue","completed_at","formatDate","computed","completedFilter","get","this","$route","query","completed","set","currentQuery","currentPath","path","updatedQuery","$router","replace","filteredItems","result","JSON","parse","stringify","filter","pattern","RegExp","i","expert_panel","display_name","match","submitter","person","methods","exportData","annual_update_ids","map","api","post","then","response","a","document","createElement","style","display","body","appendChild","href","URL","createObjectURL","Blob","setAttribute","click","removeChild","setup","setupRouterSortAndFilter","field","desc","__exports__","components","AnnualUpdateTable","selectedYear","windows","loading","sortedWindows","orderBy","latestWindow","gcepReviews","expert_panel_type_id","vcepReviews","getWindows","getItems","mounted","render","defaultSort","router","useRouter","route","useRoute","console","log","immediate","Object","keys","includes","Boolean","parseInt","sortObj","newSortQuery","newQuery"],"mappings":"mKAEYA,MAAM,mD,GACRA,MAAM,iB,iPAFdC,gCA8BM,YA7BJC,gCAkBS,SAlBT,EAkBS,CAjBPA,gCAEK,KAFL,EAA0B,uBACLC,6BAAGC,eAAaC,UAAQ,GAgBtC,6BAfF,IACLF,6BAAEG,aAAWF,eAAaG,QAAQ,MAAGJ,6BAAEG,aAAWF,eAAaI,MAAM,IACrE,GAGQC,UAAQC,OAAM,wDAHtBT,gCAYS,U,2DAXEQ,eAAYE,IACrBX,MAAM,uBAFR,6BAKEC,gCAMSW,cAAA,KAAAC,wBAJUT,iBAAa,SAAvBU,G,gCAFTb,gCAMS,UALNc,MAAOD,EAAOT,SAEdW,IAAKF,EAAOG,IAHf,6BAKKH,EAAOT,UAAQ,EAAAa,MALpB,OALF,0BACWT,2DAabU,yBASiBC,EAAA,M,8BARf,iBAGW,CAHXD,yBAGWE,EAAA,CAHDC,MAAM,SAAO,C,8BACrB,iBAAyC,CAA9Bb,oCAAXR,gCAAyC,MAAAsB,EAArB,cAApB,yBACAC,yBAAmDC,EAAA,C,MAAtBC,MAAOtB,eAApC,uB,MAEFe,yBAGWE,EAAA,CAHDC,MAAM,SAAO,C,8BACrB,iBAAyC,CAA9Bb,oCAAXR,gCAAyC,MAAA0B,EAArB,cAApB,yBACAH,yBAAmDC,EAAA,C,MAAtBC,MAAOtB,eAApC,uB,wGC1BKJ,MAAM,wC,GACFA,MAAM,4B,EAOHE,gCAAkC,UAAzBa,MAAO,MAAM,OAAG,G,EACzBb,gCAAwC,UAA/Ba,MAAO,GAAG,gBAAY,G,EAC/Bb,gCAA0C,UAAjCa,MAAO,GAAG,kBAAc,G,GAFjCG,EACAK,EACAI,G,+BAQmE,U,yJAnBnF1B,gCAyBM,YAxBFC,gCAcM,MAdN,EAcM,CAbFA,gCAWM,MAXN,EAWM,6BAVFA,gCAIC,S,qDAHY0B,SAAMjB,IACfkB,YAAY,0BACZ7B,MAAM,QAHV,4BACa4B,YASX,4BALF1B,gCAIS,U,qDAJQE,kBAAeO,IAAEX,MAAM,oBAAxC,2BAAiBI,uBAMrBF,gCAAmE,UAA3DF,MAAM,aAAc8B,QAAK,8BAAE1B,iDAAY,iBAGnDe,yBAMaY,EAAA,CANAC,KAAM5B,gBAAgB6B,OAAQxB,SAAgByB,KAAMN,O,+CAAAA,OAAIjB,KAArE,CACqBwB,cAAWC,sBACxB,gBAD2BC,EAC3B,EAD2BA,KAC3B,MAD+B,CAC/BlB,yBAEcmB,EAAA,CAFAC,GAAE,CAAAC,0BAAAC,QAAAxB,GAA4CoB,EAAKpB,MAAjE,C,8BAAuE,iBAEvE,O,KAFA,iB,KAFR,8B,0KAcO,GACXuB,KAAM,qBACNE,MAAO,CACHhB,MAAO,CACHiB,KAAMC,MACNC,UAAU,IAGlBb,KARW,WAQJ,WACH,MAAO,CACHC,OAAQ,CACJ,CACIO,KAAM,KACNM,UAAU,EACVxB,MAAO,MAEX,CACIkB,KAAM,4BACNlB,MAAO,eACPwB,UAAU,GAEd,CACIN,KAAM,wBACNlB,MAAO,YACPwB,UAAU,GAEd,CACIN,KAAM,eACNlB,MAAO,YACPwB,UAAU,EACVC,aAAc,SAACV,GACX,OAAOA,EAAKW,aAAe,EAAKC,WAAWZ,EAAKW,cAAgB,OAGxE,CACIR,KAAM,SACNlB,MAAO,GACPwB,UAAU,MAQ1BI,SAAU,CACNC,gBAAiB,CACbC,IAAK,WACD,OAAOC,KAAKC,OAAOC,MAAMC,WAAa,MAE1CC,IAAK,SAAU1C,GACX,IAAI2C,EAAeL,KAAKC,OAAOC,MAC3BI,EAAcN,KAAKC,OAAOM,KAE1BC,EAAW,kBAAQH,GAElB3C,EAGD8C,EAAW,iCAAQH,GAAiB,CAAC,UAAa3C,WAF3C8C,EAAaL,UAKxBH,KAAKS,QAAQC,QAAQ,CAACH,KAAMD,EAAaJ,MAAOM,MAGxDG,cApBM,WAoBW,WACTC,EAASC,KAAKC,MAAMD,KAAKE,UAAUf,KAAK3B,QAC5C,GAAmB,MAAf2B,KAAKgB,OAAgB,CACrB,IAAMC,EAAU,IAAIC,OAAJ,YAAgBlB,KAAKgB,OAArB,MAAiC,KACjDJ,EAASZ,KAAK3B,MAAM2C,QAAO,SAAAG,GACvB,OAAOA,EAAEC,aAAaC,aAAaC,MAAML,IACjCE,EAAEI,WAAaJ,EAAEI,UAAUC,QAAUL,EAAEI,UAAUC,OAAOrC,KAAKmC,MAAML,MAYnF,OAR4B,MAAxBjB,KAAKF,kBACLc,EAASA,EAAOI,QAAO,SAAAG,GACnB,OAA4B,GAAxB,EAAKrB,gBACqB,OAAnBqB,EAAExB,aAEY,MAAlBwB,EAAExB,iBAGViB,IAGfa,QAAS,CACLC,WADK,WAED,IAAMC,EAAoB3B,KAAKW,cAAciB,KAAI,SAAAT,GAAA,OAAKA,EAAEvD,MACxDiE,OAAIC,KAAJ,6BAAuC,CAACH,sBACnCI,MAAK,SAAAC,GACF,IAAMC,EAAIC,SAASC,cAAc,KACjCF,EAAEG,MAAMC,QAAU,OAClBH,SAASI,KAAKC,YAAYN,GAE1BA,EAAEO,KAAO/E,OAAOgF,IAAIC,gBAAiB,IAAIC,KAAK,CAACX,EAASrD,KAAM,CAAEW,KAAM,eAEtE2C,EAAEW,aAAa,WAAY,sBAC3BX,EAAEY,QAEFX,SAASI,KAAKQ,YAAYb,QAI1Cc,MAxGW,WAyGP,MAAuBC,eAAyB,CAACC,MAAO,4BAA6BC,MAAM,IAApFrE,EAAP,EAAOA,KAAMmC,EAAb,EAAaA,OAEb,MAAO,CACHnC,OACAmC,Y,qBCxIZ,MAAMmC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS,KAErD,QF2CA,GACbhE,KAAM,oBACNiE,WAAY,CACVC,qBAEF1E,KALa,WAMX,MAAO,CACL2E,aAAc,KACdC,QAAS,GACTlF,MAAO,GACPmF,SAAS,IAGb3D,SAAU,CACR4D,cADQ,WAEN,OAAOC,qBAAQ1D,KAAKuD,QAAS,WAAY,SAE3CI,aAJQ,WAKN,OAAO3D,KAAKyD,cAAc,IAAM,IAElCG,YAPQ,WAQN,OAAO5D,KAAK3B,MAAM2C,QAAO,SAACG,GAAD,OAA8C,GAAvCA,EAAEC,aAAayC,yBAEjDC,YAVQ,WAWN,OAAO9D,KAAK3B,MAAM2C,QAAO,SAACG,GAAD,OAA8C,GAAvCA,EAAEC,aAAayC,0BAGnDpC,QAAS,CACDsC,WADC,WACY,wKACIlC,OAClB9B,IAAI,+BACJgC,MAAK,SAACC,GAAD,OAAcA,EAASrD,QAHd,OACjB,EAAK4E,QADY,OAIjB,EAAKD,aAAe,EAAKK,aAAa3G,SAJrB,8CAMbgH,SAPC,WAOU,+JACf,EAAKR,SAAU,EADA,SAEI3B,OAChB9B,IAAI,uBACJgC,MAAK,SAACC,GAAD,OAAcA,EAASrD,QAJhB,OAEf,EAAKN,MAFU,OAKf,EAAKmF,SAAU,EALA,+CAQnBS,QA1Ca,WA2CXjE,KAAK+D,aACL/D,KAAKgE,a,UGvFT,MAAM,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASE,GAAQ,CAAC,YAAY,qBAE1E,gB,kJCNA,kBAA8B,IAApBC,EAAoB,uDAAN,KAC7BC,EAASC,iBACTC,EAAQC,iBACTJ,IACDK,QAAQC,IAAI,0GACZN,EAAeA,GAA6B,CAAClB,MAAO,OAAQC,MAAM,IAGtE,IAAMrE,EAAOgB,sBAAS,CAClB6E,WAAW,EACX3E,IAFkB,WAGd,OAAI4E,OAAOC,KAAKN,EAAMpE,OAAO2E,SAAS,cAC3B,CACH5B,MAAOqB,EAAMpE,MAAM,cACnBgD,KAAM4B,QAAQC,SAAST,EAAMpE,MAAM,gBAGpCiE,GAEX/D,IAXkB,SAWd4E,GACA,IAAMC,EAAe,CAAC,aAAcD,EAAQ/B,MAAO,YAAa+B,EAAQ9B,KAAO,EAAI,GAE7EgC,EAAW,iCACVZ,EAAMpE,OACN+E,GAGPb,EAAO1D,QAAQ,CAACH,KAAM+D,EAAM/D,KAAML,MAAOgF,OAI3ClE,EAASnB,sBAAS,CACpBO,IADoB,SAChB1C,GACA,IAAI2C,EAAeiE,EAAMpE,MACrBI,EAAcgE,EAAM/D,KAEpBC,EAAe,kBAAIH,GAElB3C,EAGD8C,EAAe,iCAAIH,GAAiB,CAAC,OAAU3C,WAFxC8C,EAAaQ,OAKxBoD,EAAO1D,QAAQ,CAACH,KAAMD,EAAaJ,MAAOM,KAE9CT,IAfoB,WAgBhB,OAAOuE,EAAMpE,MAAMc,QAEvB0D,WAAW,IAGf,MAAO,CACH7F,OACAmC,Y,oCCzDR","file":"js/chunk-0546ba53.5a0cde18.js","sourcesContent":["<template>\n  <div>\n    <header class=\"flex justify-between items-center border-b mb-4\">\n      <h1 class=\"border-0 mb-0\">\n        Annual Updates for {{ latestWindow.for_year }}\n      </h1>\n      {{formatDate(latestWindow.start)}} - {{formatDate(latestWindow.end)}}\n      <select\n        v-model=\"selectedYear\"\n        class=\"font-normal text-md\"\n        v-if=\"windows.length > 1\"\n      >\n        <option\n          :value=\"window.for_year\"\n          v-for=\"window in sortedWindows\"\n          :key=\"window.id\"\n        >\n          {{ window.for_year }}\n        </option>\n      </select>\n    </header>\n    <tabs-container>\n      <tab-item label=\"VCEPS\">\n        <div v-if=\"loading\">Loading&hellip;</div>\n        <annual-update-table v-else :items=\"vcepReviews\" />\n      </tab-item>\n      <tab-item label=\"GCEPS\">\n        <div v-if=\"loading\">Loading&hellip;</div>\n        <annual-update-table v-else :items=\"gcepReviews\" />\n      </tab-item>\n    </tabs-container>\n  </div>\n</template>\n<style lang=\"postcss\" scoped>\n.radio-group > label {\n  @apply border border-gray-400 px-2 py-1 mb-0;\n}\n.radio-group > label:first-child {\n  @apply rounded-l-lg border-r-0;\n}\n.radio-group > label:last-child {\n  @apply rounded-r-lg border-l-0;\n}\n</style>\n<script>\nimport { api } from \"@/http\";\nimport { orderBy } from \"lodash\";\n\nimport AnnualUpdateTable from \"@/components/annual_updates/AnnualUpdateTable\";\n\nexport default {\n  name: \"AnnualUpdatesList\",\n  components: {\n    AnnualUpdateTable,\n  },\n  data() {\n    return {\n      selectedYear: null,\n      windows: [],\n      items: [],\n      loading: false,\n    };\n  },\n  computed: {\n    sortedWindows() {\n      return orderBy(this.windows, \"for_year\", \"desc\");\n    },\n    latestWindow() {\n      return this.sortedWindows[0] || {};\n    },\n    gcepReviews() {\n      return this.items.filter((i) => i.expert_panel.expert_panel_type_id == 1);\n    },\n    vcepReviews() {\n      return this.items.filter((i) => i.expert_panel.expert_panel_type_id == 2);\n    },\n  },\n  methods: {\n    async getWindows() {\n      this.windows = await api\n        .get(\"/api/annual-updates/windows\")\n        .then((response) => response.data);\n      this.selectedYear = this.latestWindow.for_year;\n    },\n    async getItems() {\n      this.loading = true;\n      this.items = await api\n        .get(\"/api/annual-updates\")\n        .then((response) => response.data);\n      this.loading = false;\n    },\n  },\n  mounted() {\n    this.getWindows();\n    this.getItems();\n  },\n};\n</script>","<template>\n    <div>\n        <div class=\"flex mb-2 items-end justify-between\">\n            <div class=\"flex space-x-4 items-end\">\n                <input \n                    v-model=\"filter\" \n                    placeholder=\"EP name, submitter name\"\n                    class=\"w-60\"\n                >\n                <select v-model=\"completedFilter\" class=\"flex radio-group\">\n                    <option :value=\"null\">Any</option>\n                    <option :value=\"2\">Only Pending</option>\n                    <option :value=\"1\">Only Completed</option>\n                </select>\n            </div>\n            <button class=\"btn btn-xs\" @click=\"exportData\">Export Data</button>\n        </div>\n\n        <data-table :data=\"filteredItems\" :fields=\"fields\" v-model:sort=\"sort\">\n            <template v-slot:cell-action=\"{item}\">\n                <router-link :to=\"{name: 'AnnualUpdateDetail', params: {id: item.id}}\">\n                    view\n                </router-link>\n            </template>\n        </data-table>\n\n    </div>\n</template>\n<script>\nimport {api} from '@/http'\nimport setupRouterSortAndFilter from '@/composables/router_aware_sort_and_filter'\n\nexport default {\n    name: 'AnnualUpdateTeable',\n    props: {\n        items: {\n            type: Array,\n            required: true\n        }\n    },\n    data() {\n        return {\n            fields: [\n                {\n                    name: 'id',\n                    sortable: true,\n                    label: 'ID'\n                },\n                {\n                    name: 'expert_panel.display_name',\n                    label: 'Expert Panel',\n                    sortable: true\n                },\n                {\n                    name: 'submitter.person.name',\n                    label: 'Submitter',\n                    sortable: true\n                },\n                {\n                    name: 'completed_at',\n                    label: 'Completed',\n                    sortable: true,\n                    resolveValue: (item) => {\n                        return item.completed_at ? this.formatDate(item.completed_at) : null;\n                    }\n                },\n                {\n                    name: 'action',\n                    label: '',\n                    sortable: false\n\n                }\n            ],\n            // completedFilter: null\n            \n        }\n    },\n    computed: {\n        completedFilter: {\n            get: function () {\n                return this.$route.query.completed || null;\n            },\n            set: function (value) {\n                let currentQuery = this.$route.query;\n                let currentPath = this.$route.path;\n        \n                let updatedQuery = {...currentQuery};\n        \n                if (!value) {\n                    delete updatedQuery.completed;\n                } else {\n                    updatedQuery = {...currentQuery, ...{'completed': value} };\n                }\n        \n                this.$router.replace({path: currentPath, query: updatedQuery})\n            }\n        },\n        filteredItems () {\n            let result = JSON.parse(JSON.stringify(this.items));\n            if (this.filter != null) {\n                const pattern = new RegExp(`.*${this.filter}.*`, 'i');\n                result = this.items.filter(i => {\n                    return i.expert_panel.display_name.match(pattern)\n                        || (i.submitter && i.submitter.person && i.submitter.person.name.match(pattern));\n                });\n            }\n\n            if (this.completedFilter != null) {\n                result = result.filter(i => {\n                    if (this.completedFilter == 1) {\n                        return i.completed_at !== null;\n                    }\n                    return i.completed_at == null;\n                });\n            }\n            return result\n        },\n    },\n    methods: {\n        exportData () {\n            const annual_update_ids = this.filteredItems.map(i => i.id);\n            api.post(`/api/annual-updates/export`, {annual_update_ids})\n                .then(response => {\n                    const a = document.createElement('a');\n                    a.style.display = \"none\";\n                    document.body.appendChild(a);\n\n                    a.href = window.URL.createObjectURL( new Blob([response.data, { type: 'text/csv' }]));\n\n                    a.setAttribute('download', 'annual_updates.csv');\n                    a.click();\n\n                    document.body.removeChild(a);\n                });\n        }\n    },\n    setup() {\n        const {sort, filter} = setupRouterSortAndFilter({field: 'expert_panel.display_name', desc: false});\n\n        return {\n            sort,\n            filter\n        }\n    }\n}\n</script>","import { render } from \"./AnnualUpdateTable.vue?vue&type=template&id=4d600c76\"\nimport script from \"./AnnualUpdateTable.vue?vue&type=script&lang=js\"\nexport * from \"./AnnualUpdateTable.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./AnnualUpdatesList.vue?vue&type=template&id=51093e4a&scoped=true\"\nimport script from \"./AnnualUpdatesList.vue?vue&type=script&lang=js\"\nexport * from \"./AnnualUpdatesList.vue?vue&type=script&lang=js\"\n\nimport \"./AnnualUpdatesList.vue?vue&type=style&index=0&id=51093e4a&lang=postcss&scoped=true\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-51093e4a\"]])\n\nexport default __exports__","import { useRouter, useRoute } from 'vue-router'\nimport {computed} from 'vue'\n\nexport default function (defaultSort = null) {\n    const router = useRouter()\n    const route = useRoute()\n    if (!defaultSort){\n        console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: \"fieldname\", desc: boolean}')\n        defaultSort = (defaultSort) ? defaultSort : {field: 'name', desc: false}\n    }\n    \n    const sort = computed({\n        immediate: true,\n        get() {\n            if (Object.keys(route.query).includes('sort-field')) {\n                return {\n                    field: route.query['sort-field'],\n                    desc: Boolean(parseInt(route.query['sort-desc']))\n                }\n            }\n            return defaultSort;\n        },\n        set(sortObj) {\n            const newSortQuery = {'sort-field': sortObj.field, 'sort-desc': sortObj.desc ? 1 : 0}\n    \n            const newQuery = {\n                ...route.query, \n                ...newSortQuery\n            };\n    \n            router.replace({path: route.path, query: newQuery})\n        }\n    });\n    \n    const filter = computed({\n        set(value) {\n            let currentQuery = route.query;\n            let currentPath = route.path;\n    \n            let updatedQuery = {...currentQuery};\n    \n            if (!value) {\n                delete updatedQuery.filter;\n            } else {\n                updatedQuery = {...currentQuery, ...{'filter': value} };\n            }\n    \n            router.replace({path: currentPath, query: updatedQuery})\n        },\n        get() {\n            return route.query.filter\n        },\n        immediate: true\n    });\n\n    return {\n        sort,\n        filter\n    }\n}\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./AnnualUpdatesList.vue?vue&type=style&index=0&id=51093e4a&lang=postcss&scoped=true\""],"sourceRoot":""}