"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[329],{4582:function(e,t,r){r.d(t,{A:function(){return s}});r(3725),r(5019);var i=r(6166),a=r(641);function s(e=null){const t=(0,i.rd)(),r=(0,i.lq)();e||(console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: "fieldname", desc: boolean}'),e=e||{field:"name",desc:!1});const s=(0,a.EW)({immediate:!0,get(){return Object.keys(r.query).includes("sort-field")?{field:r.query["sort-field"],desc:Boolean(parseInt(r.query["sort-desc"]))}:e},set(e){const i={"sort-field":e.field,"sort-desc":e.desc?1:0},a={...r.query,...i};t.replace({path:r.path,query:a})}}),n=(0,a.EW)({set(e){let i=r.query,a=r.path,s={...i};e?s={...i,filter:e}:delete s.filter,t.replace({path:a,query:s})},get(){return r.query.filter},immediate:!0});return{sort:s,filter:n}}},3329:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});r(3725),r(5019);var i=r(641),a=r(3751);const s=(0,i.Lk)("h1",null,"People",-1),n={class:"block mb-2",for:"filter-input"},o=(0,i.eW)("Filter:Â ");function l(e,t,r,l,d,u){const c=(0,i.g2)("data-table");return(0,i.uX)(),(0,i.CE)("div",null,[s,(0,i.bF)(c,{data:u.itemProvider,fields:d.fields,class:"width-full","row-click-handler":u.goToPerson,"row-class":"cursor-pointer",sort:l.sort,"onUpdate:sort":t[1]||(t[1]=e=>l.sort=e),"page-size":20,paginated:"",ref:"dataTable"},{header:(0,i.k6)((()=>[(0,i.Lk)("label",n,[o,(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.filter=e),placeholder:"filter"},null,512),[[a.Jo,l.filter]])])])),_:1},8,["data","fields","row-click-handler","sort"])])}var d=r(2543),u=r(6278),c=r(696),p=r(4582),h=r(953);const f=20,g=(0,h.KR)(0),m=e=>{const t=g.value*f,r=t+f-1;return e.slice(t,r)},b=[{name:"name",sortable:!0,type:String},{name:"email",sortable:!0,type:String},{name:"institution.name",label:"Institution",sortable:!0,type:String,resolveSort(e){return e.institution?e.institution.name:""}}];var S={data(){return{fields:b}},computed:{...(0,u.L8)({currentUser:"currentUser"})},watch:{filter:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}},sort:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}}},methods:{goToPerson(e){this.$router.push("/people/"+e.uuid)},goToEditPerson(e){this.$router.push(`/people/${e.uuid}/edit`)},canEdit(e){return!!this.hasPermission("people-manage")||this.currentUser.id==e.user_id},async itemProvider(e,t,r,i){const a={page:e,page_size:t,"sort[field]":r.field.name,"sort[dir]":r.desc?"DESC":"ASC","where[filterString]":this.filter},s=await c.FH.get("/api/people",{params:a}).then((e=>e.data));return i(s.meta.total),s.data}},created(){this.triggerSearch&&this.triggerSearch(),this.triggerSearch=(0,d.debounce)((()=>this.$refs.dataTable.getItems()),500)},setup(){const{sort:e,filter:t}=(0,p.A)();return{sort:e,filter:t,pageSize:f,currentPage:g,getPageItems:m}}},y=r(6262);const k=(0,y.A)(S,[["render",l]]);var v=k}}]);
//# sourceMappingURL=329.b38cbdaa.js.map