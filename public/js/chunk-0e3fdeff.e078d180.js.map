{"version":3,"sources":["webpack:///./src/http/is_validation_error.js","webpack:///./src/views/Coi.vue","webpack:///./src/survey.js","webpack:///./src/views/Coi.vue?de94"],"names":["error","response","status","data","errors","class","codeIsValid","title","verifying","coiTitle","saved","application","name","survey","questions","question","key","label","question_text","vertical","type","options","option","value","show","saving","show-cancel","storeResponse","Question","this","validationRules","validation","YesNoQuestion","makeQuestion","questionDef","Survey","surveyDefinition","_name","_questions","map","q","rsp","forEach","coi","props","code","required","String","coiDef","getResponseTemplate","epName","computed","methods","verifyCode","api","get","then","post","setTimeout","$router","push","catch","e","is_validation_error","mounted","render"],"mappings":"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","file":"js/chunk-0e3fdeff.e078d180.js","sourcesContent":["export default function (error) {\n    return error.response && error.response.status == 422 && error.response.data.errors\n}","<template>\n    <div>\n        <card :title=\"verifying ? `Loading COI Form` : `COI Form not found`\" v-if=\"!codeIsValid\">\n            <div v-if=\"!verifying\">We couldn't find this COI.</div>\n        </card>\n        <card :title=\"coiTitle\"  class=\"w-3/4 mx-auto relative\" v-if=\"codeIsValid\">\n            <div v-if=\"saved\">\n                Thanks for completing the conflict of interest form for {{application.name}}!\n            </div>\n            <div v-else>\n                <div \n                    v-for=\"question in survey.questions\"\n                    :key=\"question.name\"\n                >\n                    <transition name=\"slide-fade-down\">\n                        <input-row\n                            :label=\"question.question_text\"\n                            :errors=\"errors[question.name]\"\n                            :vertical=\"true\"\n                            v-show=\"!question.show || (response[question.show.name] == question.show.value)\"\n                        >\n                        \n                            <textarea  v-if=\"question.type == 'text'\"\n                                class=\"w-full h-24\"\n                                v-model=\"response[question.name]\"\n                                :name=\"question.name\"\n                            ></textarea>\n\n                            <div v-if=\"question.type == 'multiple-choice'\">\n                                <label v-for=\"option in question.options\" :key=\"option.value\" class=\"block\">\n                                    <input type=\"radio\" \n                                        :value=\"option.value\" \n                                        :name=\"question.name\"\n                                        v-model=\"response[question.name]\">\n                                    {{option.label}}\n                                </label>\n                            </div>\n\n                            <input \n                                type=\"text\" \n                                v-if=\"question.type == 'string'\"\n                                v-model=\"response[question.name]\"\n                                :name=\"question.name\"\n                            >\n                        </input-row>\n                    </transition>\n                </div>\n            </div>\n            <div v-if=\"saving\" class=\"absolute top-0 left-0 right-0 bottom-0\">\n                Saving your response...\n            </div>\n            <button-row :show-cancel=\"false\" @submitClicked=\"storeResponse()\"></button-row>\n        </card>\n    </div>\n</template>\n<script>\nimport coiDef from '../../../surveys/coi.json'\nimport Survey from '../survey'\nimport api from '../http/api'\nimport is_validation_error from '../http/is_validation_error';\n\nconst survey = new Survey(coiDef);\n\nexport default {\n    props: {\n        code: {\n            required: true,\n            type: String\n        }\n    },\n    data() {\n        return {\n            coiDef: coiDef,\n            survey: survey,\n            response: survey.getResponseTemplate(),\n            errors: {},\n            epName: null,\n            verifying: false,\n            saved: false,\n            saving: false\n        }\n    },\n    computed: {\n        codeIsValid() {\n            return this.epName !== null;\n        },\n        coiTitle() {\n            return survey.name+' for '+this.epName;\n        }\n    },\n    methods: {\n        verifyCode() {\n            this.verifying = true;\n            api.get(`/api/coi/${this.code}/application`)\n                .then(response => {\n                    this.epName = response.data.name\n\n                })\n                .then(() => {\n                    this.verifying = false;\n                })\n        },\n        storeResponse() {\n            this.saving = true;\n            api.post(`/api/coi/${this.code}`, this.response)\n                .then(() => {\n                    this.saved = true;\n                    setTimeout(() => this.$router.push({'name': 'home'}), 3000)\n                })\n                .catch(e => {\n                    if (is_validation_error(e)) {\n                        this.errors = e.response.data.errors\n                    }\n                })\n                .then(() => {\n                    this.saving = false;\n                })\n        }\n    },\n    mounted() {\n        this.verifyCode();\n    }\n}\n</script>","class Question {\n    constructor(question) {\n        this.question_text = question.question;\n        this.name = question.name;\n        this.options = question.options;\n        this.validationRules = question.validation;\n        this.type = question.type\n        this.show = question.show\n    }\n}\n\nclass YesNoQuestion extends Question {\n    constructor(question) {\n        super(question)\n        this.type = 'multiple-choice';\n        this.options = [\n            {\n                label: 'Yes',\n                value: 1\n            },\n            {\n                label: 'No',\n                value: 0\n            }\n        ];\n    }\n\n    \n}\n\nfunction makeQuestion(questionDef) {\n    if (questionDef.type == 'yes-no') {\n        return new YesNoQuestion(questionDef);\n    }\n\n    return new Question(questionDef);\n}\n\nclass Survey {\n    constructor(surveyDefinition) {\n        this._name = surveyDefinition.name;\n        this._questions = surveyDefinition.questions.map(q => makeQuestion(q));\n\n    }\n\n    get name () {\n        return this._name;\n    }\n\n    get questions() {\n        return this._questions\n    }\n\n    responseIsValid(response) {\n        return true;\n    }\n\n    getResponseTemplate() {\n        const rsp = {};\n        this.questions.forEach(q => {\n            rsp[q.name] = null\n        });\n        return rsp;\n        \n    }\n}\n\nexport default Survey","import { render } from \"./Coi.vue?vue&type=template&id=3488fd75\"\nimport script from \"./Coi.vue?vue&type=script&lang=js\"\nexport * from \"./Coi.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}