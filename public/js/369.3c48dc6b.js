"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[279,369],{6932:function(e,t,a){a.d(t,{Jd:function(){return i},KB:function(){return d},W8:function(){return u},l8:function(){return p},wn:function(){return l}});var o=a(953),r=a(641),n=a(7684);const s=(0,o.KR)([]),i=(0,r.EW)((()=>s.value)),p=async e=>{s.value=await n.A.get(e).then((e=>e.data.data))},l=async(e,t)=>await n.A.post(e,t).then((e=>(s.value.push(e.data),e.data))),u=async(e,t)=>await n.A.put(e,t).then((e=>{const t=s.value.findIndex((t=>t.id==e.data.id));return s.value[t]=e.data,e.data})),d=async(e,t)=>await n.A.delete(`${e}/${t}`).then((e=>{const a=s.value.findIndex((e=>e.id==t));return s.value.splice(a,1),e}))},9704:function(e,t,a){a.d(t,{b:function(){return r}});const o={approve:"green","approve-after-revisions":"blue","request-revisions":"yellow"},r=e=>e.decision?o[e.decision]:"gray"},796:function(e,t,a){a.d(t,{sO:function(){return s}});var o=a(953),r=a(8751),n=a(7684);const s=(0,o.KR)({}),i=(0,o.KR)(!1),p=()=>{i.value=!1,s.value={}},l=async({method:e,url:t,data:a})=>{try{return await(0,n.A)({method:e,url:t,data:a}).then((e=>e.data.data))}catch(o){(0,r.A)(o)&&(s.value={...s,...o.response.data.errors})}},u=()=>{s.value={}};t.Ay=()=>({errors:s,editing:i,hideForm:p,submitFormData:l,resetErrors:u})},1984:function(e,t,a){a.d(t,{A:function(){return g}});var o=a(641),r=a(33);const n={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"},s={class:"flex space-x-1"},i=["innerHTML"];function p(e,t,a,p,l,u){const d=(0,o.g2)("icon-edit"),c=(0,o.g2)("router-link"),m=(0,o.g2)("icon-trash"),v=(0,o.g2)("data-table"),h=(0,o.g2)("log-entry-form"),g=(0,o.g2)("modal-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[u.hasLogEntries?((0,o.uX)(),(0,o.Wv)(v,{key:1,fields:u.fields,data:u.filteredLogEntries,sort:l.sort,"onUpdate:sort":t[0]||(t[0]=e=>l.sort=e)},{"cell-id":(0,o.k6)((({item:e})=>[(0,o.Lk)("div",s,[(0,o.bF)(c,{to:{name:"EditLogEntry",params:{id:e.id}},class:"btn btn-xs inline-block"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{width:"12"})])),_:2},1032,["to"]),null===e.activity_type?((0,o.uX)(),(0,o.Wv)(c,{key:0,to:{name:"ConfirmDeleteLogEntry",params:{id:e.id}},class:"btn btn-xs inline-block"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{width:"12"})])),_:2},1032,["to"])):(0,o.Q3)("",!0)])])),"cell-description":(0,o.k6)((({item:e})=>[(0,o.Lk)("div",{innerHTML:e.description,class:"links-blue"},null,8,i)])),_:1},8,["fields","data","sort"])):((0,o.uX)(),(0,o.CE)("div",n,(0,r.v_)(u.noResultsMessage),1)),(0,o.bF)(g,{modelValue:l.editingEntry,"onUpdate:modelValue":t[1]||(t[1]=e=>l.editingEntry=e),title:"Edit log entry"},{default:(0,o.k6)((()=>[(0,o.bF)(h)])),_:1},8,["modelValue"])])}a(1339),a(3725),a(5019);var l=a(6278),u=a(509),d=a(6932);const c=[{name:"created_at",label:"Created",sortName:"created_at",sortable:!0,type:Date},{name:"description",label:"Entry",sortable:!0,type:String},{name:"causer.name",label:"User",sortable:!0},{name:"id",label:"",sortable:!1}];var m={components:{LogEntryForm:u["default"]},props:{step:{required:!1,type:Number}},data(){return{sort:{field:"created_at",desc:!0},selectedLogEntry:{},editingEntry:!1}},computed:{fields(){return 4!=this.group.group_type_id||c.map((e=>e.name)).includes("step")||c.splice(2,0,{name:"step",sortable:!0}),c},hasLogEntries(){return this.filteredLogEntries.length>0},filteredLogEntries(){return this.logEntries&&this.step?this.logEntries.filter((e=>e.step==this.step)):this.logEntries?this.logEntries:[]},noResultsMessage(){return"number"==typeof this.step?`No progress log entries have been entered for step ${this.step}`:"There are no log entries for this application"}},methods:{async getLogEntries(){},editLogEntry(e){this.editingEntry=!0,this.selectedLogEntry=e}},mounted(){},setup(){const e=(0,l.Pj)(),t=(0,o.EW)((()=>e.getters["groups/currentItemOrNew"])),a=(0,o.EW)((()=>t.value.expert_panel));return(0,o.wB)(t,(()=>{t.value.uuid&&(0,d.l8)(`/api/groups/${t.value.uuid}/activity-logs`)}),{immediate:!0}),{group:t,application:a,logEntries:d.Jd}}},v=a(6262);const h=(0,v.A)(m,[["render",p]]);var g=h},5645:function(e,t,a){a.d(t,{A:function(){return f}});a(3725),a(9838);var o=a(641),r=a(953),n=a(33),s=a(1047);const i={class:"comment-container"},p={class:"flex items-start space-x-2"},l={class:"replies ml-1"},u={key:0,class:""};var d={__name:"ReviewCommentAnonymous",props:{comment:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.KR)((0,s.A)("App\\Models\\Comment",t.comment.id)),d=e=>{switch(e.type.name){case"required revision":return"yellow";case"suggestion":return"blue";case"internal comment":return"gray";default:break}},c=(0,r.KR)(!1),m=async()=>{c.value||await a.value.getComments(),c.value=!c.value};return(t,r)=>{const s=(0,o.g2)("badge"),v=(0,o.g2)("popper"),h=(0,o.g2)("markdown-block"),g=(0,o.g2)("ReviewCommentAnonymous",!0);return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",i,[(0,o.Lk)("div",p,[(0,o.bF)(v,{content:t.titleCase(e.comment.type.name),hover:"",arrow:"",placement:"left"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{class:"block",color:d(e.comment),size:"xxs"},{default:(0,o.k6)((()=>[(0,o.eW)((0,n.v_)(t.titleCase(e.comment.type.name.substr(0,1))),1)])),_:1},8,["color"])])),_:1},8,["content"]),(0,o.Lk)("div",null,[(0,o.bF)(h,{markdown:e.comment.content,class:"text-sm"},null,8,["markdown"]),(0,o.Lk)("div",l,[c.value?((0,o.uX)(),(0,o.CE)("ul",u,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.value.comments,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id,class:"border-l-2 mt-2 px-2 py-1"},[(0,o.bF)(g,{comment:e,commentManager:a.value,onDeleted:t.handleReplyRemoved},null,8,["comment","commentManager","onDeleted"])])))),128))])):(0,o.Q3)("",!0),e.comment.comments_count>0?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"link text-sm",onClick:m},(0,n.v_)(c.value?"Hide":"Show")+" "+(0,n.v_)(e.comment.comments_count)+" "+(0,n.v_)(e.comment.comments_count>1?"replies":"reply"),1)):(0,o.Q3)("",!0)])])])])])}}};const c=d;var m=c;const v={class:"md:w-1/5 flex-shrink-0"},h={key:0};var g={__name:"CommentSummary",props:{comments:{type:Array,required:!0}},setup(e){const t=e,a=(0,o.EW)((()=>{const e={};return t.comments.forEach((t=>{const a=t.metadata.section||"general";e[t.metadata.section]||(e[a]=[]),e[a].push(t)})),e}));return(t,s)=>((0,o.uX)(),(0,o.CE)("div",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,r.R1)(a),((e,a)=>((0,o.uX)(),(0,o.CE)("div",{key:a,class:"md:flex md:space-x-4 mt-3 ml-2"},[(0,o.Lk)("h4",v,(0,n.v_)(t.titleCase(a)),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,(e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.id,comment:e,class:"mb-1 flex-grow-0"},null,8,["comment"])))),128))])))),128)),0==e.comments.length?((0,o.uX)(),(0,o.CE)("div",h," No comments ")):(0,o.Q3)("",!0)]))}};const b=g;var f=b},2538:function(e,t,a){a.d(t,{A:function(){return _}});var o=a(641);const r=e=>((0,o.Qi)("data-v-52f06f94"),e=e(),(0,o.jt)(),e),n=r((()=>(0,o.Lk)("h3",{class:"pb-2"},"EP Progress",-1))),s={class:"flex flex-row space-x-1"};function i(e,t,a,r,i,p){const l=(0,o.g2)("progress-step");return(0,o.uX)(),(0,o.CE)("div",null,[n,(0,o.Lk)("div",s,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.steps,(e=>((0,o.uX)(),(0,o.Wv)(l,{key:e,step:e,application:a.application},null,8,["step","application"])))),128))])])}var p=a(33);const l={class:"flex-1"},u={class:"flex flex-row-reverse justify-between bg-transparent mt-1"},d={key:0};function c(e,t,a,r,n,s){return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",{class:(0,p.C4)(["progress-step",s.displayClass])},null,2),(0,o.Lk)("div",u,[(0,o.Lk)("div",{class:(0,p.C4)({"-mr-10":!s.isLastStep})},(0,p.v_)(s.approvalDate),3),s.isFirstStep?((0,o.uX)(),(0,o.CE)("div",d,(0,p.v_)(s.dateInitiated),1)):(0,o.Q3)("",!0)])])}var m=a(1877),v={props:{step:{type:Number,required:!0},application:{type:Object,required:!0}},data(){return{}},computed:{dateInitiated(){return(0,m.Yq)(this.application.date_initiated)},approvalDate(){return this.application.approvalDateForStep(this.step)?(0,m.Yq)(this.application.approvalDateForStep(this.step)):" "},displayClass(){const e=[];return this.isApproved?e.push("approved"):this.isCurrentStep&&e.push("active"),this.isFirstStep&&e.push("rounded-l"),this.isLastStep&&e.push("rounded-r"),e.join(" ")},isCurrentStep(){return this.application.current_step==this.step},isApproved(){return this.application.stepIsApproved(this.step)},isFirstStep(){return 1==this.step},isLastStep(){const e=Math.max.apply(Math,this.application.steps);return this.step==e}},methods:{}},h=a(6262);const g=(0,h.A)(v,[["render",c]]);var b=g,f={components:{ProgressStep:b},props:{application:{required:!0,type:Object}},computed:{steps(){return this.application.steps}}};const y=(0,h.A)(f,[["render",i],["__scopeId","data-v-52f06f94"]]);var _=y},6252:function(e,t,a){a.d(t,{A:function(){return ht}});var o=a(641);const r={key:0};function n(e,t,a,n,s,i){const p=(0,o.g2)("step-one"),l=(0,o.g2)("tab-item"),u=(0,o.g2)("step-two"),d=(0,o.g2)("step-three"),c=(0,o.g2)("step-four"),m=(0,o.g2)("tabs-container");return(0,o.uX)(),(0,o.CE)("div",null,[i.application.is_gcep?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(p,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])):(0,o.Q3)("",!0),2==this.application.expert_panel_type_id?((0,o.uX)(),(0,o.Wv)(m,{key:1,"tab-location":"right",modelValue:i.activeIndex,"onUpdate:modelValue":t[0]||(t[0]=e=>i.activeIndex=e)},{default:(0,o.k6)((()=>[(0,o.bF)(l,{label:"Group Definition"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1}),(0,o.bF)(l,{label:"Draft Specifications"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1}),(0,o.bF)(l,{label:"Pilot Specfications"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1}),(0,o.bF)(l,{label:"Sustained Curation"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1})])),_:1},8,["modelValue"])):(0,o.Q3)("",!0)])}var s=a(6278);const i={class:"application-review"};function p(e,t,a,r,n,s){const p=(0,o.g2)("definition-review"),l=(0,o.g2)("base-step");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(l,{step:1,"document-name":"Scope and Membership Application",title:"Scope and Membership","document-type":1,"document-gets-reviewed":!0,"approve-button-label":"Approve Scope and Membership",onUpdated:t[0]||(t[0]=e=>this.$emit("updated"))},{sections:(0,o.k6)((()=>[(0,o.bF)(p)])),_:1})])}var l=a(33);const u={class:"overflow-x-auto"},d={class:"mb-6"},c={class:"flex justify-between text-lg font-bold pb-2 mb-2 border-b"},m={class:"flex space-x-2"},v={key:0},h={key:0,class:"flex space-x-1"},g={class:"text-white bg-green-600 rounded-xl px-2"},b={key:1,class:"flex space-x-1"},f={class:"screen-block-container"},y=(0,o.eW)(" Step sections here! "),_={class:"mb-6 mt-4 border-t pt-4"},k={class:"mb-2"};function w(e,t,a,r,n,s){const i=(0,o.g2)("step-controls"),p=(0,o.g2)("edit-icon-button"),w=(0,o.g2)("date-input"),C=(0,o.g2)("remove-button"),A=(0,o.g2)("application-log");return(0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("div",d,[s.application.stepIsApproved(a.step)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(i,{key:0,step:a.step,onUpdated:s.handleUpdated},null,8,["step","onUpdated"])),(0,o.Lk)("div",c,[(0,o.Lk)("div",m,[(0,o.Lk)("h2",null,(0,l.v_)(a.title),1),s.dateApproved?((0,o.uX)(),(0,o.CE)("div",v,[n.editApprovalDate?((0,o.uX)(),(0,o.CE)("div",b,[(0,o.bF)(w,{modelValue:n.newApprovalDate,"onUpdate:modelValue":t[0]||(t[0]=e=>n.newApprovalDate=e)},null,8,["modelValue"]),(0,o.Lk)("button",{class:"btn blue",onClick:t[1]||(t[1]=(...e)=>s.updateApprovalDate&&s.updateApprovalDate(...e))},"Save"),(0,o.bF)(C,{onClick:t[2]||(t[2]=e=>n.editApprovalDate=!1)})])):((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",g," Approved: "+(0,l.v_)(s.dateApproved),1),(0,o.bF)(p,{class:"text-black",onClick:s.initEditApprovalDate},null,8,["onClick"])]))])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",null,[(0,o.Lk)("button",{class:"btn btn-xs",onClick:t[3]||(t[3]=(...e)=>s.goToPrintable&&s.goToPrintable(...e))},"Printable Application")])]),(0,o.Lk)("div",f,[(0,o.RG)(e.$slots,"sections",{},(()=>[y]))])]),(0,o.Lk)("div",null,[(0,o.RG)(e.$slots,"default")]),(0,o.RG)(e.$slots,"log",{},(()=>[(0,o.Lk)("div",_,[(0,o.Lk)("h3",k,"Step "+(0,l.v_)(a.step)+" Progress Log",1),(0,o.bF)(A,{step:a.step},null,8,["step"])])]))])}var C=a(1877),A=a(1984),S=a(953),E=a(9704),F=a(6526),x=a(921);const L=e=>((0,o.Qi)("data-v-d4e65afc"),e=e(),(0,o.jt)(),e),D={key:0},R={key:0},U=L((()=>(0,o.Lk)("strong",null,"Submitted",-1))),X={key:1},V=L((()=>(0,o.Lk)("strong",null,"Sent to chairs",-1))),W=(0,o.eW)(" on "),$=(0,o.eW)(". "),T={key:2},I=(0,o.eW)(" - Revisions Requested. "),q={key:3},O=L((()=>(0,o.Lk)("hr",{class:"my-1"},null,-1))),P=L((()=>(0,o.Lk)("strong",null,"Latest Chair Decisions:",-1))),N={key:0,class:"list-disc pl-6"},M=(0,o.eW)("   "),j={key:0,class:"text-sm"},Q=L((()=>(0,o.Lk)("strong",null,"Notes:",-1))),G={key:1,class:"ml-4 text-gray-500"};var K={__name:"SubmissionInfo",props:{group:{type:Object,required:!0},step:{type:Number,required:!0}},setup(e){const t=e,a=(0,o.EW)((()=>r.value&&r.value.length>0)),r=(0,o.EW)((()=>t.group.expert_panel.submissionsForStep(t.step))),n=(0,o.EW)((()=>t.group.expert_panel.latestPendingSubmissionForStep(t.step))),s=(0,o.EW)((()=>r.value?1==r.value.length||3==n.value.submission_status_id||2==n.value.submission_status_id?n.value.judgements:r.value[r.value.length-2].judgements:[]));return(t,r)=>{const i=(0,o.g2)("badge"),p=(0,o.g2)("static-alert");return e.step==e.group.expert_panel.current_step?((0,o.uX)(),(0,o.CE)("div",D,[(0,S.R1)(a)?((0,o.uX)(),(0,o.Wv)(p,{key:0,class:"mb-4 border-blue-700",variant:"bland"},{default:(0,o.k6)((()=>[(0,S.R1)(n).sent_to_chairs_at?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",R,[U,(0,o.eW)(" by "+(0,l.v_)((0,S.R1)(n).submitter?(0,S.R1)(n).submitter.name:"")+" on ",1),(0,o.Lk)("strong",null,(0,l.v_)((0,S.R1)(C.Yq)((0,S.R1)(n).created_at)),1),(0,S.R1)(n).notes?((0,o.uX)(),(0,o.Wv)(x["default"],{key:0,class:"ml-4",markdown:(0,S.R1)(n).notes},null,8,["markdown"])):(0,o.Q3)("",!0)])),3==(0,S.R1)(n).submission_status_id?((0,o.uX)(),(0,o.CE)("div",X,[V,W,(0,o.Lk)("strong",null,(0,l.v_)((0,S.R1)(C.Yq)((0,S.R1)(n).sent_to_chairs_at)),1),$])):(0,o.Q3)("",!0),2==(0,S.R1)(n).submission_status_id?((0,o.uX)(),(0,o.CE)("div",T,[(0,o.Lk)("strong",null,(0,l.v_)((0,S.R1)(C.Yq)((0,S.R1)(n).updated_at)),1),I])):(0,o.Q3)("",!0),(0,S.R1)(F.UE)("chair_review")&&3==(0,S.R1)(n).submission_status_id?((0,o.uX)(),(0,o.CE)("div",q,[O,P,(0,S.R1)(s)&&(0,S.R1)(s).length>0?((0,o.uX)(),(0,o.CE)("ul",N,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,S.R1)(s),(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},[(0,o.Lk)("strong",null,(0,l.v_)(e.person.name)+":",1),M,(0,o.bF)(i,{color:(0,S.R1)(E.b)(e)},{default:(0,o.k6)((()=>[(0,o.eW)((0,l.v_)(e.decision),1)])),_:2},1032,["color"]),e.notes?((0,o.uX)(),(0,o.CE)("div",j,[Q,(0,o.eW)(" "+(0,l.v_)(e.notes),1)])):(0,o.Q3)("",!0)])))),128))])):((0,o.uX)(),(0,o.CE)("div",G," Awaiting decisions... "))])):(0,o.Q3)("",!0)])),_:1})):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)}}},B=a(6262);const Y=(0,B.A)(K,[["__scopeId","data-v-d4e65afc"]]);var H=Y,z=a(3751);const J={class:"text-sm"},Z=(0,o.Lk)("div",null,"Send notification email to contacts",-1),ee=(0,o.eW)(" The expert panel has not yet submitted the application for approval. "),te=(0,o.Lk)("br",null,null,-1),ae=(0,o.eW)(' You can approve this application but be aware that it is not part of the "normal" application workflow. '),oe={key:0};function re(e,t,a,r,n,s){const i=(0,o.g2)("input-row"),p=(0,o.g2)("dictionary-row"),u=(0,o.g2)("static-alert"),d=(0,o.g2)("user-defined-mail-form"),c=(0,o.g2)("button-row"),m=(0,o.g2)("form-container");return(0,o.uX)(),(0,o.Wv)(m,null,{default:(0,o.k6)((()=>[(0,o.Lk)("h2",null,"Approve Step "+(0,l.v_)(s.application.current_step),1),(0,o.bF)(i,{modelValue:n.dateApproved,"onUpdate:modelValue":t[0]||(t[0]=e=>n.dateApproved=e),type:"date",errors:n.errors.date_approved,label:"Date Approved"},null,8,["modelValue","errors"]),(0,o.bF)(p,{label:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("label",J,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>n.notifyContacts=e),value:!0},null,512),[[z.lH,n.notifyContacts]]),Z])])])),_:1}),s.application.hasPendingSubmissionForCurrentStep?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(u,{key:0,variant:"warning"},{default:(0,o.k6)((()=>[ee,te,ae])),_:1})),(0,o.bF)(z.eB,{name:"slide-fade-down"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(d,{modelValue:n.email,"onUpdate:modelValue":t[2]||(t[2]=e=>n.email=e)},null,8,["modelValue"]),[[z.aG,n.notifyContacts]])])),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.Lk)("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,o.Lk)("button",{class:"btn blue",onClick:t[4]||(t[4]=(...e)=>s.save&&s.save(...e))},[(0,o.eW)(" Approve step "+(0,l.v_)(s.application.current_step)+" ",1),n.notifyContacts?((0,o.uX)(),(0,o.CE)("span",oe," and notify ")):(0,o.Q3)("",!0)])])),_:1})])),_:1})}var ne=a(7684),se=a(8751),ie=a(7818);const pe={1:"App\\Mail\\UserDefinedMailTemplates\\InitialApprovalMailTemplate",2:"App\\Mail\\UserDefinedMailTemplates\\SpecificationDraftMailTemplate",3:"App\\Mail\\UserDefinedMailTemplates\\SpecificationPilotMailTemplate",4:"App\\Mail\\UserDefinedMailTemplates\\SustainedCurationApprovalMailTemplate"};var le={components:{UserDefinedMailForm:ie["default"]},emits:["canceled","saved"],data(){return{dateApproved:null,notifyContacts:!1,email:{subject:"",body:"",cc:[],to:[],files:[]},errors:{}}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},watch:{notifyContacts:function(e){e&&ne.A.get(`/api/email-drafts/groups/${this.group.uuid}`,{params:{templateClass:pe[this.group.expert_panel.current_step]}}).then((e=>{this.email=e.data,this.email["files"]=[]}))}},methods:{clearForm(){this.dateApproved=null,this.notifyContacts=!1},cancel(){this.clearForm(),this.$emit("canceled")},async save(){const e={group:this.group,dateApproved:this.dateApproved,notifyContacts:this.notifyContacts,subject:this.email.subject,body:this.email.body,attachments:this.email.files};try{await this.$store.dispatch("groups/approveCurrentStep",e),this.clearForm(),this.$emit("saved")}catch(t){if((0,se.A)(t))return void(this.errors=t.response.data.errors)}}},mounted(){}};const ue=(0,B.A)(le,[["render",re]]);var de=ue;const ce=["disabled","title"];var me={__name:"StepApproveControl",props:{group:{type:Object,required:!0},step:{type:Number,required:!0}},emits:["stepApproved"],setup(e,{emit:t}){const a=e,r=(0,o.OA)(),n=(0,S.KR)(!1),s=(0,o.EW)((()=>a.step==a.group.expert_panel.current_step)),i=(0,o.EW)((()=>s.value?"Approve this step":"You can only approve the application's current step")),p=()=>{n.value=!0},l=()=>{u(),t("stepApproved")},u=()=>{n.value=!1};return(e,t)=>{const a=(0,o.g2)("modal-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("button",(0,o.v6)({disabled:!(0,S.R1)(s),title:(0,S.R1)(i),class:"btn btn-lg w-full"},(0,S.R1)(r),{onClick:p}),[(0,o.RG)(e.$slots,"default")],16,ce),((0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[(0,o.bF)(a,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),size:"xl",onClosed:t[1]||(t[1]=t=>e.$refs.approvestepform.clearForm())},{default:(0,o.k6)((()=>[(0,o.bF)(de,{ref:"approvestepform",onSaved:l,onCanceled:u},null,512)])),_:1},8,["modelValue"])]))])}}};const ve=me;var he=ve,ge=a(5645),be=a(696);const fe=(0,o.Lk)("p",null,[(0,o.eW)(" Sending the application to the chairs for approval will send a message to the "),(0,o.Lk)("em",null,"cdwgoc_approvals"),(0,o.eW)(" with a PDF of the application and the Core Group comments shown below. ")],-1),ye=(0,o.Lk)("h3",null,"Comments from the Core Group",-1),_e=(0,o.eW)("This is not intended for additional comments about the applicaiton. This is intended for notes about process, timeing, etc. To add comments related to the content of the application click 'Cancel' and add notes alongside the application.");var ke={__name:"StepSendToChairsControl",props:{group:{type:Object,required:!0}},emits:["sentToChairs"],setup(e,{emit:t}){const a=e,r=(0,o.OA)(),n=(0,o.WQ)("commentManager"),s=(0,S.KR)(),i=(0,S.KR)(!1),p=()=>{n.value.getComments(),i.value=!0},l=async()=>{await be.FH.post(`/api/groups/${a.group.uuid}/command`,{command:"app.modules.group.actions.applicationSendToChairs",additionalComments:s.value||null}),t("sentToChairs"),i.value=!1},u=()=>{i.value=!1};return(e,t)=>{const a=(0,o.g2)("note"),d=(0,o.g2)("input-row"),c=(0,o.g2)("button-row"),m=(0,o.g2)("modal-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("button",(0,o.v6)({class:"btn btn-lg w-full",onClick:p},(0,S.R1)(r))," Send to Chairs for Review ",16),((0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[(0,o.bF)(m,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),title:"Send to CDWG OC co-chairs for approval"},{footer:(0,o.k6)((()=>[(0,o.bF)(c,{onSubmitted:l,onCanceled:u,"submit-text":"Send to Chairs"})])),default:(0,o.k6)((()=>[fe,ye,(0,o.bF)(ge.A,{comments:(0,S.R1)(n).openComments},null,8,["comments"]),(0,o.bF)(d,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),vertical:"",type:"large-text",label:"Additional notes for chairs",labelClass:"font-bold"},{"after-input":(0,o.k6)((()=>[(0,o.bF)(a,null,{default:(0,o.k6)((()=>[_e])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]))])}}};const we=ke;var Ce=we;const Ae={class:"text-sm"},Se=(0,o.Lk)("div",null,"Send notification email to contacts",-1),Ee=(0,o.eW)(" The expert panel has not yet submitted the application for approval. "),Fe=(0,o.Lk)("br",null,null,-1),xe=(0,o.eW)(' You can approve this application but be aware that it is not part of the "normal" application workflow. ');function Le(e,t,a,r,n,s){const i=(0,o.g2)("dictionary-row"),p=(0,o.g2)("static-alert"),l=(0,o.g2)("user-defined-mail-form"),u=(0,o.g2)("button-row"),d=(0,o.g2)("form-container");return(0,o.uX)(),(0,o.Wv)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{label:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.Lk)("label",Ae,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>n.notifyContacts=e),value:!0},null,512),[[z.lH,n.notifyContacts]]),Se])])])),_:1}),s.application.hasPendingSubmissionForCurrentStep?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(p,{key:0,variant:"warning"},{default:(0,o.k6)((()=>[Ee,Fe,xe])),_:1})),(0,o.bF)(z.eB,{name:"slide-fade-down"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.bF)(l,{modelValue:n.email,"onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e)},null,8,["modelValue"]),[[z.aG,n.notifyContacts]])])),_:1}),(0,o.bF)(u,{onCanceled:s.cancel,onSubmitted:s.save,"submit-text":s.submissionText},null,8,["onCanceled","onSubmitted","submit-text"])])),_:1})}var De={components:{UserDefinedMailForm:ie["default"]},emits:["canceled","saved"],data(){return{notifyContacts:!0,email:{subject:"",body:"",cc:[],to:[],files:[]},errors:{}}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},submissionText(){return"Request Revisions"+(this.notifyContacts?" and notify":"")}},watch:{notifyContacts:{immediate:!0,handler:function(e){e&&this.getEmailTemplate()}}},methods:{clearForm(){this.dateApproved=null,this.notifyContacts=!0},cancel(){this.clearForm(),this.$emit("canceled")},async save(){try{const e={notify_contacts:this.notifyContacts,subject:this.email.subject,body:this.email.body,attachments:this.email.files},t=`/api/groups/${this.group.uuid}/application/submission/${this.group.expert_panel.pendingSubmission.id}/rejection`;await be.FH.post(t,e).then((e=>e.data)),this.clearForm(),this.$emit("saved")}catch(e){if((0,se.A)(e))return void(this.errors=e.response.data.errors);throw e}},getEmailTemplate(){be.FH.get(`/api/email-drafts/groups/${this.group.uuid}`,{params:{templateClass:"App\\Mail\\UserDefinedMailTemplates\\ApplicationRevisionRequestTemplate"}}).then((e=>{this.email=e.data,this.email["files"]=[]}))}},mounted(){}};const Re=(0,B.A)(De,[["render",Le]]);var Ue=Re,Xe={__name:"StepRequestRevisionsControl",props:{group:{type:Object,required:!0}},emits:["revisionsRequested"],setup(e,{emit:t}){const a=(0,o.OA)(),r=(0,S.KR)(null),n=(0,S.KR)(!1),s=()=>{n.value=!0,r.value.getEmailTemplate()},i=()=>{p(),t("revisionsRequested")},p=()=>{n.value=!1};return(t,l)=>{const u=(0,o.g2)("modal-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[e.group.expert_panel.hasPendingSubmissionForCurrentStep?((0,o.uX)(),(0,o.CE)("button",(0,o.v6)({key:0,class:"btn btn-lg w-full",onClick:s},(0,S.R1)(a))," Request revisions ",16)):(0,o.Q3)("",!0),((0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[(0,o.bF)(u,{title:"Request Revisions to Application",modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),size:"xl",onClosed:l[1]||(l[1]=e=>t.$refs.rejectsubmissionform.clearForm())},{default:(0,o.k6)((()=>[(0,o.bF)(Ue,{ref_key:"rejectsubmissionform",ref:r,onSaved:i,onCanceled:p},null,512)])),_:1},8,["modelValue"])]))])}}};const Ve=Xe;var We=Ve;const $e={class:"border-t border-b py-4 mb-6"},Te={class:"flex w-full space-x-4"};var Ie={__name:"StepControls",props:{step:{type:Number,required:!0},approveLabel:{type:String,required:!1,default:"Approve"}},setup(e){const t=e,a=(0,s.Pj)(),r=(0,o.EW)((()=>a.getters["groups/currentItemOrNew"])),n=(0,o.EW)((()=>{if(!r.value)return!1;const e=r.value.expert_panel.latestPendingSubmissionForStep(t.step);return e&&1==e.submission_status_id}));return(t,a)=>((0,o.uX)(),(0,o.CE)("div",$e,[(0,o.bF)(H,{class:"mb-4",group:(0,S.R1)(r),step:e.step},null,8,["group","step"]),(0,o.Lk)("div",Te,[(0,o.bF)(he,{class:"flex-1",group:(0,S.R1)(r),step:e.step,onStepApproved:a[0]||(a[0]=()=>{t.$emit("stepApproved"),t.$emit("updated")})},{default:(0,o.k6)((()=>[(0,o.eW)((0,l.v_)(e.approveLabel),1)])),_:1},8,["group","step"]),(0,S.R1)(n)?((0,o.uX)(),(0,o.Wv)((0,S.R1)(Ce),{key:0,class:"flex-1",group:(0,S.R1)(r),onSentToChairs:a[1]||(a[1]=()=>{t.$emit("sentToChairs"),t.$emit("updated")})},null,8,["group"])):(0,o.Q3)("",!0),(0,S.R1)(r).expert_panel.hasPendingSubmissionForCurrentStep?((0,o.uX)(),(0,o.Wv)((0,S.R1)(We),{key:1,class:"flex-1",group:(0,S.R1)(r),onRevisionsRequested:a[2]||(a[2]=()=>{t.$emit("revisionsRequested"),t.$emit("updated")})},null,8,["group"])):(0,o.Q3)("",!0)])]))}};const qe=Ie;var Oe=qe,Pe=a(4795),Ne={components:{ApplicationLog:A.A,StepControls:Oe,RemoveButton:Pe["default"]},props:{title:{type:String,required:!1,default:"YOU SHOULD SET A TITLE"},step:{type:Number,required:!0},documentName:{type:String,required:!1,default:'Set a document-type attribute if you don\'t use the "document" slot'},documentType:{type:Number,required:!1,default:1},documentGetsReviewed:{type:Boolean,required:!1,default:!0},approveButtonLabel:{type:String,required:!1,default:'Set "approve-button-label" if not overriding slot "approve-button"'}},emits:["documentUploaded","approved","updated"],data(){return{showApproveForm:!1,editApprovalDate:!1,newApprovalDate:null,showRejectForm:!1}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},isCurrentStep(){return this.step==this.application.current_step},dateApproved(){return this.application.approvalDateForStep(this.step)?(0,C.Yq)(this.application.approvalDateForStep(this.step)):null}},methods:{goToPrintable(){window.open(`/groups/${this.group.uuid}/application/review`)},handleUpdated(){this.$emit("updated")},initEditApprovalDate(){this.editApprovalDate=!0,this.newApprovalDate=this.dateApproved},async updateApprovalDate(){try{await this.$store.dispatch("groups/updateApprovalDate",{group:this.group,dateApproved:this.newApprovalDate,step:this.step}),this.editApprovalDate=!1}catch(e){if((0,se.A)(e))return void(this.errors=e.response.data.errors)}}}};const Me=(0,B.A)(Ne,[["render",w]]);var je=Me,Qe=a(8500),Ge={name:"StepOne",components:{BaseStep:je,DefinitionReview:Qe.A},emits:["approved","updated"],data(){return{}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};const Ke=(0,B.A)(Ge,[["render",p]]);var Be=Ke;const Ye={class:"application-section screen-block"},He=(0,o.Lk)("h2",null,"Draft Specifications",-1);function ze(e,t,a,r,n,s){const i=(0,o.g2)("specifications-section"),p=(0,o.g2)("base-step");return(0,o.uX)(),(0,o.Wv)(p,{step:2,"document-type":2,"document-name":"Draft Specifications","document-gets-reviewed":!1,"approve-button-label":"Approve Draft Specifications",title:"Draft ACMG Guideline Specifications",onUpdated:t[0]||(t[0]=t=>e.$emit("updated"))},{sections:(0,o.k6)((()=>[(0,o.Lk)("div",Ye,[He,(0,o.bF)(i,{"doc-type-id":2})])])),_:1})}var Je=a(8097),Ze={name:"StepTwo",components:{BaseStep:je,SpecificationsSection:Je.A},props:{},emits:["approved","updated"],data(){return{}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};const et=(0,B.A)(Ze,[["render",ze]]);var tt=et;const at={class:"application-section screen-block"},ot=(0,o.Lk)("h2",null,"Pilot Specifications",-1);function rt(e,t,a,r,n,s){const i=(0,o.g2)("specifications-section"),p=(0,o.g2)("base-step");return(0,o.uX)(),(0,o.Wv)(p,{step:3,"approve-button-label":"Approve Pilot and Specifications",title:"Pilot ACMG Guideline Specificiations",onUpdated:t[0]||(t[0]=t=>e.$emit("updated"))},{sections:(0,o.k6)((()=>[(0,o.Lk)("div",at,[ot,(0,o.bF)(i,{"doc-type-id":[3,4,7]})])])),_:1})}var nt={name:"StepThree",components:{BaseStep:je,SpecificationsSection:Je.A},props:{},emits:["approved","updated"],data(){return{}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{formatDate(e){return(0,C.Yq)(e)}}};const st=(0,B.A)(nt,[["render",rt]]);var it=st;function pt(e,t,a,r,n,s){const i=(0,o.g2)("sustained-curation-review"),p=(0,o.g2)("base-step");return(0,o.uX)(),(0,o.Wv)(p,{step:4,"document-type":5,"document-name":"Sustained Curation","document-gets-reviewed":!0,"approve-button-label":"Approve Sustained Curation",title:"Sustained Curation",onUpdated:t[0]||(t[0]=t=>e.$emit("updated"))},{sections:(0,o.k6)((()=>[(0,o.bF)(i)])),_:1})}var lt=a(7339),ut={name:"StepFour",components:{BaseStep:je,SustainedCurationReview:lt.A},props:{},emits:["approved","updated"],data(){return{}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};const dt=(0,B.A)(ut,[["render",pt]]);var ct=dt,mt={components:{StepOne:Be,StepTwo:tt,StepThree:it,StepFour:ct},emits:["approved","updated"],data(){return{activeStep:1}},computed:{...(0,s.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},activeIndex:{deep:!0,get(){return this.application&&this.application.current_step?this.application.current_step-1:0},set(e){this.activeStep=e+1}}},methods:{handleApproved(){this.$emit("approved"),this.$emit("updated")},handleUpdated(){this.$emit("updated")}}};const vt=(0,B.A)(mt,[["render",n]]);var ht=vt},8461:function(e,t,a){a.d(t,{A:function(){return F}});var o=a(641),r=a(33),n=a(3751);const s={key:0},i={key:0},p=(0,o.eW)(" Affiliation ID "),l=(0,o.eW)("admin-only"),u={key:0},d={key:1,class:"text-gray-400"},c={key:1},m={key:2},v=(0,o.eW)(" Status: "),h=(0,o.eW)("admin-only"),g=(0,o.eW)(" Parent group: "),b=(0,o.eW)("admin-only");function f(e,t,a,f,y,_){const k=(0,o.g2)("input-row"),w=(0,o.g2)("dictionary-row"),C=(0,o.g2)("note");return(0,o.uX)(),(0,o.CE)("div",null,[_.canSetType?((0,o.uX)(),(0,o.Wv)(k,{key:0,modelValue:_.group.group_type_id,"onUpdate:modelValue":t[0]||(t[0]=e=>_.group.group_type_id=e),errors:f.errors.group_type_id,type:"select",options:_.typeOptions,label:"Type"},null,8,["modelValue","errors","options"])):((0,o.uX)(),(0,o.Wv)(w,{key:1,label:"Type"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(this.group?.type?.display_name),1)])),_:1})),(0,o.bF)(n.eB,{name:"slide-fade-down",mode:"out-in"},{default:(0,o.k6)((()=>[_.group.group_type_id>2&&_.group.expert_panel?((0,o.uX)(),(0,o.CE)("div",s,[(0,o.bF)(k,{label:"Long Base Name",modelValue:_.group.expert_panel.long_base_name,"onUpdate:modelValue":[t[1]||(t[1]=e=>_.group.expert_panel.long_base_name=e),_.emitUpdate],placeholder:"Long base name",errors:f.errors.long_base_name,"input-class":"w-full"},null,8,["modelValue","onUpdate:modelValue","errors"]),(0,o.bF)(k,{label:"Short Base Name",modelValue:_.group.expert_panel.short_base_name,"onUpdate:modelValue":[t[2]||(t[2]=e=>_.group.expert_panel.short_base_name=e),_.emitUpdate],placeholder:"Short base name",errors:f.errors.short_base_name,"input-class":"w-full"},null,8,["modelValue","onUpdate:modelValue","errors"]),e.hasAnyPermission(["groups-manage"])?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.bF)(k,{label:"Affiliation ID",modelValue:_.group.expert_panel.affiliation_id,"onUpdate:modelValue":[t[3]||(t[3]=e=>_.group.expert_panel.affiliation_id=e),_.emitUpdate],placeholder:_.affiliationIdPlaceholder,errors:f.errors.affiliation_id,"input-class":"w-full"},{label:(0,o.k6)((()=>[p,(0,o.bF)(C,null,{default:(0,o.k6)((()=>[l])),_:1})])),_:1},8,["modelValue","placeholder","errors","onUpdate:modelValue"])])):((0,o.uX)(),(0,o.Wv)(w,{key:1,label:"Affiliation ID"},{default:(0,o.k6)((()=>[_.group.expert_panel.affiliation_id?((0,o.uX)(),(0,o.CE)("span",u,(0,r.v_)(_.group.expert_panel.affiliation_id),1)):((0,o.uX)(),(0,o.CE)("span",d,(0,r.v_)("Not yet assigend")))])),_:1}))])):((0,o.uX)(),(0,o.CE)("div",c,[(0,o.bF)(k,{modelValue:_.group.name,"onUpdate:modelValue":[t[4]||(t[4]=e=>_.group.name=e),_.emitUpdate],placeholder:"Name",label:"Name","input-class":"w-full",errors:f.errors.name},null,8,["modelValue","errors","onUpdate:modelValue"])]))])),_:1}),e.hasPermission("groups-manage")?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.bF)(k,{modelValue:_.group.group_status_id,"onUpdate:modelValue":[t[5]||(t[5]=e=>_.group.group_status_id=e),_.emitUpdate],type:"select",options:_.statusOptions,errors:f.errors.group_status_id},{label:(0,o.k6)((()=>[v,(0,o.bF)(C,null,{default:(0,o.k6)((()=>[h])),_:1})])),_:1},8,["modelValue","options","errors","onUpdate:modelValue"]),(0,o.bF)(k,{modelValue:_.group.parent_id,"onUpdate:modelValue":[t[6]||(t[6]=e=>_.group.parent_id=e),_.emitUpdate],type:"select",options:_.parentOptions,errors:f.errors.parent_id},{label:(0,o.k6)((()=>[g,(0,o.bF)(C,null,{default:(0,o.k6)((()=>[b])),_:1})])),_:1},8,["modelValue","options","errors","onUpdate:modelValue"])])):(0,o.Q3)("",!0)])}a(1339),a(3725),a(9838),a(5019);var y=a(2543),_=a(696),k=a(367),w=a(7752),C=a(796),A={name:"GroupForm",emits:["canceled","saved","update"],data(){return{groupTypes:w.groups.types,groupStatuses:w.groups.statuses,newGroup:new k.A,parents:[]}},computed:{group:{get(){const e=this.$store.getters["groups/currentItem"];return e||this.newGroup},set(e){try{this.$store.commit("groups/addItem",e)}catch(t){this.newGroup=e}}},statusOptions(){return Object.values(this.groupStatuses).map((e=>({value:e.id,label:this.titleCase(e.name)})))},typeOptions(){return Object.values(this.groupTypes).map((e=>({value:e.id,label:e.display_name})))},canSetType(){return this.hasPermission("groups-manage")&&!this.group.id},affiliationIdPlaceholder(){return 5e4},cdwgs(){return this.$store.getters["cdwgs/all"]},namesDirty(){return this.group.expert_panel.isDirty("long_base_name")||this.group.expert_panel.isDirty("short_base_name")},affiliationIdDirty(){return this.group.expert_panel.isDirty("affiliation_id")},parentOptions(){const e=[{value:0,label:"None"}];return this.parents.filter((e=>e.type.can_be_parent)).forEach((t=>{e.push({value:t.id,label:t.displayName})})),(0,y.sortBy)(e,"label")}},methods:{async save(){this.resetErrors();try{if(this.group.id)return await this.updateGroup(),void this.$emit("saved");const e=await this.createGroup().then((e=>e.data.data));this.$emit("saved"),this.$store.commit("pushSuccess","Group created."),this.$router.push({name:"AddMember",params:{uuid:e.uuid}})}catch(e){throw(0,_.Ah)(e)&&(this.errors=e.response.data.errors),e}},createGroup(){let{name:e,parent_id:t,group_type_id:a,group_status_id:o}=this.group.attributes;const{short_base_name:r}=this.group.expert_panel;return null===e&&this.group.expert_panel&&(e=this.group.expert_panel.long_base_name),this.$store.dispatch("groups/create",{name:e,parent_id:t,group_type_id:a,group_status_id:o,short_base_name:r})},updateGroup(){const e=[];return e.push(this.saveGroupData()),this.group.expert_panel&&e.push(this.saveEpData()),Promise.all(e)},saveGroupData(){const e=[];return this.group.isDirty("parent_id")&&e.push(this.saveParent()),this.group.isDirty("name")&&e.push(this.saveName()),this.group.isDirty("group_status_id")&&e.push(this.saveStatus()),Promise.all(e)},async saveEpData(){const e=[];if(this.namesDirty){const{long_base_name:t,short_base_name:a}=this.group.expert_panel;e.push(this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/expert-panel/name`,data:{long_base_name:t,short_base_name:a}}))}return this.affiliationIdDirty&&e.push(this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/expert-panel/affiliation-id`,data:{affiliation_id:this.group.expert_panel.affiliation_id}})),await Promise.all(e)},isDirty(e){return this.group[e]!=this.group[e]},saveParent(){return this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/parent`,data:{parent_id:this.group.parent_id}})},saveName(){return this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/name`,data:{name:this.group.name}})},saveStatus(){return this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/status`,data:{status_id:this.group.group_status_id}})},resetData(){this.group.uuid&&this.$store.dispatch("groups/find",this.group.uuid)},cancel(){this.group.uuid&&this.resetData(),this.$emit("canceled")},async getParentOptions(){const e={"where[group_type_id]":[1,2],without:["coordinators","expertPanel"]};this.parents=await _.FH.get("/api/groups",{params:e}).then((e=>e.data.filter((e=>e.id!=this.group.id)).map((e=>new k.A(e)))))},emitUpdate(){this.$emit("update")}},beforeMount(){this.getParentOptions(),this.$store.dispatch("cdwgs/getAll")},setup(e,t){const{errors:a,submitFormData:o,resetErrors:r}=(0,C.Ay)(e,t);return{errors:a,submitFormData:o,resetErrors:r}}},S=a(6262);const E=(0,S.A)(A,[["render",f]]);var F=E},509:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=a(641);function r(e,t,a,r,n,s){const i=(0,o.g2)("input-row"),p=(0,o.g2)("step-input"),l=(0,o.g2)("rich-text-editor"),u=(0,o.g2)("button-row"),d=(0,o.g2)("form-container");return(0,o.uX)(),(0,o.Wv)(d,{class:"log-entry-form",ref:"form-container"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{label:"Log Date",modelValue:n.newEntry.log_date,"onUpdate:modelValue":t[0]||(t[0]=e=>n.newEntry.log_date=e),errors:n.errors.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),2==s.application.expert_panel_type_id?((0,o.uX)(),(0,o.Wv)(p,{key:0,modelValue:n.newEntry.step,"onUpdate:modelValue":t[1]||(t[1]=e=>n.newEntry.step=e),errors:n.errors.step},null,8,["modelValue","errors"])):(0,o.Q3)("",!0),(0,o.bF)(i,{label:"Entry",errors:n.errors.entry},{default:(0,o.k6)((()=>[(0,o.bF)(l,{modelValue:n.newEntry.entry,"onUpdate:modelValue":t[2]||(t[2]=e=>n.newEntry.entry=e)},null,8,["modelValue"])])),_:1},8,["errors"]),(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.Lk)("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,o.Lk)("button",{class:"btn blue",onClick:t[4]||(t[4]=(...e)=>s.save&&s.save(...e))},"Save")])),_:1})])),_:1},512)}a(3725),a(2598);var n=a(6278),s=a(1877),i=a(1606),p=a(5079),l=a(6932),u={name:"LogEntryForm",components:{StepInput:i["default"],RichTextEditor:p["default"]},props:{id:{required:!1,default:null}},data(){return{newEntry:{log_date:new Date,step:null,entry:""},errors:{}}},computed:{...(0,n.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},watch:{id:{immediate:!0,handler:function(){const e=this.findEntry();e&&this.syncEntry(e)}},application:{immediate:!0,handler:function(){const e=this.findEntry();e&&this.syncEntry(e)}}},methods:{findEntry(){return null===this.id?null:this.logEntries?this.logEntries.find((e=>e.id==this.id)):void 0},initNewEntry(){this.newEntry={log_date:(0,s.Yq)(new Date),step:null,entry:""}},syncEntry(e){e&&(this.newEntry={id:e.id,log_date:(0,s.Yq)(new Date(Date.parse(e.created_at))),step:parseInt(e.step),entry:e.description})},cancel(){this.initNewEntry(),this.$emit("canceled")},async save(){try{this.newEntry.id?(0,l.W8)(`/api/groups/${this.group.uuid}/activity-logs/${this.newEntry.id}`,this.newEntry):(0,l.wn)(`/api/groups/${this.group.uuid}/activity-logs`,this.newEntry),this.initNewEntry(),this.$emit("saved")}catch(e){if(e.response&&422==e.response.status&&e.response.data.errors)return void(this.errors=e.response.data.errors)}}},mounted(){this.$el.querySelectorAll("input")[0].focus()},setup(){return{logEntries:l.Jd}}},d=a(6262);const c=(0,d.A)(u,[["render",r]]);var m=c}}]);
//# sourceMappingURL=369.3c48dc6b.js.map