(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d6d92"],{"73ff":function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),r={class:"pb-4"},a=Object(o["createTextVNode"])("People"),c={class:"flex justify-between items-center"},l=Object(o["createElementVNode"])("strong",null,"Email:",-1),i=Object(o["createElementVNode"])("strong",null,"Institution:",-1),s={key:0,class:"well"},u=["innerHTML"],d=["onClick"],b={class:"border my-4 p-4 bg-red-100 border-red-200 rounded"},p=Object(o["createElementVNode"])("h2",{class:"mb-4 text-red-800"}," Here be dragons. Proceed with caution. ",-1),m=Object(o["createElementVNode"])("p",null,"You are about to delete this person. All related data will also be deleted including:",-1),j=Object(o["createElementVNode"])("ul",{class:"list-disc pl-6"},[Object(o["createElementVNode"])("li",null,"User record, system roles, and system permissions (if account is activated)"),Object(o["createElementVNode"])("li",null,"Invite"),Object(o["createElementVNode"])("li",null,"Group Memberships and group roles (if any)")],-1),O=Object(o["createElementVNode"])("div",{class:"border my-4 px-2 py-1 font-bold bg-red-100 border-red-200 rounded text-red-800"}," This cannot be undone. ",-1);function f(e,t,n,f,h,w){var V=Object(o["resolveComponent"])("router-link"),g=Object(o["resolveComponent"])("note"),C=Object(o["resolveComponent"])("icon-edit"),N=Object(o["resolveComponent"])("dictionary-row"),v=Object(o["resolveComponent"])("membership-list"),x=Object(o["resolveComponent"])("tab-item"),D=Object(o["resolveComponent"])("person-profile"),y=Object(o["resolveComponent"])("coi-list"),k=Object(o["resolveComponent"])("tabs-container"),E=Object(o["resolveComponent"])("router-view"),_=Object(o["resolveComponent"])("modal-dialog"),P=Object(o["resolveComponent"])("custom-email-form"),S=Object(o["resolveComponent"])("button-row");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createElementVNode"])("header",r,[Object(o["createVNode"])(V,{class:"note",to:"/people"},{default:Object(o["withCtx"])((function(){return[a]})),_:1}),Object(o["createElementVNode"])("h1",c,[Object(o["createElementVNode"])("div",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.person.name)+" ",1),Object(o["createVNode"])(g,null,{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])("ID: "+Object(o["toDisplayString"])(e.person.id),1)]})),_:1})]),e.hasPermission("people-manage")||e.userIsPerson(e.person)?(Object(o["openBlock"])(),Object(o["createBlock"])(V,{key:0,to:"/people/".concat(n.uuid,"/edit"),class:"btn btn-xs flex-grow-0"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(C,{width:"16",heigh:"16"})]})),_:1},8,["to"])):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])(N,{label:"Email"},{label:Object(o["withCtx"])((function(){return[l]})),default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.person.email),1)]})),_:1}),Object(o["createVNode"])(N,{label:"Institution"},{label:Object(o["withCtx"])((function(){return[i]})),default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.person.institution?e.person.institution.name:null),1)]})),_:1})]),Object(o["createVNode"])(k,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(x,{label:"groups"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(v,{person:e.person},null,8,["person"])]})),_:1}),Object(o["createVNode"])(x,{label:"Info"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(D,{person:e.person},null,8,["person"])]})),_:1}),Object(o["createVNode"])(x,{label:"Conflict of Interest"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(y,{person:e.person},null,8,["person"])]})),_:1}),Object(o["createVNode"])(x,{label:"Email Log",visible:e.hasPermission("people-manage")||e.userIsPerson(e.person)},{default:Object(o["withCtx"])((function(){return[0==w.sortedMailLog.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,Object(o["toDisplayString"])(e.person.first_name)+" has not received any mail via the GPM. ",1)):Object(o["createCommentVNode"])("",!0),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(w.sortedMailLog,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:"w-3/4 my-4 p-4 border",key:t.id},[Object(o["createVNode"])(N,{label:"Date/Time"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(f.formatDate(t.created_at)),1)]})),_:2},1024),Object(o["createVNode"])(N,{label:"Subject"},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.subject),1)]})),_:2},1024),Object(o["createVNode"])(N,{label:"Body"},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",{innerHTML:t.body},null,8,u)]})),_:2},1024),e.hasPermission("people-manage")?(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:0,class:"btn btn-xs",onClick:Object(o["withModifiers"])((function(e){return w.initResend(t)}),["stop"])},"Resend",8,d)):Object(o["createCommentVNode"])("",!0)])})),128))]})),_:1},8,["visible"]),Object(o["createVNode"])(x,{label:"Admin",visible:e.hasPermission("people-manage")},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("section",b,[p,Object(o["createElementVNode"])("button",{class:"btn btn red",onClick:t[0]||(t[0]=function(){return w.initDelete&&w.initDelete.apply(w,arguments)})},"Delete Person")])]})),_:1},8,["visible"])]})),_:1}),(Object(o["openBlock"])(),Object(o["createBlock"])(o["Teleport"],{to:"body"},[Object(o["createVNode"])(_,{modelValue:w.showModal,"onUpdate:modelValue":t[1]||(t[1]=function(e){return w.showModal=e}),title:e.$route.meta.title},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(E,{name:"modal"})]})),_:1},8,["modelValue","title"]),Object(o["createVNode"])(_,{title:"Resend Email",modelValue:h.showResendDialog,"onUpdate:modelValue":t[2]||(t[2]=function(e){return h.showResendDialog=e})},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(P,{"mail-data":h.currentEmail,onSent:w.cleanupResend,onCanceled:w.cleanupResend},null,8,["mail-data","onSent","onCanceled"])]})),_:1},8,["modelValue"]),Object(o["createVNode"])(_,{title:"You are about to delete ".concat(e.person.name),modelValue:h.showDeleteConfirmation,"onUpdate:modelValue":t[3]||(t[3]=function(e){return h.showDeleteConfirmation=e})},{default:Object(o["withCtx"])((function(){return[m,j,O,Object(o["createVNode"])(S,{"submit-text":"Delete ".concat(e.person.name),onSubmitted:w.commitDelete,onCanceled:w.cancelDelete,"submit-variant":"red"},null,8,["submit-text","onSubmitted","onCanceled"])]})),_:1},8,["title","modelValue"])]))])}var h=n("1da1"),w=n("2909"),V=n("5530"),g=(n("96cf"),n("4e82"),n("5502")),C=n("e328"),N=n("b442");function v(e,t,n,r,a,c){var l=Object(o["resolveComponent"])("data-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createVNode"])(l,{fields:a.fields,data:c.memberships,sort:a.sort,"onUpdate:sort":t[0]||(t[0]=function(e){return a.sort=e}),rowClickHandler:c.goToGroup,"row-class":function(){return"cursor-pointer"}},null,8,["fields","data","sort","rowClickHandler","row-class"])])}n("a15b"),n("d81d");var x=n("5313"),D={name:"MembershipList",props:{person:{type:Object,required:!0}},data:function(){return{sort:{field:"group.displayName",desc:!1},fields:[{name:"group.displayName",type:String,sortable:!0,label:"Name"},{name:"group.type.name",type:String,sortable:!0,label:"Type"},{name:"roles",type:String,sortable:!1,label:"Roles",resolveValue:function(e){return e.roles.map((function(e){return e.name})).join(", ")}},{name:"permissions",type:String,sortable:!1,label:"Permissions",resolveValue:function(e){return e.permissions.map((function(e){return e.name})).join(", ")}},{name:"start_date",type:Date,sortable:!0,label:"Started"},{name:"end_date",type:Date,sortable:!0,label:"Ended"}]}},computed:{memberships:function(){return this.person.memberships?this.person.memberships.map((function(e){return e.group&&(e.group=new x["b"](e.group)),e})):[]}},methods:{goToGroup:function(e){this.$router.push({name:"GroupDetail",params:{uuid:e.group.uuid}})}}},y=n("6b0d"),k=n.n(y);const E=k()(D,[["render",v]]);var _=E,P=n("c226"),S=n("6a6b"),B={name:"PersonDetail",components:{TabsContainer:N["default"],MembershipList:_,PersonProfile:P["a"],CoiList:S["a"]},props:{uuid:{required:!0,type:String}},data:function(){return{emails:[],currentEmail:{},showResendDialog:null,showDeleteConfirmation:!1}},watch:{uuid:{immediate:!0,handler:function(){this.$store.dispatch("people/getPerson",{uuid:this.uuid})}}},computed:Object(V["a"])(Object(V["a"])({},Object(g["b"])({person:"people/currentItem"})),{},{showModal:{get:function(){return this.$route.meta.showModal},set:function(e){e&&this.$router.push({name:"PersonEdit",params:{uuid:this.person.uuid}}),this.$router.push({name:"PersonDetail",params:{uuid:this.person.uuid}})}},sortedMailLog:function(){return Object(w["a"])(this.person.mailLog).sort((function(e,t){return e.created_at==t.created_at?0:Date.parse(e.created_at)>Date.parse(t.created_at)?-1:1}))}}),methods:{initResend:function(e){this.currentEmail=Object(V["a"])({},e),this.showResendDialog=!0},cleanupResend:function(){this.currentEmail={},this.showResendDialog=!1,this.$store.dispatch("people/getMail",this.person)},initDelete:function(){this.showDeleteConfirmation=!0},commitDelete:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("people/deletePerson",e.person);case 2:e.showDeleteConfirmation=!1,e.$router.go(-1);case 4:case"end":return t.stop()}}),t)})))()},cancelDelete:function(){this.showDeleteConfirmation=!1}},setup:function(){return{formatDate:C["c"]}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("people/getPerson",{uuid:e.uuid});case 2:e.$store.dispatch("people/getMail",e.person);case 3:case"end":return t.stop()}}),t)})))()}};const R=k()(B,[["render",f]]);t["default"]=R}}]);
//# sourceMappingURL=chunk-2d0d6d92.1f781606.js.map