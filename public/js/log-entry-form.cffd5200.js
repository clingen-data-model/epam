(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["log-entry-form"],{"598d":function(e,t,n){"use strict";n.r(t);var r=n("7a23"),a={class:"block-title"};function o(e,t,n,o,u,c){var i=this,s=Object(r["resolveComponent"])("input-row"),l=Object(r["resolveComponent"])("step-input"),d=Object(r["resolveComponent"])("rich-text-editor"),p=Object(r["resolveComponent"])("button-row"),f=Object(r["resolveComponent"])("form-container");return Object(r["openBlock"])(),Object(r["createBlock"])(f,{class:"log-entry-form",ref:"form-container"},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("h2",a,Object(r["toDisplayString"])(i.$route.meta.title),1),Object(r["createVNode"])(s,{label:"Log Date",modelValue:u.newEntry.log_date,"onUpdate:modelValue":t[0]||(t[0]=function(e){return u.newEntry.log_date=e}),errors:u.errors.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),2==c.application.expert_panel_type_id?(Object(r["openBlock"])(),Object(r["createBlock"])(l,{key:0,modelValue:u.newEntry.step,"onUpdate:modelValue":t[1]||(t[1]=function(e){return u.newEntry.step=e}),errors:u.errors.step},null,8,["modelValue","errors"])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(s,{label:"Entry",errors:u.errors.entry},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,{modelValue:u.newEntry.entry,"onUpdate:modelValue":t[2]||(t[2]=function(e){return u.newEntry.entry=e})},null,8,["modelValue"])]})),_:1},8,["errors"]),Object(r["createVNode"])(p,null,{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("button",{class:"btn",onClick:t[3]||(t[3]=function(){return c.cancel&&c.cancel.apply(c,arguments)})},"Cancel"),Object(r["createElementVNode"])("button",{class:"btn blue",onClick:t[4]||(t[4]=function(){return c.save&&c.save.apply(c,arguments)})},"Save")]})),_:1})]})),_:1},512)}var u=n("1da1"),c=n("5530"),i=(n("96cf"),n("7db0"),n("a4d3"),n("e01a"),n("99af"),n("5502")),s=n("e328"),l=n("a06a"),d=n("85fe"),p=n("831e"),f={name:"LogEntryForm",components:{StepInput:l["default"],RichTextEditor:d["default"]},props:{id:{required:!1,default:null}},data:function(){return{newEntry:{log_date:new Date,step:null,entry:""},errors:{}}},computed:Object(c["a"])(Object(c["a"])({},Object(i["b"])({group:"groups/currentItemOrNew"})),{},{application:function(){return this.group.expert_panel}}),watch:{id:{immediate:!0,handler:function(){var e=this.findEntry();e&&this.syncEntry(e)}},application:{immediate:!0,handler:function(){var e=this.findEntry();e&&this.syncEntry(e)}}},methods:{findEntry:function(){var e=this;return null===this.id?null:this.logEntries?this.logEntries.find((function(t){return t.id==e.id})):void 0},initNewEntry:function(){this.newEntry={log_date:Object(s["a"])(new Date),step:null,entry:""}},syncEntry:function(e){e&&(this.newEntry={id:e.id,log_date:Object(s["a"])(new Date(Date.parse(e.created_at))),step:e.properties.step,entry:e.description})},cancel:function(){this.initNewEntry(),this.$emit("canceled")},save:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,e.newEntry.id?Object(p["e"])("/api/groups/".concat(e.group.uuid,"/activity-logs/").concat(e.newEntry.id),e.newEntry):Object(p["d"])("/api/groups/".concat(e.group.uuid,"/activity-logs"),e.newEntry),e.initNewEntry(),e.$emit("saved"),t.next=11;break;case 6:if(t.prev=6,t.t0=t["catch"](0),!t.t0.response||422!=t.t0.response.status||!t.t0.response.data.errors){t.next=11;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 11:case"end":return t.stop()}}),t,null,[[0,6]])})))()}},mounted:function(){this.$el.querySelectorAll("input")[0].focus()},setup:function(){return{logEntries:p["c"]}}};f.render=o;t["default"]=f},"831e":function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n("1da1"),a=(n("c740"),n("99af"),n("a434"),n("96cf"),n("7a23")),o=n("f96b"),u=Object(a["ref"])([]),c=Object(a["computed"])((function(){return u.value})),i=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].get(t).then((function(e){return e.data.data}));case 2:u.value=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].post(t,n).then((function(e){return u.value.push(e.data),e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].put(t,n).then((function(e){var t=u.value.findIndex((function(t){return t.id==e.data.id}));return u.value[t]=e.data,e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].delete("".concat(t,"/").concat(n)).then((function(e){var t=u.value.findIndex((function(e){return e.id==n}));return u.value.splice(t,1),e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=log-entry-form.cffd5200.js.map