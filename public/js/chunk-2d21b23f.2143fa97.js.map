{"version":3,"sources":["webpack:///./src/views/InviteAdmin.vue","webpack:///./src/views/InviteAdmin.vue?d6f1"],"names":["class","searchTerm","type","placeholder","data","filteredInvites","fields","sort","tableSort","cell-reset","item","redeemed_at","confirmReset","to","title","showConfirmation","resettingInvite","first_name","last_name","submit-text","resetInvite","name","props","field","desc","invites","sortable","Number","label","String","Date","resolveValue","invite","inviter","computed","this","filter","RegExp","match","email","methods","getInvites","get","then","rsp","put","code","response","idx","findIndex","i","id","alert","mounted","render"],"mappings":"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","file":"js/chunk-2d21b23f.2143fa97.js","sourcesContent":["<template>\n    <div>\n        <div class=\"flex justify-between\">\n            <div>\n                <note>Admin</note>\n                <h1>Invites</h1>\n            </div>\n            <div>\n                <pre>{{searchTerm}}</pre>\n                <input type=\"text\" v-model=\"searchTerm\" placeholder=\"filter by name or email\">\n            </div>\n        </div>\n        <data-table\n            :data=\"filteredInvites\"\n            :fields=\"fields\"\n            v-model:sort=\"tableSort\"\n            class=\"text-sm\"\n            v-remaining-height\n        >\n            <template v-slot:cell-reset=\"{item}\">\n                <button class=\"btn btn-xs\" @click=\"confirmReset(item)\" v-if=\"item.redeemed_at\">\n                    Reset\n                </button>\n            </template>\n        </data-table>\n        <teleport to=\"body\">\n            <modal-dialog title=\"Reset Invite\" v-model=\"showConfirmation\">\n                <p>You are about to reset the invite for {{resettingInvite.first_name}} {{resettingInvite.last_name}}.</p>\n                <p>This cannot be undone.</p>\n                <p>Do you want to reset the invite?</p>\n                <button-row submit-text=\"Reset Invite\" @submitted=\"resetInvite(resettingInvite)\"></button-row>\n\n            </modal-dialog>\n        </teleport>\n    </div>\n</template>\n<script>\nimport {api, isValidationError} from '@/http'\n\nexport default {\n    name: 'InviteAdmin',\n    props: {\n        \n    },\n    data () {\n        return {\n            resettingInvite: {},\n            tableSort: {field: 'id', desc: false},\n            invites: [],\n            showConfirmation: false,\n            searchTerm: null,\n            fields: [\n                {\n                    name: 'id',\n                    sortable: true,\n                    type: Number\n                },\n                {\n                    name: 'person.name',\n                    label: 'Name',\n                    sortable: true,\n                    type: String\n                },\n                {\n                    name: 'person.email',\n                    label: 'Email',\n                    sortable: true,\n                    type: String\n                },\n                {\n                    name: 'redeemed_at',\n                    sortable: true,\n                    type: Date\n                },\n                {\n                    name: 'inviter',\n                    sortable: true,\n                    type: String,\n                    resolveValue: (invite) => {\n                        return invite.inviter ? invite.inviter.name : null\n                    }\n                },\n                {\n                    name: 'code',\n                    sortable: false,\n                    type: String\n                },\n                {\n                    name: 'reset',\n                    sortable: false,\n                    type: String\n                }\n            ]\n        }\n    },\n    computed: {\n        filteredInvites () {\n            if (!this.searchTerm) {\n                return this.invites;\n            }\n            const filter = new RegExp(`.*${this.searchTerm}.*`);\n            return this.invites.filter(invite => {\n                return invite.first_name.match(filter)\n                    || invite.last_name.match(filter)\n                    || `${invite.first_name} ${invite.last_name}`.match(filter)\n                    || invite.email.match(filter);\n            });\n        }\n    },\n    methods: {\n         async getInvites () {\n            this.invites = await api.get('/api/people/invites').then(rsp => rsp.data.data);     \n        }, \n        async resetInvite (invite) {\n            try {\n                const response = await api.put(`/api/people/invites/${invite.code}/reset`);\n                const idx = this.invites.findIndex(i => i.id == invite.id);\n                if (idx == -1) {\n                    alert('what??')\n                }\n                this.invites[idx] = response.data;\n            } catch (error) {\n                if (isValidationError(error)) {\n                    alert('Problem resetting invite!');\n                    return;\n                }\n            }\n            this.showConfirmation = false;\n        },\n        confirmReset(invite) {\n            this.resettingInvite = invite;\n            this.showConfirmation = true;\n        }\n    },\n    mounted () {\n        this.getInvites();\n    }\n}\n</script>","import { render } from \"./InviteAdmin.vue?vue&type=template&id=e06ab9c8\"\nimport script from \"./InviteAdmin.vue?vue&type=script&lang=js\"\nexport * from \"./InviteAdmin.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}