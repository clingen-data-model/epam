(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["new-contact-form"],{"033d":function(e,t,n){"use strict";t["a"]=function(e){return e.response&&422==e.response.status&&e.response.data.errors}},b2aa:function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("7a23"),a=Object(r["createVNode"])("h2",{class:"block-title"},"Add a contact",-1),o={class:"flex space-x-4"},c={class:"flex-1"},l={key:0,class:"pt-2 border-l pl-2 flex-1"},s=Object(r["createVNode"])("h5",{class:"font-bold border-b mb-1 pb-1"},"Matching people",-1),i={key:1,class:"text-xs"};function u(e,t,n,u,d,p){var b=Object(r["resolveComponent"])("input-row"),m=Object(r["resolveComponent"])("button-row"),f=Object(r["resolveComponent"])("form-container");return Object(r["openBlock"])(),Object(r["createBlock"])(f,{onKeyup:Object(r["withKeys"])(p.save,["enter"])},{default:Object(r["withCtx"])((function(){return[a,Object(r["createVNode"])("div",o,[Object(r["createVNode"])("div",c,[Object(r["createVNode"])(b,{type:"text",modelValue:d.newContact.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d.newContact.email=e}),errors:d.errors.email,placeholder:"elenor@medplace.com",label:"Email"},null,8,["modelValue","errors"]),Object(r["createVNode"])(b,{type:"text",modelValue:d.newContact.first_name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.newContact.first_name=e}),errors:d.errors.first_name,placeholder:"Elenor",label:"First name"},null,8,["modelValue","errors"]),Object(r["createVNode"])(b,{type:"text",modelValue:d.newContact.last_name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d.newContact.last_name=e}),errors:d.errors.last_name,placeholder:"Shelstrop",label:"Last name"},null,8,["modelValue","errors"]),Object(r["createVNode"])(b,{type:"text",modelValue:d.newContact.phone,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d.newContact.phone=e}),errors:d.errors.phone,placeholder:"1-555-867-5309",label:"Phone"},null,8,["modelValue","errors"]),Object(r["createVNode"])(m,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])("button",{class:"btn",onClick:t[5]||(t[5]=function(){return p.cancel&&p.cancel.apply(p,arguments)})},"Cancel"),Object(r["createVNode"])("button",{class:"btn blue",onClick:t[6]||(t[6]=function(){return p.save&&p.save.apply(p,arguments)})},"Save")]})),_:1})]),Object(r["createVNode"])(r["Transition"],{name:"slide-fade"},{default:Object(r["withCtx"])((function(){return[p.suggestedPeople.length>0?(Object(r["openBlock"])(),Object(r["createBlock"])("div",l,[s,Object(r["createVNode"])("ul",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(p.suggestedPeople,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("li",{key:e.uuid,class:["flex justify-between my-2",{"text-gray-400":p.isAlreadyContact(e)}],title:p.isAlreadyContact(e)?"This person is already a contact for this application":""},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.name)+" ",1),p.isAlreadyContact(e)?(Object(r["openBlock"])(),Object(r["createBlock"])("span",i,"Already a contact")):(Object(r["openBlock"])(),Object(r["createBlock"])("button",{key:0,class:"btn btn-xs",onClick:function(t){return p.addExistingPersonAsContact(e)}}," Add as contact ",8,["onClick"]))],10,["title"])})),128))])])):Object(r["createCommentVNode"])("",!0)]})),_:1})])]})),_:1},8,["onKeyup"])}n("4de4"),n("caad"),n("d81d"),n("2532"),n("96cf");var d=n("1da1"),p=n("5530"),b=n("5502"),m=n("033d"),f=n("ec26"),h={props:{},data:function(){return{createNew:!1,newContact:{first_name:null,last_name:null,email:null,phone:null,role:null,uuid:null},errors:{}}},emits:["canceled","saved","done"],computed:Object(p["a"])(Object(p["a"])({},Object(b["b"])({application:"applications/currentItem",people:"people/all"})),{},{suggestedPeople:function(){var e=this;return this.newContact.email?this.people.filter((function(t){return t.email.includes(e.newContact.email)})):[]}}),methods:{clearForm:function(){this.newContact={first_name:null,last_name:null,email:null,phone:null,role:null,uuid:null}},clearErrors:function(){this.errors={}},cancel:function(){this.clearForm(),this.$emit("canceled"),this.$emit("done")},save:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.clearErrors(),t.prev=1,n=Object(p["a"])({},e.newContact),n.uuid=Object(f["a"])(),t.next=6,e.$store.dispatch("people/createPerson",n);case 6:return r=e.$store.getters["people/personWithUuid"],t.next=9,e.$store.dispatch("applications/addContact",{application:e.application,contact:r(n.uuid)});case 9:e.clearForm(),e.$emit("saved"),e.$emit("done"),t.next=20;break;case 14:if(t.prev=14,t.t0=t["catch"](1),!Object(m["a"])(t.t0)){t.next=19;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[1,14]])})))()},addExistingPersonAsContact:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("applications/addContact",{application:t.application,contact:e});case 3:t.clearForm(),t.$emit("saved"),t.$emit("done"),n.next=14;break;case 8:if(n.prev=8,n.t0=n["catch"](0),!Object(m["a"])(n.t0)){n.next=13;break}return t.errors=n.t0.response.data.errors,n.abrupt("return");case 13:throw n.t0;case 14:case"end":return n.stop()}}),n,null,[[0,8]])})))()},isAlreadyContact:function(e){return this.application.contacts.map((function(e){return e.id})).includes(e.id)}},mounted:function(){this.$store.dispatch("people/getAll",{})}};h.render=u;t["default"]=h}}]);
//# sourceMappingURL=new-contact-form.a5fcced3.js.map