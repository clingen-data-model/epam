{"version":3,"file":"js/next-action-form.96039f68.js","mappings":"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","sources":["webpack://epam/./src/components/next_actions/NextActionForm.vue","webpack://epam/./src/components/next_actions/NextActionForm.vue?7ccf"],"sourcesContent":["<template>\n    <form-container>\n        <input-row label=\"Creation Date\" :errors=\"errors.date_created\" type=\"date\" v-model=\"newAction.date_created\"></input-row>\n\n        <step-input v-model=\"newAction.step\" :errors=\"errors.step\" v-if=\"application.expert_panel_type_id == 2\"></step-input>\n\n        <input-row label=\"Target\" Date=\"\" :errors=\"errors.target_date\" type=\"date\" v-model=\"newAction.target_date\"></input-row>\n\n        <input-row label=\"Entry\" :errors=\"errors.entry\">\n            <rich-text-editor v-model=\"newAction.entry\"></rich-text-editor>\n        </input-row>\n\n        <input-row label=\"Assigned To\" :errors=\"assignmentErrors\">\n            <select id=\"\" v-model=\"newAction.assigned_to\">\n                <option :value=\"null\">Select...</option>\n                <option v-for=\"i in assignees\" :key=\"i.id\"\n                    :value=\"i.id\"\n                >\n                    {{i.name}}\n                </option>\n            </select>\n            &nbsp;&nbsp;\n            <input type=\"text\" label=\"Name\" v-model=\"newAction.assigned_to_name\" placeholder=\"Name (optional)\">\n        </input-row>\n\n        <div class=\"ml-4\">\n        </div>\n\n        <checkbox  \n            v-model=\"completed\" \n            label=\"This is already completed\"\n            class=\"ml-36\"\n        />\n\n        <input-row label=\"Date Completed\" :errors=\"errors.date_completed\" class=\"ml-36\" v-if=\"completed\">\n            <input type=\"date\" v-model=\"newAction.date_completed\">\n        </input-row>\n\n        <button-row>\n            <button class=\"btn\" @click=\"cancel\">Cancel</button>\n            <button class=\"btn blue\" @click=\"save\">Save</button>\n        </button-row>\n    </form-container>\n</template>\n<script>\nimport StepInput from '@/components/forms/StepInput.vue'\nimport {mapGetters} from 'vuex'\nimport RichTextEditor from '@/components/forms/RichTextEditor.vue'\nimport {formatDate} from '@/date_utils'\nimport configs from '@/configs'\n\nexport default {\n    name: 'NextActionForm',\n    components: {\n        StepInput,\n        RichTextEditor\n    },\n    props: {\n        id: {\n            required: false,\n            default: null\n        }\n    },\n    emits: [\n        'saved',\n        'closed',\n        'formCleared',\n        'canceled'\n    ],\n    data() {\n        return {\n            errors: {},\n            newAction: {\n                date_created: new Date(),\n                step: null,\n                date_completed: null,\n                entry: '',\n                assigned_to: null,\n                assigned_to_name: null\n            },\n            completed: false\n        }\n    },\n    computed: {\n        ...mapGetters({\n            group: 'groups/currentItemOrNew'\n        }),\n        application () {\n            return this.group.expert_panel;\n        },\n        title () {\n            return this.newAction.id ? 'Update Action' : 'Add Next Action';\n        },\n        steps () {\n            return [1,2,3,4];\n        },\n        assignmentErrors () {\n            let errors = [];\n            if (this.errors.assigned_to) {\n                errors = [...errors, ...this.errors.assigned_to]\n            }\n            if (this.errors.assigned_to_name) {\n                errors = [...errors, ...this.errors.assigned_to_name]\n            }\n            return errors;\n        },\n        assignees () {\n            return Object.values(configs.nextActions.assignees);\n        }\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler: function() {\n                const action = this.findAction();\n                if (action) {\n                    this.syncAction(action)\n                }\n            }\n        },\n        application: {\n            immediate: true,\n            handler: function () {\n                const action = this.findAction();\n                if (action) {\n                    this.syncAction(action);\n                }\n            }\n        }\n    },\n    methods: {\n        cancel () {\n            this.clearForm();\n            this.$emit('canceled');\n        },\n        clearForm() {\n            this.initNewAction();\n            this.$emit('formCleared')\n        },\n        initNewAction () {\n            this.newAction = {\n                date_created: new Date(),\n                step: null,\n                target_date: null,\n                date_completed: null,\n                entry: '',\n                assigned_to: null,\n                assigned_to_name: null,\n            };      \n        },\n        findAction () {\n            if (this.id === null) {\n                return null;\n            }\n            if (this.application.next_actions) {\n                return this.application.next_actions.find(i => i.id == this.id);\n            }\n        },\n        syncAction (action) {\n            if (!action) {\n                return;\n            }\n            this.newAction = {\n                id: action.id,\n                uuid: action.uuid,\n                date_created: formatDate(action.created_at),\n                step: action.step,\n                target_date: formatDate(action.target_date),\n                date_completed: formatDate(action.date_completed),\n                entry: action.entry ?? '',\n                assigned_to: action.assigned_to,\n                assigned_to_name: action.assigned_to_name\n            }\n        },\n        async save() {\n            try {\n                if (this.newAction.id) {\n                    await this.$store.dispatch(\n                        'applications/updateNextAction', \n                        {\n                            application: this.application, \n                            updatedAction: this.newAction,\n                        }\n                    );\n                    this.$emit('saved')\n                    this.clearForm();\n                } else {\n                    await this.$store.dispatch(\n                        'applications/addNextAction', \n                        {\n                            application: this.application, \n                            nextActionData: this.newAction\n                        }\n                    );\n                    this.$emit('saved')\n                    this.clearForm();\n                }\n            } catch (error) {\n                if (error.response && error.response.status == 422 && error.response.data.errors) {\n                    this.errors = error.response.data.errors\n                    return;\n                }\n            }\n        },\n    },\n    unmounted() {\n        this.initNewAction()\n    },\n    mounted() {\n    }\n}\n</script>","import { render } from \"./NextActionForm.vue?vue&type=template&id=7c33e8dc\"\nimport script from \"./NextActionForm.vue?vue&type=script&lang=js\"\nexport * from \"./NextActionForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/bpow/src/clingen/gpm/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","value","class","_createBlock","_component_form_container","_createVNode","_component_input_row","label","errors","$data","date_created","type","$options","expert_panel_type_id","_component_step_input","step","Date","target_date","entry","_component_rich_text_editor","id","assigned_to","_hoisted_1","_createElementBlock","_Fragment","i","key","name","assigned_to_name","placeholder","_hoisted_4","_component_checkbox","date_completed","_component_button_row","onClick","components","StepInput","RichTextEditor","props","required","default","emits","data","newAction","completed","computed","mapGetters","group","application","this","expert_panel","title","steps","assignmentErrors","assignees","Object","values","configs","nextActions","watch","immediate","handler","action","findAction","syncAction","methods","cancel","clearForm","$emit","initNewAction","next_actions","find","uuid","formatDate","created_at","save","$store","dispatch","updatedAction","nextActionData","error","response","status","unmounted","mounted","__exports__","render"],"sourceRoot":""}