"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[375],{289:function(e,a,n){n.d(a,{i:function(){return s}});const t={approve:"green","approve-after-revisions":"blue","request-revisions":"yellow"},s=e=>e.decision?t[e.decision]:"gray"},6412:function(e,a,n){n.d(a,{Z:function(){return b}});var t=n(6252),s=n(3577);const i={class:"flex space-x-2 items-center mb-3"},l={key:0},r=(0,t.Uk)(" has"),o={key:1},u=(0,t.Uk)(" an "),p=(0,t.Uk)(" due on "),d=(0,t.Uk)(". "),c=(0,t.Uk)(" Complete the Annual Update ");function m(e,a,n,m,w,g){const v=(0,t.up)("icon-review"),h=(0,t.up)("router-link"),b=(0,t.up)("static-alert");return g.isPending&&w.annualReview.id?((0,t.wg)(),(0,t.j4)(b,{key:0,variant:g.variant},{default:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t.Wm)(v,{height:"30",width:"30"}),(0,t._)("div",null,[(0,t._)("p",null,[n.showGroupName?((0,t.wg)(),(0,t.iD)("span",l,[(0,t._)("strong",null,(0,s.zw)(n.group.displayName),1),r])):((0,t.wg)(),(0,t.iD)("span",o,"You have")),u,(0,t._)("strong",null,"annual update for "+(0,s.zw)(g.window.for_year),1),p,(0,t._)("strong",null,(0,s.zw)(e.formatDate(g.window.end)),1),d]),n.group.uuid?((0,t.wg)(),(0,t.j4)(h,{key:0,class:"btn font-bold",to:{name:"AnnualUpdate",params:{uuid:n.group.uuid}}},{default:(0,t.w5)((()=>[c])),_:1},8,["to"])):(0,t.kq)("",!0)])])])),_:1},8,["variant"])):(0,t.kq)("",!0)}var w=n(9028),g={name:"AnnualUpdateAlert",props:{group:{type:Object,required:!0},showGroupName:{type:Boolean,default:!1}},data(){return{annualReview:{},loading:!1}},computed:{window(){return this.annualReview.window?this.annualReview.window:{}},isPending(){return this.annualReview&&!this.annualReview.completed_at},variant(){const e=new Date;if(!this.window.end)return"warning";const a=new Date(Date.parse(this.window.end));return e>this.addDays(a,-7)?"danger":"warning"}},watch:{group:{immediate:!0,handler(){this.getAnnualUpdate()}}},methods:{getAnnualUpdate(){this.group.uuid&&this.group.expert_panel.definition_is_approved&&(this.loading=!0,w.hi.get(`/api/groups/${this.group.uuid}/expert-panel/annual-updates`,{headers:{"X-Ignore-Missing":1}}).then((e=>{this.annualReview=e.data})),this.loading=!1)}}},v=n(3744);const h=(0,v.Z)(g,[["render",m]]);var b=h},8009:function(e,a,n){n.r(a),n.d(a,{default:function(){return K}});var t=n(6252),s=n(3577),i=n(2262),l=n(3907),r=n(2119),o=n(1971),u=n(7201),p=n(284),d=n(7506),c=n(3823),m=n(289),w=n(9028),g=n(865),v=n(8661);const h=e=>((0,t.dD)("data-v-557e67ac"),e=e(),(0,t.Cn)(),e),b=h((()=>(0,t._)("h2",null,"Application activity",-1))),_={class:"flex space-x-2"},k={key:0},f=h((()=>(0,t._)("h3",{class:"mb-2"},"Your Decision",-1))),y={key:0,class:"mt-2",style:{"max-width":"300px"}},U=h((()=>(0,t._)("strong",null,"Notes:",-1))),D=h((()=>(0,t._)("hr",null,null,-1))),S=(0,t.Uk)((0,s.zw)("Review")),j=h((()=>(0,t._)("h3",null,"Decisions:",-1))),x={style:{"max-width":"350px"},class:"text-sm"};var W={__name:"ApplicationActivity",props:{user:{type:Object,required:!0}},setup(e){const a=e,n=(0,r.tv)(),l=[{name:"name",label:"Group",sortable:!0},{name:"submission.type.name",label:"Submissed Step",sortable:!0},{name:"submission.status.name",label:"Status",sortable:!0},{name:"last_submission_date",label:"Date",sortable:!0,type:Date},{name:"actions",label:"",sortable:!1}],o=(0,i.iH)({field:"name",desc:!1}),u=(0,i.iH)([]),p=async()=>{u.value=await w.hi.get("/api/groups/applications").then((e=>e.data.data))},d=e=>{n.push({name:"ApplicationDetail",params:{uuid:e.uuid}})},c=e=>e.submission.judgements&&e.submission.judgements.some((e=>e.person_id==a.user.person.id)),h=e=>e.submission.judgements?e.submission.judgements.find((e=>e.person_id==a.user.person.id)):{};return(0,t.bv)((()=>{p()})),(e,a)=>{const n=(0,t.up)("icon-checkmark"),r=(0,t.up)("badge"),p=(0,t.up)("router-link"),w=(0,t.up)("popper"),W=(0,t.up)("data-table");return(0,t.wg)(),(0,t.iD)("div",null,[b,(0,t.Wm)(W,{data:u.value,fields:l,sort:o.value,"onUpdate:sort":a[0]||(a[0]=e=>o.value=e),class:"text-sm",onRowClick:d,"row-class":"cursor-pointer"},{"cell-actions":(0,t.w5)((({item:e})=>[(0,t._)("div",_,[c(e)?((0,t.wg)(),(0,t.iD)("div",k,[(0,t.Wm)(w,{hover:"",arrow:"",placement:"right"},{content:(0,t.w5)((()=>[(0,t._)("div",null,[f,(0,t.Wm)(r,{class:"inline-block",color:(0,i.SU)(m.i)(h(e)),size:"xs"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)(h(e).decision),1)])),_:2},1032,["color"])]),h(e).notes?((0,t.wg)(),(0,t.iD)("div",y,[U,(0,t.Uk)(" "+(0,s.zw)(h(e).notes),1)])):(0,t.kq)("",!0),D,(0,t.Wm)(p,{to:{name:"ApplicationDetail",params:{uuid:e.uuid}},class:(0,s.C_)({"btn btn-xs":(0,i.SU)(g.Fs)("ep-applications-approve")})},{default:(0,t.w5)((()=>[S])),_:2},1032,["to","class"])])),default:(0,t.w5)((()=>[(0,t.Wm)(r,{color:(0,i.SU)(m.i)(e)},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{class:"text-white inline-block",width:"12",height:"12"})])),_:2},1032,["color"])])),_:2},1024)])):((0,t.wg)(),(0,t.j4)(p,{key:1,to:{name:"ApplicationDetail",params:{uuid:e.uuid}},class:"btn btn-xs"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)((0,i.SU)(g.Fs)("ep-applications-manage")?"View":"Review"),1)])),_:2},1032,["to"])),(0,t._)("div",null,[(0,i.SU)(v.ft)("chair-review")?((0,t.wg)(),(0,t.j4)(w,{key:0,hover:"",arrow:""},{content:(0,t.w5)((()=>[j,(0,t._)("table",x,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.submission.judgements,(e=>((0,t.wg)(),(0,t.iD)("tr",{key:e.id},[(0,t._)("th",null,(0,s.zw)(e.person.name)+":",1),(0,t._)("td",null,[(0,t.Wm)(r,{class:"inline-block",color:(0,i.SU)(m.i)(e)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)(e.decision),1)])),_:2},1032,["color"])])])))),128))])])),default:(0,t.w5)((()=>[(0,i.SU)(g.Fs)("ep-applications-manage")&&"Under Chair Review"==e.submission.status.name?((0,t.wg)(),(0,t.j4)(r,{key:0,color:3==e.submission.judgements.length?"green":"gray"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)(e.submission.judgements.length)+"/3 ",1)])),_:2},1032,["color"])):(0,t.kq)("",!0)])),_:2},1024)):(0,t.kq)("",!0)])])])),_:1},8,["data","sort"])])}}},z=n(3744);const A=(0,z.Z)(W,[["__scopeId","data-v-557e67ac"]]);var R=A,C=n(6412),q={__name:"DashboardAlerts",props:{user:{type:Object,required:!0}},setup(e){const a=e,n=(0,i.iH)([]),s=async()=>{const e={with:["assignee"],where:{task_type_id:1,assignee_type:"App\\Modules\\Group\\Models\\Group",assignee_id:[...new Set(l.value.map((e=>e.id)))],pending:1}},a=(0,w.nZ)(e),t=`/api/tasks${a}`;n.value=await w.hi.get(t).then((e=>{const a={};return e.data.forEach((e=>{a[e.assignee_id]=e})),a}))},l=(0,t.Fl)((()=>a.user.memberships.filter((e=>e.hasPermission("annual-update-manage"))).map((e=>e.group)).filter((e=>null!==e)).map((e=>new d.Z(e)))));return(0,t.bv)((()=>{s()})),(a,s)=>{const r=(0,t.up)("sustained-curation-review-alert"),o=(0,t.up)("coi-alert");return(0,t.wg)(),(0,t.iD)("div",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.value,(e=>((0,t.wg)(),(0,t.j4)(r,{key:e.id,group:e.assignee,class:"mb-2"},null,8,["group"])))),128)),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,i.SU)(l),(e=>((0,t.wg)(),(0,t.j4)(C.Z,{key:e.id,group:e,"show-group-name":!0,class:"mb-2"},null,8,["group"])))),128)),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.user.person.membershipsWithPendingCois,(e=>((0,t.wg)(),(0,t.j4)(o,{key:e.id,membership:e,class:"mb-2"},null,8,["membership"])))),128))])}}};const I=q;var Y=I,Z=n(6553);const F=(0,t.Uk)(" Dashboard "),H={class:"note font-normal"},N={key:0,class:"well"};var G={__name:"Dashboard",setup(e){const a=(0,l.oR)(),n=(0,r.tv)(),m=(0,t.Fl)((()=>a.getters["currentUser"])),w=(0,t.Fl)((()=>a.getters["people/currentItem"]||new p.Z)),h=()=>{m.value.id&&m.value.person&&m.value.person.id&&(a.commit("people/addItem",m.value.person),a.commit("people/setCurrentItemIndex",m.value.person))};(0,t.YP)((()=>m),(()=>{h()})),(0,t.bv)((()=>{h()}));const b=(0,t.Fl)((()=>m.value.memberships.map((e=>e.group)).filter((e=>null!==e)).map((e=>new d.Z(e))))),_=(0,i.iH)([{name:"displayName",sortable:!0,type:String},{name:"status.name",label:"Status",sortable:!0,resolveValue:e=>e.status.id==c.groups.statuses.applying.id?e.status.name+" - "+e.expert_panel.currentStepName:e.status.name,type:String}]),k=(0,i.iH)({field:"displayName",desc:!1}),f=e=>{const a={Active:"green",Applying:"blue",Retired:"yellow",Removed:"red"};return a[e]||"blue"},y=(0,t.Fl)((()=>(0,g.Fs)("ep-applications-manage")||(0,v.ft)("chair_review")&&(0,g._N)(["ep-applications-comment","ep-applications-approve"])));(0,t.bv)((async()=>{await a.dispatch("forceGetCurrentUser")}));const U=e=>{n.push({name:"GroupDetail",params:{uuid:e.uuid}})};return(e,a)=>{const n=(0,t.up)("badge"),l=(0,t.up)("data-table"),r=(0,t.up)("tab-item"),p=(0,t.up)("tabs-container");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("h1",null,[F,(0,t._)("div",H," User ID: "+(0,s.zw)((0,i.SU)(m).id)+" | Person ID: "+(0,s.zw)((0,i.SU)(m).person?(0,i.SU)(m).person.id:"no person!!"),1)]),(0,t.Wm)(Z["default"],{user:(0,i.SU)(m)},null,8,["user"]),(0,t.Wm)(Y,{user:(0,i.SU)(m)},null,8,["user"]),(0,i.SU)(y)?((0,t.wg)(),(0,t.j4)(R,{key:0,user:(0,i.SU)(m),class:"screen-block"},null,8,["user"])):(0,t.kq)("",!0),(0,t.Wm)(p,{class:"mt-8"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"Your Groups"},{default:(0,t.w5)((()=>[(0,i.SU)(b).length?((0,t.wg)(),(0,t.j4)(l,{key:1,data:(0,i.SU)(b),fields:_.value,sort:k.value,"onUpdate:sort":a[0]||(a[0]=e=>k.value=e),onRowClick:U,"row-class":"cursor-pointer"},{"cell-status_name":(0,t.w5)((({value:e})=>[(0,t.Wm)(n,{color:f(e)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)(e),1)])),_:2},1032,["color"])])),"cell-displayName":(0,t.w5)((({item:e})=>[(0,t.Uk)((0,s.zw)(e.name)+" "+(0,s.zw)(e.type.name.toUpperCase()),1)])),_:1},8,["data","fields","sort"])):((0,t.wg)(),(0,t.iD)("div",N,"You are not assigned to any groups."))])),_:1}),(0,t.Wm)(r,{label:"Your Info"},{default:(0,t.w5)((()=>[(0,t.Wm)(u.Z,{person:(0,i.SU)(w)},null,8,["person"])])),_:1}),(0,t.Wm)(r,{label:"COIs"},{default:(0,t.w5)((()=>[(0,t.Wm)(o.Z,{person:(0,i.SU)(m).person},null,8,["person"])])),_:1})])),_:1})])}}};const P=G;var K=P}}]);
//# sourceMappingURL=375.4cb54797.js.map