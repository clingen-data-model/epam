"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[201,932],{4582:function(e,t,l){l.d(t,{A:function(){return i}});l(3725),l(5019);var a=l(6166),n=l(641);function i(e=null){const t=(0,a.rd)(),l=(0,a.lq)();e||(console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: "fieldname", desc: boolean}'),e=e||{field:"name",desc:!1});const i=(0,n.EW)({immediate:!0,get(){return Object.keys(l.query).includes("sort-field")?{field:l.query["sort-field"],desc:Boolean(parseInt(l.query["sort-desc"]))}:e},set(e){const a={"sort-field":e.field,"sort-desc":e.desc?1:0},n={...l.query,...a};t.replace({path:l.path,query:n})}}),s=(0,n.EW)({set(e){let a=l.query,n=l.path,i={...a};e?i={...a,filter:e}:delete i.filter,t.replace({path:n,query:i})},get(){return l.query.filter},immediate:!0});return{sort:i,filter:s}}},271:function(e,t,l){l.d(t,{A:function(){return L}});l(3725),l(5019);var a=l(641),n=l(3751),i=l(33);const s={class:"sm:flex justify-between"},r={class:"mb-1 sm:flex space-x-2"},o={class:"block"},p=(0,a.eW)(" Filter: "),d={class:"block"},u=(0,a.eW)(" Waiting on: "),c=(0,a.Lk)("option",{value:null},"Any",-1),m=["value"],h=["href"],b=["innerHTML"],_={class:"list-disc pl-6 text-sm"},f=["innerHTML"];function g(e,t,l,g,v,y){const w=(0,a.g2)("checkbox"),k=(0,a.g2)("popper"),A=(0,a.g2)("data-table");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",s,[(0,a.Lk)("div",r,[(0,a.Lk)("label",o,[p,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"sm","onUpdate:modelValue":t[0]||(t[0]=e=>g.filter=e),placeholder:"filter"},null,512),[[n.Jo,g.filter]])]),(0,a.Lk)("label",d,[u,(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>v.waitingOn=e),class:"sm"},[c,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.assignees,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,m)))),128))],512),[[n.u1,v.waitingOn]])]),(0,a.bF)(w,{modelValue:y.showCompleted,"onUpdate:modelValue":t[2]||(t[2]=e=>y.showCompleted=e),label:"Show completed"},null,8,["modelValue"])]),(0,a.Lk)("div",null,[(0,a.Lk)("button",{class:(0,i.C4)(["btn btn-xs",{blue:0==y.showAllInfo}]),onClick:t[3]||(t[3]=e=>y.showAllInfo=0)},"Summary",2),(0,a.Lk)("button",{class:(0,i.C4)(["btn btn-xs",{blue:1==y.showAllInfo}]),onClick:t[4]||(t[4]=e=>y.showAllInfo=1)},"All Info",2)])]),(0,a.bF)(A,{data:y.filteredData,fields:y.selectedFields,"filter-term":g.filter,"row-click-handler":y.goToApplication,"row-class":"cursor-pointer",sort:g.sort,"onUpdate:sort":t[5]||(t[5]=e=>g.sort=e),style:(0,i.Tr)(y.remainingHeight),class:"overflow-auto",ref:"table"},{"cell-contacts":(0,a.k6)((({item:e})=>[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.group.members,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id},[(0,a.Lk)("small",null,[(0,a.Lk)("a",{href:`mailto:${e.person.email}`,class:"text-blue-500"},(0,i.v_)(e.person.name),9,h)])])))),128))])])),"cell-latest_log_entry":(0,a.k6)((({item:t})=>[(0,a.bF)(k,{hover:"",arrow:"",placement:"right"},{content:(0,a.k6)((()=>[(0,a.Lk)("div",{innerHTML:t.group.latest_log_entry.description},null,8,b)])),default:(0,a.k6)((()=>[(0,a.eW)(" "+(0,i.v_)(e.formatDate(t.group.latest_log_entry.created_at)),1)])),_:2},1024)])),"cell-next_actions":(0,a.k6)((({item:e})=>[(0,a.bF)(k,{hover:"",arrow:"",placement:"left"},{content:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.assignees.filter((t=>e.pendingActionsByAssignee[t.id].length>0)),(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id,class:"whitespace-normal max-w-80"},[(0,a.Lk)("h4",null,(0,i.v_)(t.short_name)+":",1),(0,a.Lk)("ul",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.pendingActionsByAssignee[t.id],(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id,innerHTML:e.entry,class:"w-76 whitespace-normal"},null,8,f)))),128))])])))),128))])),default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.assignees.filter((t=>e.pendingActionsByAssignee[t.id].length>0)),(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id},[(0,a.Lk)("span",null,[(0,a.eW)((0,i.v_)(t.short_name)+": ",1),(0,a.Lk)("strong",null,(0,i.v_)(e.pendingActionsByAssignee[t.id].length),1)])])))),128))])),_:2},1024)])),_:1},8,["data","fields","filter-term","row-click-handler","sort","style"])])}var v=l(6278),y=l(1877),w=l(4582),k=l(7752),A={components:{},props:{epTypeId:{type:Number,default:null}},data(){return{fields:[{name:"id",label:"ID",type:Number,sortable:!0},{name:"full_name",label:"Name",type:String,sortable:!0},{name:"group.parent.name",label:"CDWG",type:String,sortable:!0,resolveValue(e){return e.group&&e.group.parent?e.group.parent.name:""}},{name:"current_step",label:"Current Step",type:Number,sortable:!0,resolveValue(e){return e.isCompleted?"Completed":e.current_step},resolveSort(e){return e.isCompleted?5:e.current_step}},{name:"latest_submission_date",label:"Last Submitted",type:Date,sortable:!0,resolveValue(e){return e.group.latest_submission?(0,y.Yq)(e.group.latest_submission.created_at):null}},{name:"latest_submision.status",label:"Submission Status",type:String,sortable:!0,resolveValue(e){return e.group.latest_submission?e.group.latest_submission.status.name:null}},{name:"latest_log_entry",label:"Last Activity",type:Date,sortable:!0,resolveSort(e){return e&&e.group&&e.group.latest_log_entry?(0,y.Yq)(e.group.latest_log_entry.created_at):null}},{name:"next_actions",label:"Next Actions",type:String,sortable:!1,class:["min-w-28","max-w-xs","truncate"]}],allInfoFields:[{name:"contacts",label:"Contacts",type:Array,sortable:!1,class:["min-w-40"],step:1},{name:"step_1_received_date",label:2==this.epTypeId?"Step 1 Received":"Application Received",type:Date,sortable:!0,class:["min-w-28"],step:1},{name:"step_1_approval_date",label:2==this.epTypeId?"Step 1 Approved":"Application Approved",type:Date,sortable:!0,class:["min-w-28"],step:1},{name:"step_2_approval_date",label:"Step 2 Approved",type:Date,sortable:!0,class:["min-w-28"],step:2},{name:"step_3_approval_date",label:"Step 3 Approved",type:Date,sortable:!0,class:["min-w-28"],step:3},{name:"step_4_received_date",label:"Step 4 Received",type:Date,sortable:!0,class:["min-w-28"],step:4},{name:"step_4_approval_date",label:"Step 4 Approved",type:Date,sortable:!0,class:["min-w-28"],step:4}],waitingOn:null,showDeleted:!1}},computed:{...(0,v.L8)({applications:"applications/all"}),filteredData(){let e=this.applications.filter((e=>!this.epTypeId||e.expert_panel_type_id==this.epTypeId)).filter((e=>!!this.showCompleted||null==e.date_completed));return this.waitingOn&&(e=e.filter((e=>e.pendingActionsByAssignee[this.waitingOn].length>0))),this.showDeleted||(e=e.filter((e=>null===e.deleted_at))),e},showCompleted:{set(e){let t=this.$route.query,l=this.$route.path,a={...t};e?a={...t,"show-completed":1}:delete a["show-completed"],this.$router.replace({path:l,query:a})},get(){return Boolean(parseInt(this.$route.query["show-completed"]))},immediate:!0},selectedFields(){if(1==this.showAllInfo){const e=2==this.epTypeId?[1,2,3,4]:[1],t=this.allInfoFields.filter((t=>e.includes(t.step)));return[...this.fields,...t]}return this.fields},showAllInfo:{immediate:!0,get(){return Object.keys(this.$route.query).includes("showAllInfo")?this.$route.query.showAllInfo:0},set(e){const t={...this.$route.query};t.showAllInfo=e,this.$router.replace({path:this.$route.path,query:t})}},remainingHeight(){return{height:"calc(100vh - 220px)"}},assignees(){return Object.values(k.nextActions.assignees)}},methods:{getApplications(){const e={},t={expert_panel_type_id:this.epTypeId};Object.keys(t).length>0&&(e.where=t),this.showDeleted&&(e.showDeleted=1),this.$store.dispatch("applications/getApplications",e)},goToApplication(e){e.deleted_at?alert("The application for "+e.name+" has been deleted.  Details cannot be viewed."):this.$router.push({name:"ApplicationDetail",params:{uuid:e.group.uuid}})}},mounted(){this.getApplications()},setup(){const{sort:e,filter:t}=(0,w.A)({field:"full_name",desc:!1});return{sort:e,filter:t}}},C=l(6262);const I=(0,C.A)(A,[["render",g]]);var L=I},230:function(e,t,l){l.r(t),l.d(t,{default:function(){return f}});var a=l(641),n=l(3751),i=l(33);const s=(0,a.Lk)("h2",{class:"pb-2 border-b mb-4"},"Initiate Application",-1),r=(0,a.Lk)("option",{value:null},"Select...",-1),o=["value"],p=["for"],d=["value","id"];function u(e,t,l,u,c,m){const h=(0,a.g2)("input-row"),b=(0,a.g2)("checkbox"),_=(0,a.g2)("button-row"),f=(0,a.g2)("form-container");return(0,a.uX)(),(0,a.Wv)(f,{onKeydown:(0,n.jR)(m.save,["enter"])},{default:(0,a.k6)((()=>[s,(0,a.bF)(h,{label:"Working Name",errors:c.errors.working_name,type:"text",modelValue:this.app.working_name,"onUpdate:modelValue":t[0]||(t[0]=e=>this.app.working_name=e),placeholder:"A recognizable name"},null,8,["errors","modelValue"]),(0,a.bF)(h,{label:"CDWG",errors:c.errors.cdwg_id},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.app.cdwg_id=e)},[r,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cdwgs,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,o)))),128))],512),[[n.u1,c.app.cdwg_id]])])),_:1},8,["errors"]),(0,a.bF)(h,{label:"EP Type",errors:c.errors.expert_panel_type_id},{default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.epTypes,(e=>((0,a.uX)(),(0,a.CE)("label",{for:`ep-${e.id}-radio`,key:e.id},[(0,a.bo)((0,a.Lk)("input",{type:"radio",value:e.id,"onUpdate:modelValue":t[2]||(t[2]=e=>c.app.expert_panel_type_id=e),id:`ep-${e.id}-radio`},null,8,d),[[n.XL,c.app.expert_panel_type_id]]),(0,a.Lk)("div",null,(0,i.v_)(e.name),1)],8,p)))),128))])])),_:1},8,["errors"]),(0,a.bF)(h,{errors:c.errors.date_initiated},{default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(b,{modelValue:c.showInitiationDate,"onUpdate:modelValue":t[3]||(t[3]=e=>c.showInitiationDate=e),id:"show-initiation-checkbox",label:"Backdate this initiation"},null,8,["modelValue"])]),(0,a.bo)((0,a.bF)(h,{type:"date",label:"Initiation Date",modelValue:c.app.date_initiated,"onUpdate:modelValue":t[4]||(t[4]=e=>c.app.date_initiated=e)},null,8,["modelValue"]),[[n.aG,c.showInitiationDate]])])])),_:1},8,["errors"]),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.Lk)("button",{class:"btn",onClick:t[5]||(t[5]=(...e)=>m.cancel&&m.cancel(...e))},"Cancel"),(0,a.Lk)("button",{class:"btn blue",onClick:t[6]||(t[6]=(...e)=>m.save&&m.save(...e))},"Initiate Application")])),_:1})])),_:1},8,["onKeydown"])}var c=l(6278),m=l(1877),h={name:"CreateApplicationForm",props:{},emits:["canceled","saved"],data(){return{visible:!1,showInitiationDate:!1,app:{working_name:null,cdwg_id:null,expert_panel_type_id:null,date_initiated:(0,m.Yq)(new Date)},epTypes:[{name:"GCEP",id:1},{name:"VCEP",id:2}],errors:{}}},computed:{...(0,c.L8)({cdwgs:"cdwgs/all"}),hasErrors(){return Object.keys(this.errors).length>0}},watch:{"app.working_name":function(){this.clearErrors("working_name")},"app.cdwg_id":function(){this.clearErrors("cdwg_id")},"app.expert_panel_type_id":function(){this.clearErrors("expert_panel_type_id")}},methods:{cancel(){this.initForm(),this.$emit("canceled")},async save(){try{await this.$store.dispatch("applications/initiateApplication",this.app),this.$emit("saved",this.app)}catch(e){if(e.response&&422==e.response.status&&e.response.data.errors)return void(this.errors=e.response.data.errors);throw e}},initForm(){this.initErrors(),this.initAppData()},initAppData(){this.app={working_name:null,cdwg_id:null,expert_panel_type_id:null,date_initiated:(0,m.Yq)(new Date)}},clearErrors(e){e?delete this.errors[e]:this.initErrors()},initErrors(){this.errors={}}}},b=l(6262);const _=(0,b.A)(h,[["render",u]]);var f=_},802:function(e,t,l){l.r(t),l.d(t,{default:function(){return b}});var a=l(641);const n={class:"home"},i={class:"mb-2 mt-4"},s={class:"tabs"},r=(0,a.eW)("VCEPS"),o=(0,a.eW)("GCEPS"),p={class:"p-4 border rounded-tr-lg rounded-b-lg bg-white"};function d(e,t,l,d,u,c){const m=(0,a.g2)("router-link"),h=(0,a.g2)("router-view"),b=(0,a.g2)("create-application-form"),_=(0,a.g2)("modal-dialog");return(0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>u.showModal=!0),class:"btn blue"},"Initiate Application"),(0,a.Lk)("div",i,[(0,a.Lk)("div",s,[(0,a.bF)(m,{to:{name:"vceps"},class:"tab"},{default:(0,a.k6)((()=>[r])),_:1}),(0,a.bF)(m,{to:{name:"gceps"},class:"tab"},{default:(0,a.k6)((()=>[o])),_:1})]),(0,a.Lk)("div",p,[(0,a.bF)(h)])]),(0,a.bF)(_,{modelValue:u.showModal,"onUpdate:modelValue":t[2]||(t[2]=e=>u.showModal=e),size:"md",onClosed:t[3]||(t[3]=t=>e.$refs.initiateform.initForm())},{default:(0,a.k6)((()=>[(0,a.bF)(b,{name:"modal",onCanceled:t[1]||(t[1]=e=>u.showModal=!1),onSaved:c.handleApplicationInitiated,ref:"initiateform"},null,8,["onSaved"])])),_:1},8,["modelValue"])])}var u=l(230),c={name:"ApplicationsIndex",components:{CreateApplicationForm:u["default"]},data(){return{showModal:!1}},computed:{},methods:{handleApplicationInitiated(e){this.showModal=!1,this.$router.push({name:"AddMemberToApplication",params:{uuid:e.uuid}})}}},m=l(6262);const h=(0,m.A)(c,[["render",d],["__scopeId","data-v-2ac81c59"]]);var b=h},2279:function(e,t,l){l.r(t),l.d(t,{default:function(){return p}});var a=l(641);function n(e,t,l,n,i,s){const r=(0,a.g2)("applications-table");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(r,{"ep-type-id":1})])}var i=l(271),s={components:{ApplicationsTable:i.A},props:{},data(){return{}}},r=l(6262);const o=(0,r.A)(s,[["render",n]]);var p=o},5168:function(e,t,l){l.r(t),l.d(t,{default:function(){return p}});var a=l(641);function n(e,t,l,n,i,s){const r=(0,a.g2)("applications-table");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(r,{"ep-type-id":2})])}var i=l(271),s={components:{ApplicationsTable:i.A}},r=l(6262);const o=(0,r.A)(s,[["render",n]]);var p=o}}]);
//# sourceMappingURL=application-index.de10e6fb.js.map