{"version":3,"file":"js/779.0ad46568.js","mappings":"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","sources":["webpack://epam/./src/forms/profile_form.js","webpack://epam/./src/components/people/ProfileForm.vue","webpack://epam/./src/components/people/ProfileForm.vue?fb30","webpack://epam/./src/components/people/ProfilePhotoForm.vue","webpack://epam/./src/components/people/ProfilePhotoForm.vue?fd00","webpack://epam/./src/views/PersonEdit.vue","webpack://epam/./src/views/PersonEdit.vue?cff1"],"sourcesContent":["import {ref, computed} from 'vue';\nimport api from '@/http/api';\nimport {kebabCase} from '@/utils'\nimport TimezoneSearchSelect from '@/components/forms/TimezoneSearchSelect.vue'\nimport InstitutionSearchSelect from '@/components/forms/InstitutionSearchSelect.vue'\nimport AddressInput from '@/components/forms/AddressInput.vue'\n\nexport const lookups = ref({\n    countries:[],\n    primaryOccupations:[],\n    races:[],\n    ethnicities:[],\n    genders:[],\n});\n\nexport const profileFields = computed(() => [\n    { name: 'first_name'},\n    { name: 'last_name'},\n    { name: 'email'},\n    {\n        name: 'institution_id',\n        label: 'Institution',\n        type: 'component',\n        component: {\n            component: InstitutionSearchSelect\n        },\n    },\n    { \n        name: 'credentials', \n        type: 'large-text',\n        notes: 'Include degrees and certifications such as PhD, MD, CGC, etc. Please include professional roles and associations in your biography.'\n    },\n    { name: 'biography', type: 'large-text'},\n    {\n        name: '*', // specifies passing entire modelValue to component.\n        type: 'component',\n        label: 'Address',\n        component: {\n            component: AddressInput\n        },\n    },\n    { \n        name: 'country_id', \n        label: 'Country',\n        type: 'select', \n        options: lookups.value.countries\n    },\n    { name: 'phone'},\n    { \n        name: 'timezone', \n        label: 'Timezone',\n        type: 'component', \n        component: {\n            component: TimezoneSearchSelect\n        },\n    },\n]);\n\nexport const demographicFields = computed(() => [\n    {\n        name: 'primary_occupation_id',\n        label: 'Primary Occupation',\n        type: 'select',\n        options: lookups.value.primaryOccupations\n    },\n    {\n        name: 'primary_occupation_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.primary_occupation_id == 100\n        }\n    },\n    {\n        name: 'race_id',\n        label: 'Race',\n        type: 'select',\n        options: lookups.value.races\n    },\n    {\n        name: 'race_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.race_id == 100\n        }\n    },\n    {\n        name: 'ethnicity_id',\n        label: 'Ethnicity',\n        type: 'select',\n        options: lookups.value.ethnicities\n    },\n    {\n        name: 'enthnicity_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.enthnicity_id == 100\n        }\n    },\n    {\n        name: 'gender_id',\n        label: 'Gender',\n        type: 'select',\n        options: lookups.value.genders\n    },\n    {\n        name: 'gender_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.gender_id == 100\n        }\n    },\n]);\n\nexport const getLookups = () => {\n    Object.keys(lookups.value).forEach(lkup => {\n        api.get(`/api/people/lookups/${kebabCase(lkup)}`)\n            .then(response => {\n                lookups.value[lkup] = response.data.data.map(i => ({value: i.id, label: i.name}));\n            })\n            .catch(error => console.error(error));\n    })\n}\n\nexport default {\n    profileFields,\n    demographicFields,\n    lookups,\n    getLookups,\n}","<template>\n    <div>\n        <h3>Profile</h3>\n        <div class=\"float-right\" v-if=\"(hasPermission('people-manage') || userIsPerson(person))\"\n        >\n            <profile-photo-form :person=\"person\" style=\"width: 100px; height: 100px;\" />\n        </div>\n        <data-form \n            :fields=\"fields\" \n            v-model=\"profile\" \n            :errors=\"errors\"\n        ></data-form>\n        <hr class=\"my-4\">\n\n        <button-row @submitted=\"save\" @canceled=\"cancel()\" submit-text=\"Save\"></button-row>\n    </div>\n</template>\n<script>\nimport isValidationError from '@/http/is_validation_error'\nimport {onMounted} from 'vue'\nimport {getLookups, profileFields, demographicFields, lookups} from '@/forms/profile_form';\nimport ProfilePhotoForm from '@/components/people/ProfilePhotoForm.vue';\nexport default {\n    name: 'ProfileForm',\n    components: {\n        ProfilePhotoForm\n    },\n    props: {\n        person: {\n            type: Object,\n            required: true\n        }\n    },\n    emits: [\n        'saved',\n        'canceled'\n    ],\n    data() {\n        return {\n            errors: {},\n            profile: {},\n            page: 'profile',\n            institutionId: null,\n            timezone: null\n        }\n    },\n    computed: {\n        fields () {\n            let editableFields = [...this.profileFields];\n            if (!this.hasPermission('people-manage') && !this.userIsPerson(this.person)) {\n                editableFields =  editableFields.filter(f => ['first_name', 'last_name', 'email', 'credentials'].includes(f.name));\n            }\n            return editableFields;\n\n            // return (this.page == 'profile') ? this.profileFields : this.demographicFields;\n        },\n        title () {\n            return this.page == 'profile' ? 'Please fill out your profile' : 'Please share your demographic information.'\n        }\n    },\n    watch: {\n        person () {\n            this.initProfile();\n        }\n    },\n    methods: {\n        initProfile () {\n            this.profile = {...this.person.attributes};\n        },\n        async save () {\n            try {\n                await this.$store.dispatch(\n                        'people/updateProfile', \n                        {uuid: this.person.uuid, attributes: this.profile}\n                    )                \n                    .then(() => {\n                        this.$store.dispatch('getCurrentUser', {force: true})\n                        this.$store.commit('pushSuccess', 'Your profile has been updated.')\n                    })\n                    \n                this.errors = {};\n                this.$emit('saved');\n            } catch (error) {\n                if (isValidationError(error)) {\n                    this.errors = error.response.data.errors;\n                }\n            }\n        },\n        cancel () {\n            this.initProfile();\n            this.errors = {};\n            this.$emit('canceled');\n        }\n    },\n    setup () {\n        onMounted(() => getLookups());\n\n        return {\n            profileFields,\n            demographicFields,\n            getLookups,\n            lookups,\n        }\n    },\n    async mounted () {\n        this.initProfile()\n    }\n}\n</script>","import { render } from \"./ProfileForm.vue?vue&type=template&id=22ed15e6\"\nimport script from \"./ProfileForm.vue?vue&type=script&lang=js\"\nexport * from \"./ProfileForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div :class=\"{'cursor-wait': saving}\">\n        <div class=\"border border-gray-200 rounded-lg\">\n            <img \n                :src=\"srcPath\" \n                :alt=\"altText\"\n                class=\"rounded-t-lg w-full\"\n                @click=\"initUpload\"\n            >\n            <button \n                @click=\"initUpload\"\n                class=\"border border-t-0 bg-gray-200 block w-full\"\n            >\n                Edit\n            </button>\n        </div>\n\n        <teleport to='body'>\n            <modal-dialog v-model=\"showForm\" title=\"Upload a new profile photo\">\n                <ImageCropper \n                    :image-src=\"srcPath\" \n                    @cropped=\"setCroppedImageBlob\"\n                />\n\n                <input-row hideLabel :errors=\"errors.profile_photo\">\n                    <input type=\"file\" @change=\"setFile\" ref=\"fileInput\">\n                </input-row>\n\n                <button-row submit-text=\"Save\" @submitted=\"saveCropped\" @canceled=\"cancelCropped\" v-if=\"!saving\"/>\n                <div v-else>Saving...</div>\n            </modal-dialog>\n        </teleport>\n    </div>\n</template>\n<script>\nimport ImageCropper from '@/components/ImageCropper.vue'\nimport {api, isValidationError} from '@/http'\n\nexport default {\n    name: 'ProfilePhotoForm',\n    components: {\n        ImageCropper\n    },\n    props: {\n        person: {\n            type: Object,\n            required: true\n        }\n    },\n    data() {\n        return {\n            showForm: false,\n            file: null,\n            croppedImageBlob: null,\n            errors: {},\n            saving: false\n        }\n    },\n    watch: {\n        person: {\n            immediate: true,\n            deep: true,\n            handler (to) {\n                if (to.profile_photo) {\n                    this.fetchProfileImage();\n                }\n            }\n        }\n    },\n    computed: {\n        srcPath () {\n            if (this.file) {\n                console.log('create from this.file');\n                return URL.createObjectURL(this.file);\n            }\n            if (this.person.profile_photo) {\n                return `/profile-photos/${this.person.profile_photo}`\n            }\n            return '/images/default_profile.jpg';\n        },\n        profilePhoto () {\n            if (this.person.profile_photo) {\n                return `/profile-photos/${this.person.profile_photo}`\n            }\n            return '/images/default_profile.jpg';\n        },\n        altText () {\n            return this.person.profile_photo_path \n                ? `${this.person.name} profile photo.` \n                : 'Default profile image';\n        },\n    },\n    methods: {\n        initUpload () {\n            this.showForm = true;\n            this.$nextTick(() => {\n                window.dispatchEvent(new Event('resize'));\n            });\n        },\n        setFile () {\n            this.file = this.$refs.fileInput.files[0]\n        },\n        setCroppedImageBlob (blob) {            \n            this.croppedImageBlob = blob;\n        },\n        async fetchProfileImage () {\n            const url = `/api/people/${this.person.uuid}/profile-photo`;\n            const options = {\n                Accept: 'application/octet-stream',\n                timeout: 30000,\n                responseType: 'blob'\n            };\n            this.file = await api.get(url, options)\n                            .then(rsp => {\n                                if( !(rsp.data instanceof Blob)) return;\n\n                                return new Blob([rsp.data]);\n                            });\n        },\n        saveCropped () {\n            if (this.croppedImageBlob.size > 2000000) {\n                const width = 400;\n                const img = new Image();\n                img.src = URL.createObjectURL(this.croppedImageBlob);\n\n                img.addEventListener('load', () => {\n                    var canvas = document.createElement('canvas'),\n                    ctx = canvas.getContext(\"2d\"),\n\n                    oc = document.createElement('canvas'),\n                    octx = oc.getContext('2d');\n\n                    canvas.width = width; // destination canvas size\n                    canvas.height = canvas.width * img.height / img.width;\n\n                    var cur = {\n                        width: Math.floor(img.width * 0.5),\n                        height: Math.floor(img.height * 0.5)\n                    }\n\n                    oc.width = cur.width;\n                    oc.height = cur.height;\n\n                    octx.drawImage(img, 0, 0, cur.width, cur.height);\n\n                    while (cur.width * 0.5 > width) {\n                        cur = {\n                            width: Math.floor(cur.width * 0.5),\n                            height: Math.floor(cur.height * 0.5)\n                        };\n                        octx.drawImage(oc, 0, 0, cur.width * 2, cur.height * 2, 0, 0, cur.width, cur.height);\n                    }\n                    ctx.drawImage(oc, 0, 0, cur.width, cur.height, 0, 0, canvas.width, canvas.height);\n                    canvas.toBlob(blob => {\n                        console.log(blob.size/1000/1000);\n                        this.storeImage(blob);\n                    }, null, .5)\n                });\n\n                return;\n            }\n\n            this.storeImage(this.croppedImageBlob)\n        },\n        storeImage (blob) {\n            this.saving = true;\n            const formData = new FormData();\n\n            formData.append('profile_photo', blob);\n\n            api.post(`/api/people/${this.person.uuid}/profile-photo`, formData)\n                .then(() => {\n                    this.$store.dispatch('people/getPerson', {uuid: this.person.uuid});\n                    this.showForm = false;\n                    this.file = null;\n                    this.saving = false;\n                })\n                .catch(error => {\n                    if (isValidationError(error)) {\n                        this.errors = error.response.data.errors;\n                        this.saving = false;\n                        return;\n                    }\n                    this.saving = false;\n                    throw (error);\n                })\n        },\n        cancelCropped () {\n            this.showForm = false;\n            this.file = null;\n        }\n    }\n}\n</script>","import { render } from \"./ProfilePhotoForm.vue?vue&type=template&id=4be868c8\"\nimport script from \"./ProfilePhotoForm.vue?vue&type=script&lang=js\"\nexport * from \"./ProfilePhotoForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div>\n        <profile-form :person=\"person\"\n            v-model=\"person\"\n            @saved=\"goBack()\"\n            @canceled=\"goBack()\"\n        ></profile-form>\n    </div>\n</template>\n<script>\nimport ProfileForm from '@/components/people/ProfileForm.vue'\n\nexport default {\n    name: 'PersonEdit',\n    components: {\n        ProfileForm\n    },\n    props: {\n        uuid: {\n            required: true,\n            type: String\n        }\n    },\n    computed: {\n        person () {\n            return this.$store.getters['people/currentItem'];\n        }\n    },\n    watch: {\n        uuid: {\n            immediate: true,\n            handler () {\n                this.$store.dispatch('people/getPerson', {uuid: this.uuid});\n            }\n        }\n    },\n    methods: {\n        goBack () {\n            this.$router.go(-1);\n        }\n    }\n}\n</script>","import { render } from \"./PersonEdit.vue?vue&type=template&id=7ddf0198\"\nimport script from \"./PersonEdit.vue?vue&type=script&lang=js\"\nexport * from \"./PersonEdit.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["lookups","ref","countries","primaryOccupations","races","ethnicities","genders","profileFields","computed","name","label","type","component","InstitutionSearchSelect","notes","AddressInput","options","value","TimezoneSearchSelect","demographicFields","placeholder","show","data","primary_occupation_id","race_id","enthnicity_id","gender_id","getLookups","Object","keys","forEach","lkup","api","kebabCase","then","response","map","i","id","catch","error","console","_createElementVNode","class","_createElementBlock","_hoisted_1","_ctx","$props","_createVNode","_component_profile_photo_form","person","style","_component_data_form","fields","$options","$data","$event","errors","_hoisted_3","_component_button_row","onSubmitted","onCanceled","components","ProfilePhotoForm","props","required","emits","profile","page","institutionId","timezone","editableFields","this","hasPermission","userIsPerson","filter","f","includes","title","watch","initProfile","methods","attributes","async","$store","dispatch","uuid","force","commit","$emit","isValidationError","cancel","setup","onMounted","__exports__","render","src","alt","onClick","_createBlock","_Teleport","to","_component_modal_dialog","_component_ImageCropper","onCropped","_component_input_row","hideLabel","profile_photo","onChange","ImageCropper","showForm","file","croppedImageBlob","saving","immediate","deep","handler","fetchProfileImage","srcPath","log","URL","createObjectURL","profilePhoto","altText","profile_photo_path","initUpload","$nextTick","window","dispatchEvent","Event","setFile","$refs","fileInput","files","setCroppedImageBlob","blob","url","Accept","timeout","responseType","rsp","Blob","saveCropped","size","width","img","Image","addEventListener","canvas","document","createElement","ctx","getContext","oc","octx","height","cur","Math","floor","drawImage","toBlob","storeImage","formData","FormData","append","cancelCropped","_component_profile_form","onSaved","ProfileForm","String","getters","goBack","$router","go"],"sourceRoot":""}