(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6aaec096"],{5257:function(e,t,n){"use strict";var a=n("5530"),r=(n("caad"),n("2532"),n("b64b"),n("ac1f"),n("5319"),n("4de4"),n("d3b7"),n("6c02")),c=n("7a23");t["a"]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(r["d"])(),n=Object(r["c"])();e||(console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: "fieldname", desc: boolean}'),e=e||{field:"name",desc:!1});var o=Object(c["computed"])({immediate:!0,get:function(){return Object.keys(n.query).includes("sort-field")?{field:n.query["sort-field"],desc:Boolean(parseInt(n.query["sort-desc"]))}:e},set:function(e){var r={"sort-field":e.field,"sort-desc":e.desc?1:0},c=Object(a["a"])(Object(a["a"])({},n.query),r);t.replace({path:n.path,query:c})}}),l=Object(c["computed"])({set:function(e){var r=n.query,c=n.path,o=Object(a["a"])({},r);e?o=Object(a["a"])(Object(a["a"])({},r),{filter:e}):delete o.filter,t.replace({path:c,query:o})},get:function(){return n.query.filter},immediate:!0});return{sort:o,filter:l}}},"85ae":function(e,t,n){},d75c:function(e,t,n){"use strict";n("85ae")},df40:function(e,t,n){"use strict";n.r(t);n("4e82"),n("4de4"),n("d3b7"),n("b0c0");var a=n("7a23"),r=Object(a["createElementVNode"])("h1",null,"Mail Log",-1),c={class:"mb-2"},o=Object(a["createTextVNode"])("Filter: "),l={key:0},i=["onClick"];function s(e,t,n,s,d,u){var b=Object(a["resolveComponent"])("data-table"),m=Object(a["resolveComponent"])("mail-detail"),f=Object(a["resolveComponent"])("modal-dialog"),p=Object(a["resolveComponent"])("custom-email-form");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[r,Object(a["createVNode"])(b,{fields:d.fields,data:u.filteredMail,"row-class":"cursor-pointer","row-click-handler":u.showMailDetail,sort:s.sort,"onUpdate:sort":t[1]||(t[1]=function(e){return s.sort=e}),paginated:""},{header:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("div",c,[o,Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return s.filter=e})},null,512),[[a["vModelText"],s.filter]])])]})),"cell-to":Object(a["withCtx"])((function(e){var t=e.item;return[Object(a["createElementVNode"])("ul",null,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(t.to,(function(e){return Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:e.address},[e.name?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",l,Object(a["toDisplayString"])(e.name)+" - ",1)):Object(a["createCommentVNode"])("",!0),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.address),1)])})),128))])]})),"cell-actions":Object(a["withCtx"])((function(t){var n=t.item;return[Object(a["createElementVNode"])("div",null,[e.hasPermission("people-manage")?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:0,class:"btn btn-xs",onClick:Object(a["withModifiers"])((function(e){return u.initResend(n)}),["stop"])},"Resend",8,i)):Object(a["createCommentVNode"])("",!0)])]})),_:1},8,["fields","data","row-click-handler","sort"]),(Object(a["openBlock"])(),Object(a["createBlock"])(a["Teleport"],{to:"body"},[Object(a["createVNode"])(f,{modelValue:d.showDetail,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d.showDetail=e})},{default:Object(a["withCtx"])((function(){return[e.hasPermission("people-manage")?(Object(a["openBlock"])(),Object(a["createBlock"])(m,{key:0,mail:d.currentEmail,onResend:t[2]||(t[2]=function(e){return u.initResend(d.currentEmail)})},null,8,["mail"])):Object(a["createCommentVNode"])("",!0)]})),_:1},8,["modelValue"]),Object(a["createVNode"])(f,{title:"Resend Email",modelValue:d.showResendDialog,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d.showResendDialog=e})},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(p,{"mail-data":d.currentEmail,onSent:u.cleanupResend,onCanceled:u.cleanupResend},null,8,["mail-data","onSent","onCanceled"])]})),_:1},8,["modelValue"])]))])}var d=n("1da1"),u=(n("96cf"),n("b64b"),n("a15b"),n("4d63"),n("c607"),n("ac1f"),n("2c3e"),n("25f0"),n("466d"),n("f96b")),b=n("e328"),m=n("5257"),f={props:{},setup:function(){var e=Object(m["a"])({field:"created_at",desc:!0}),t=e.sort,n=e.filter;return{sort:t,filter:n}},data:function(){return{showDetail:!1,fields:[{name:"to",sortable:!0,type:Array,resolveValue:function(e){var t=Object.keys(e.to);return 0==t.length?"":1==t.length?t[0]:t.join("; ")}},{name:"subject",sortable:!0,type:String},{name:"created_at",label:"Sent at",sortable:!0,resolveValue:function(e){return Object(b["c"])(e.created_at)},resolveSort:function(e){return e.created_at},type:String},{name:"actions",label:"",sortable:!1}],data:[],currentEmail:{},showResendDialog:!1}},computed:{filteredMail:function(){if(!this.filter)return this.data;var e=new RegExp(".*".concat(this.filter,".*"),"i");return this.data.filter((function(t){return t.to.filter((function(t){return t.name&&t.name.match(e)||t.address&&t.address.match(e)})).length>0||t.to.address&&t.to.address.match(e)||t.subject.match(e)}))}},methods:{getMailLog:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].get("/api/mail-log").then((function(t){e.data=t.data}));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),alert(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},showMailDetail:function(e){this.currentEmail=e,this.showDetail=!0},initResend:function(e){this.currentEmail=e,this.showResendDialog=!0},cleanupResend:function(){this.currentEmail={},this.showResendDialog=!1,this.getMailLog()}},mounted:function(){this.getMailLog()}},p=(n("d75c"),n("6b0d")),j=n.n(p);const h=j()(f,[["render",s]]);t["default"]=h}}]);
//# sourceMappingURL=chunk-6aaec096.91b0e69a.js.map