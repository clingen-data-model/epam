{"version":3,"file":"js/institution-list.99ca32c1.js","mappings":"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","sources":["webpack://epam/./src/composables/router_aware_sort_and_filter.js","webpack://epam/./src/views/institutions/InstitutionList.vue","webpack://epam/./src/components/institutions/InstitutionApprovalForm.vue","webpack://epam/./src/components/institutions/InstitutionApprovalForm.vue?b22b","webpack://epam/./src/components/institutions/InstitutionUpdateForm.vue","webpack://epam/./src/components/institutions/InstitutionUpdateForm.vue?bb98","webpack://epam/./src/components/institutions/InstitutionMergeForm.vue","webpack://epam/./src/components/institutions/InstitutionMergeForm.vue?55b9","webpack://epam/./src/views/institutions/InstitutionList.vue?159e"],"sourcesContent":["import { useRouter, useRoute } from 'vue-router'\nimport {computed} from 'vue'\n\nexport default function (defaultSort = null) {\n    const router = useRouter()\n    const route = useRoute()\n    if (!defaultSort){\n        console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: \"fieldname\", desc: boolean}')\n        defaultSort = (defaultSort) ? defaultSort : {field: 'name', desc: false}\n    }\n    \n    const sort = computed({\n        immediate: true,\n        get() {\n            if (Object.keys(route.query).includes('sort-field')) {\n                return {\n                    field: route.query['sort-field'],\n                    desc: Boolean(parseInt(route.query['sort-desc']))\n                }\n            }\n            return defaultSort;\n        },\n        set(sortObj) {\n            const newSortQuery = {'sort-field': sortObj.field, 'sort-desc': sortObj.desc ? 1 : 0}\n    \n            const newQuery = {\n                ...route.query, \n                ...newSortQuery\n            };\n    \n            router.replace({path: route.path, query: newQuery})\n        }\n    });\n    \n    const filter = computed({\n        set(value) {\n            let currentQuery = route.query;\n            let currentPath = route.path;\n    \n            let updatedQuery = {...currentQuery};\n    \n            if (!value) {\n                delete updatedQuery.filter;\n            } else {\n                updatedQuery = {...currentQuery, ...{'filter': value} };\n            }\n    \n            router.replace({path: currentPath, query: updatedQuery})\n        },\n        get() {\n            return route.query.filter\n        },\n        immediate: true\n    });\n\n    return {\n        sort,\n        filter\n    }\n}\n","<template>\n    <div>\n        <h1>Institutions</h1>\n        <data-table\n            paginated\n            :data=\"filteredItems\"\n            :fields=\"fields\"\n            v-model:sort=\"sort\"\n            :reset-page-on-data-change=\"false\"\n        >\n            <template v-slot:header>\n                <label>\n                    Filter:\n                    <input type=\"text\" v-model=\"filter\">\n                </label>\n            </template>\n            <template v-slot:cell-actions=\"{item}\">\n                <dropdown-menu hide-cheveron>\n                    <template v-slot:label>\n                        <button class=\"btn btn-xs\">&hellip;</button>\n                    </template>\n\n                    <dropdown-item @click=\"edit(item)\">Edit</dropdown-item>\n                    <dropdown-item @click=\"initApprove(item)\">Approve</dropdown-item>\n                    <dropdown-item @click=\"initMerge(item)\">Merge into another</dropdown-item>\n                    <dropdown-item @click=\"initDelete(item)\">Delete</dropdown-item>\n                </dropdown-menu>\n            </template>\n        </data-table>\n        <teleport to=\"body\">\n            <modal-dialog v-model=\"showApproveDialog\" :title=\"`Approve ${currentItem.name}`\">\n                <institution-approval-form v-model=\"currentItem\" @saved=\"handleSaved\" @canceled=\"handleCancel\" />\n            </modal-dialog>\n            <modal-dialog v-model=\"showEditDialog\" :title=\"`Edit ${currentItem.name}`\">\n                <institution-update-form v-model=\"currentItem\" @saved=\"handleSaved\" @canceled=\"handleCancel\" />\n            </modal-dialog>\n            <modal-dialog v-model=\"showMergeDialog\" title=\"Merge Institutions\">\n                <institution-merge-form :obsoletes=\"[currentItem]\" @saved=\"handleMerge\" @canceled=\"showMergeDialog = false\" />\n            </modal-dialog>\n            <modal-dialog v-model=\"showDeleteConfirmation\" title=\"Delete Institution\" size=\"sm\">\n                <div v-if=\"currentItem.people_count > 0\">\n                    <p>You cannot delete an institution people are using.</p>\n                    <p>Either edit this this institution or merge it into another.</p>\n                </div>\n                <div v-else>\n                    You are about to delete the {{currentItem.name}}\n                    <button-row\n                        submit-text=\"Delete\"\n                        @submitted=\"deleteItem\"\n                        @canceled=\"showDeleteConfirmation = false\"\n                    ></button-row>\n                </div>\n            </modal-dialog>\n        </teleport>\n    </div>\n</template>\n<script>\nimport sortAndFilter from '@/composables/router_aware_sort_and_filter';\nimport {getAllInstitutions, deleteInstitution} from '@/forms/institution_form'\nimport InstitutionApprovalForm from '@/components/institutions/InstitutionApprovalForm.vue'\nimport InstitutionUpdateForm from '@/components/institutions/InstitutionUpdateForm.vue'\nimport InstitutionMergeForm from '@/components/institutions/InstitutionMergeForm.vue'\n\nexport default {\n    name: 'InstitutionList',\n    components: {\n        InstitutionUpdateForm,\n        InstitutionApprovalForm,\n        InstitutionMergeForm,\n    },\n    data() {\n        return {\n            items: [],\n            fields: [\n                {\n                    name: 'id',\n                    label: 'ID',\n                    type: Number,\n                    sortable: true,\n                },\n                {\n                    name: 'name',\n                    type: String,\n                    sortable: true\n                },\n                {\n                    name: 'abbreviation',\n                    type: String,\n                    sortable: true\n                },\n                {\n                    name: 'country.name',\n                    label: 'Country',\n                    type: String,\n                    sortable: true,\n                },\n                {\n                    name: 'people_count',\n                    label: '# People',\n                    type: Number,\n                    sortable: true\n                },\n                {\n                    name: 'approved',\n                    type: Boolean,\n                    sortable: true,\n                    resolveValue (item) {\n                        return item.approved ? 'Approved' : null;\n                    },\n                    resolveSort (item) {\n                        return item.approved;\n                    }\n                },\n                {\n                    name: 'actions',\n                    label: '',\n                    sortable: false\n                }\n\n            ],\n            currentItem: {country: {}},\n            showApproveDialog: false,\n            showEditDialog: false,\n            showMergeDialog: false,\n            showDeleteConfirmation: false,\n        }\n    },\n    computed: {\n        filteredItems () {\n            if (!this.filter) {\n                return this.items;\n            }\n            const pattern = new RegExp(`.*${this.filter}.*`, 'i');\n            return this.items.filter(item => {\n                return item.name.match(pattern)\n                    || (item.abbreviation && item.abbreviation.match(pattern))\n                    || (item.country && item.country.name.match(pattern));\n            })\n        },\n        currentIndex () {\n            return this.items.findIndex(i => i.id == this.currentItem.id);\n        }\n    },\n    methods: {\n        edit (item) {\n            this.showEditDialog = true;\n            this.currentItem = item;\n        },\n        initApprove (item) {\n            this.showApproveDialog = true;\n            this.currentItem = item;\n        },\n        initMerge (item) {\n            this.currentItem = item;\n            this.showMergeDialog = true;\n        },\n        async getInstitutions () {\n            this.items = await getAllInstitutions();\n        },\n        handleSaved() {\n            this.showApproveDialog = false;\n            this.showEditDialog = false;\n\n            this.updateItem();\n            this.currentItem = {country: {}}\n            this.$store.commit(\"pushSuccess\", 'Institution saved.')\n        },\n        handleCancel() {\n            this.showApproveDialog = false;\n            this.showEditDialog = false;\n            this.updateItem();\n            this.currentItem = {country: {}}\n        },\n        handleMerge() {\n            this.items.splice(this.currentIndex, 1);\n            this.showMergeDialog = false;\n            this.$store.commit(\"pushSuccess\", 'Institution merged.')\n        },\n        updateItem() {\n            if (!this.currentItem.id) {\n                return;\n            }\n\n            if (this.currentIndex > -1) {\n                this.items[this.currentIndex] = {...this.currentItem}\n            }\n        },\n        initDelete (item) {\n            this.showDeleteConfirmation = true;\n            this.currentItem = item;\n        },\n        async deleteItem() {\n            if (!this.currentItem.id) {\n                return;\n            }\n\n            if (this.currentItem.people_count > 0) {\n                alert('You cannot delete an institution because it is in use.  Pelaes edit the institution or merge it into another.')\n            }\n            await deleteInstitution(this.currentItem);\n            this.items.splice(this.currentIndex, 1);\n            this.showDeleteConfirmation = false;\n            this.$store.commit(\"pushSuccess\", `${this.currentItem.name} deleted.`);\n        }\n    },\n    setup() {\n        const {sort, filter} = sortAndFilter({field: 'name', desc: false});\n\n        return {\n            sort,\n            filter\n        }\n    },\n    mounted () {\n        this.getInstitutions();\n    }\n}\n</script>\n","<template>\n    <div>\n        Are you sure you want to approve this institution?\n        <dictionary-row label=\"Name\">\n            {{modelValue.name}}\n        </dictionary-row>\n        <dictionary-row label=\"Abbreviation\">{{modelValue.abbreviation || '--'}}</dictionary-row>\n        <dictionary-row label=\"URL\">{{modelValue.url || '--'}}</dictionary-row>\n        <dictionary-row label=\"Country\">{{modelValue.country ? modelValue.country.name : '--'}}</dictionary-row>\n        <dictionary-row label=\"Reportable\">{{modelValue.reportable ? 'Yes' : 'No'}}</dictionary-row>\n        <button-row submit-text=\"Approve\" @submitted=\"approve\" @cancel=\"cancelApproval\" />\n    </div>\n</template>\n<script>\nimport {markApproved} from '@/forms/institution_form'\n\nexport default {\n    name: 'ComponentName',\n    props: {\n        modelValue: {\n            type: Object,\n            required: true\n        }\n    },\n    emits: [\n        'saved',\n        'canceled',\n        'update:modelValue'\n    ],\n    methods: {\n        async approve () {\n            const updatedInst = await markApproved(this.modelValue);\n            this.$emit('update:modelValue', updatedInst);\n            this.$emit('saved', updatedInst)\n        },\n        cancelApproval () {\n            this.$emit('canceled')\n        }\n    }\n}\n</script>","import { render } from \"./InstitutionApprovalForm.vue?vue&type=template&id=686a86c6\"\nimport script from \"./InstitutionApprovalForm.vue?vue&type=script&lang=js\"\nexport * from \"./InstitutionApprovalForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div>\n        <data-form :fields=\"fields\" :errors=\"errors\" v-model=\"workingCopy\" />\n        <button-row submit-text=\"Save\" @submitted=\"save\" @cancel=\"cancel\" />\n    </div>\n</template>\n<script>\nimport {setupMirror} from '@/composables/setup_working_mirror'\nimport {fields, getCountries, countries, updateInstitution} from '@/forms/institution_form'\nimport {isValidationError} from '@/http'\n\nexport default {\n    name: 'InstitutionCreateForm',\n    props: {\n        modelValue: {\n            type: Object,\n            required: true\n        }\n    },\n    emits: [\n        'update:modelValue',\n        'saved',\n        'canceled'\n    ],\n    data() {\n        return {\n            errors: {}\n        }\n    },\n    methods: {\n        async save () {\n            try {\n                this.initErrors();\n                const newInst = await this.updateInstitution(this.workingCopy);\n                this.$emit('update:modelValue', newInst);\n                this.$emit('saved', newInst)\n            } catch (error) {\n                if (isValidationError(error)) {\n                    this.errors = error.response.data.errors\n                }\n            }\n        },\n        cancel () {\n            this.$emit('canceled')\n            this.initInstitution()\n        },\n        initErrors () {\n            this.errors = {};\n        }\n    },\n    setup(props, context) {\n        const {workingCopy} = setupMirror(props, context)\n        \n        return {\n            fields,\n            getCountries,\n            countries,\n            updateInstitution,\n            workingCopy\n        }\n    },\n    mounted () {\n        this.getCountries();\n    }\n}\n</script>","import { render } from \"./InstitutionUpdateForm.vue?vue&type=template&id=4fe24904\"\nimport script from \"./InstitutionUpdateForm.vue?vue&type=script&lang=js\"\nexport * from \"./InstitutionUpdateForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div>\n        <p class=\"mb-8\">\n            Merging institutions will do the following:\n            <ol class=\"list-decimal ml-6\">\n                <li>Transfer all people with the obsolete institution to the authoritiative institution.</li>\n                <li>Delete the obsolete institution.</li>\n            </ol>\n        </p>\n        <input-row label=\"Merge\" vertical>\n            <template v-slot:label>\n                Merge <note class=\"inline-block\">(Obsolete institution that will be deleted)</note>\n            </template>\n            <institution-search-select :model-value=\"obsoleteIds\" @update:modelValue=\"handleObsoleteUpdate\" :allow-add=\"false\"></institution-search-select>\n            \n        </input-row>\n        <input-row label=\"Into\" :errors=\"errors.authority_id\" vertical>\n            <template v-slot:label>Into <note class=\"inline\">(Authoritative institution)</note></template>\n            <institution-search-select v-model=\"authorityId\" :allow-add=\"false\"></institution-search-select>\n        </input-row>\n        <button-row submit-text=\"Merge\" @submitted=\"commitMerge\" @canceled=\"cancelMerge\" />\n    </div>\n</template>\n<script>\nimport {mergeInstitutions} from '@/forms/institution_form'\nimport { isValidationError } from '@/http';\n\nexport default {\n    name: 'InstitutionMergeForm',\n    props: {\n        authority: {\n            type: Object,\n            required: false\n        },\n        obsoletes: {\n            type: Array,\n            default: () => []\n        }\n    },\n    emits: [\n        'saved',\n        'canceled'\n    ],\n    data() {\n        return {\n            authorityId: null,\n            obsoleteIds: [],\n            errors: {}\n        }\n    },\n    watch: {\n        authority: {\n            immediate: true,\n            handler (to) {\n                if (!to) {\n                    return;\n                }\n                this.authorityId = to.id\n            }\n        },\n        obsoletes: {\n            immediate: true,\n            deep: true,\n            handler (to) {\n                this.obsoleteIds = to.map(o => o.id);\n            }\n        }\n    },\n    methods: {\n        handleObsoleteUpdate (value) {\n            if (!value) {\n                this.obsoleteIds = [];\n                return;\n            }\n            this.obsoleteIds = [value];\n        },\n        async commitMerge () {\n            try {\n                this.errors = {};\n                await mergeInstitutions(this.authorityId, this.obsoleteIds);\n                this.authorityId = null;\n                this.obsoleteIds = [];\n                this.$emit('saved');\n            } catch (error) {\n                if (isValidationError(error)) {\n                    this.errors = error.response.data.errors;\n                }\n            }\n        },\n        cancelMerge () {\n            this.authorityId = null;\n            this.obsoleteIds = [];\n            this.$emit('canceled');\n        }\n    }\n}\n</script>","import { render } from \"./InstitutionMergeForm.vue?vue&type=template&id=9fc25b4c\"\nimport script from \"./InstitutionMergeForm.vue?vue&type=script&lang=js\"\nexport * from \"./InstitutionMergeForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./InstitutionList.vue?vue&type=template&id=002ac71e\"\nimport script from \"./InstitutionList.vue?vue&type=script&lang=js\"\nexport * from \"./InstitutionList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["defaultSort","router","useRouter","route","useRoute","console","log","field","desc","sort","computed","immediate","get","Object","keys","query","includes","Boolean","parseInt","set","sortObj","newSortQuery","newQuery","replace","path","filter","value","currentQuery","currentPath","updatedQuery","_createElementVNode","class","_hoisted_9","_hoisted_10","_createElementBlock","_hoisted_1","_createVNode","_component_data_table","paginated","data","$options","fields","$data","$setup","$event","header","type","_withCtx","item","_component_dropdown_menu","label","_hoisted_3","_component_dropdown_item","onClick","_createBlock","_Teleport","to","_component_modal_dialog","title","name","_component_institution_approval_form","onSaved","onCanceled","_component_institution_update_form","_component_institution_merge_form","obsoletes","size","people_count","_hoisted_8","_hoisted_11","_hoisted_12","_toDisplayString","_component_button_row","onSubmitted","_component_dictionary_row","$props","abbreviation","url","country","reportable","onCancel","props","modelValue","required","emits","methods","async","updatedInst","markApproved","this","$emit","cancelApproval","__exports__","_component_data_form","errors","initErrors","newInst","updateInstitution","workingCopy","error","isValidationError","response","cancel","initInstitution","setup","context","setupMirror","getCountries","countries","mounted","_component_input_row","vertical","_component_note","_component_institution_search_select","authority_id","authority","Array","default","authorityId","obsoleteIds","watch","handler","id","deep","map","o","handleObsoleteUpdate","mergeInstitutions","cancelMerge","components","InstitutionUpdateForm","InstitutionApprovalForm","InstitutionMergeForm","items","Number","sortable","String","resolveValue","approved","resolveSort","currentItem","showApproveDialog","showEditDialog","showMergeDialog","showDeleteConfirmation","filteredItems","pattern","RegExp","match","currentIndex","findIndex","i","edit","initApprove","initMerge","getAllInstitutions","handleSaved","updateItem","$store","commit","handleCancel","handleMerge","splice","initDelete","alert","deleteInstitution","sortAndFilter","getInstitutions","render"],"sourceRoot":""}