{"version":3,"sources":["webpack:///./src/views/Coi.vue","webpack:///./src/survey.js","webpack:///./src/views/Coi.vue?676e"],"names":["class","_createElementBlock","$options","_createBlock","_component_card","title","$data","_hoisted_1","_createElementVNode","_Fragment","_renderList","questions","question","key","name","_createVNode","_Transition","_component_input_row","label","question_text","errors","vertical","type","$event","_hoisted_5","options","option","value","_toDisplayString","_component_button_row","show-cancel","onSubmitClicked","_renderSlot","_ctx","_component_note","Question","this","validationRules","validation","show","YesNoQuestion","makeQuestion","questionDef","Survey","surveyDefinition","_name","_questions","map","q","response","rsp","forEach","survey","coiDef","props","code","required","String","data","getResponseTemplate","epName","verifying","saved","saving","redirectCountdown","computed","codeIsValid","coiTitle","groupMemberId","membership","$store","getters","currentUser","person","memberships","find","m","group","expert_panel","coi_code","id","methods","showQuestion","Array","isArray","indexOf","verifyCode","api","get","then","storeResponse","dispatch","coiData","$router","push","is_validation_error","commit","mounted","__exports__","render"],"mappings":"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","file":"js/chunk-ce03ae04.661cb6e5.js","sourcesContent":["<template>\n    <div>\n        <card :title=\"verifying ? `Loading COI Form` : `COI Form not found`\" v-if=\"!codeIsValid\">\n            <div v-if=\"!verifying\">We couldn't find this COI.</div>\n        </card>\n        <card title=\"There's a problem\" v-if=\"!groupMemberId\">\n            We can't seem to find your membership id.  Please try refreshing.\n        </card>\n        <card :title=\"coiTitle\"  class=\"max-w-xl mx-auto relative\" v-if=\"codeIsValid\">\n            <div class=\"relative\">\n                <div \n                    v-for=\"question in survey.questions\"\n                    :key=\"question.name\"\n                            :class=\"question.class\"\n                >\n                    <transition name=\"slide-fade-down\">\n                        <input-row\n                            :label=\"question.question_text\"\n                            :errors=\"errors[question.name]\"\n                            :vertical=\"true\"\n                            v-show=\"showQuestion(question)\"\n                        >\n                        \n                            <textarea  v-if=\"question.type == 'text'\"\n                                class=\"w-full h-24\"\n                                v-model=\"response[question.name]\"\n                                :name=\"question.name\"\n                            ></textarea>\n\n                            <div v-if=\"question.type == 'multiple-choice'\">\n                                <label v-for=\"option in question.options\" :key=\"option.value\" class=\"mb-1\">\n                                    <input type=\"radio\" \n                                        :value=\"option.value\" \n                                        :name=\"question.name\"\n                                        v-model=\"response[question.name]\"\n                                    >\n                                    <div>{{option.label}}</div>\n                                </label>\n                            </div>\n\n                            <input \n                                type=\"text\" \n                                v-if=\"question.type == 'string'\"\n                                v-model=\"response[question.name]\"\n                                :name=\"question.name\"\n                            >\n                        </input-row>\n                    </transition>\n                </div>\n                <button-row :show-cancel=\"false\" @submitClicked=\"storeResponse()\">\n                    <slot v-if=\"saving\">\n                        Saving...\n                    </slot>\n                </button-row>\n            </div>\n        </card>\n        <note class=\"container\">GroupMemberId: {{groupMemberId}}</note>\n    </div>\n</template>\n<script>\nimport coiDef from '../../../surveys/coi.json'\nimport Survey from '@/survey'\nimport api from '@/http/api'\nimport is_validation_error from '@/http/is_validation_error';\n\nconst survey = new Survey(coiDef);\n\nexport default {\n    props: {\n        code: {\n            required: true,\n            type: String\n        }\n    },\n    data() {\n        return {\n            coiDef: coiDef,\n            survey: survey,\n            response: survey.getResponseTemplate(),\n            errors: {},\n            epName: null,\n            verifying: false,\n            saved: false,\n            saving: false,\n            redirectCountdown: 5\n        }\n    },\n    computed: {\n        codeIsValid() {\n            return this.epName !== null;\n        },\n        coiTitle() {\n            return survey.name+' for '+this.epName;\n        },\n        groupMemberId() {\n            const membership = this.$store.getters.currentUser.person.memberships.find(m => {\n                return m.group.expert_panel\n                    && m.group.expert_panel.coi_code === this.code\n            });\n\n            if (membership) {\n                return membership.id;\n            }\n\n            return null;\n        }\n    },\n    methods: {\n        showQuestion(question) {\n            if (!question.show) {\n                return true;\n            }\n            if (Array.isArray(question.show.value)) {\n                return question.show.value.indexOf(this.response[question.show.name]) > -1;\n            }\n            return (this.response[question.show.name] == question.show.value);\n        },\n        verifyCode() {\n            this.verifying = true;\n            api.get(`/api/coi/${this.code}/application`)\n                .then(response => {\n                    this.epName = response.data.name\n                })\n                .then(() => {\n                    this.verifying = false;\n                })\n        },\n        async storeResponse() {\n            this.saving = true;\n            try {\n                await this.$store.dispatch(\n                    'storeCoi', \n                    {\n                        code: this.code, \n                        groupMemberId: this.groupMemberId,\n                        coiData: this.response, \n                    }\n                );\n                this.saved = true;\n                this.$store.dispatch('forceGetCurrentUser');\n                this.$router.push({name: 'Dashboard'});\n            } catch (error) {\n                if (is_validation_error(error)) {\n                    this.errors = error.response.data.errors\n                } else {\n                    this.$store.commit('pushError', `You can not complete a COI for ${this.epName} because you are not a member.`)\n                }\n            }\n            this.saving = false;\n        },\n    },\n    async mounted() {\n        this.verifyCode();\n        await this.$store.dispatch('getCurrentUser')\n    }\n}\n</script>","class Question {\n    constructor(question) {\n        this.question_text = question.question;\n        this.name = question.name;\n        this.options = question.options;\n        this.validationRules = question.validation;\n        this.type = question.type;\n        this.show = question.show;\n        this.class = question.class;\n    }\n}\n\nclass YesNoQuestion extends Question {\n    constructor(question) {\n        super(question)\n        this.type = 'multiple-choice';\n        this.options = [{\n                label: 'Yes',\n                value: 1\n            },\n            {\n                label: 'No',\n                value: 0\n            }\n        ];\n    }\n\n\n}\n\nfunction makeQuestion(questionDef) {\n    if (questionDef.type == 'yes-no') {\n        return new YesNoQuestion(questionDef);\n    }\n\n    return new Question(questionDef);\n}\n\nclass Survey {\n    constructor(surveyDefinition) {\n        this._name = surveyDefinition.name;\n        this._questions = surveyDefinition.questions.map(q => makeQuestion(q));\n\n    }\n\n    get name() {\n        return this._name;\n    }\n\n    get questions() {\n        return this._questions\n    }\n\n    responseIsValid(response) {\n        response;\n        return true;\n    }\n\n    getResponseTemplate() {\n        const rsp = {};\n        this.questions.forEach(q => {\n            rsp[q.name] = null\n        });\n        return rsp;\n\n    }\n}\n\nexport default Survey","import { render } from \"./Coi.vue?vue&type=template&id=2e2197c0\"\nimport script from \"./Coi.vue?vue&type=script&lang=js\"\nexport * from \"./Coi.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}