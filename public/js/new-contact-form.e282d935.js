(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["new-contact-form"],{"033d":function(e,t,n){"use strict";t["a"]=function(e){return e.response&&422==e.response.status&&e.response.data.errors}},b2aa:function(e,t,n){"use strict";n.r(t);n("b0c0");var a=n("7a23"),r=Object(a["i"])("h4",{class:"text-lg"},"Add a contact",-1),c={class:"flex space-x-4"},o={class:"flex-1"},l={key:0,class:"pt-2 border-l pl-2 flex-1"},s=Object(a["i"])("h5",{class:"font-bold border-b mb-1 pb-1"},"Matching people",-1),i={key:1,class:"text-xs"};function u(e,t,n,u,p,d){var b=Object(a["A"])("input-row"),m=Object(a["A"])("button-row");return Object(a["s"])(),Object(a["f"])("div",null,[r,Object(a["i"])("div",c,[Object(a["i"])("div",o,[Object(a["i"])(b,{type:"text",modelValue:p.newContact.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return p.newContact.email=e}),errors:p.errors.email,placeholder:"elenor@medplace.com",label:"Email"},null,8,["modelValue","errors"]),Object(a["i"])(b,{type:"text",modelValue:p.newContact.first_name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return p.newContact.first_name=e}),errors:p.errors.first_name,placeholder:"Elenor",label:"First name"},null,8,["modelValue","errors"]),Object(a["i"])(b,{type:"text",modelValue:p.newContact.last_name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return p.newContact.last_name=e}),errors:p.errors.last_name,placeholder:"Shelstrop",label:"Last name"},null,8,["modelValue","errors"]),Object(a["i"])(b,{type:"text",modelValue:p.newContact.phone,"onUpdate:modelValue":t[4]||(t[4]=function(e){return p.newContact.phone=e}),errors:p.errors.phone,placeholder:"1-555-867-5309",label:"Phone"},null,8,["modelValue","errors"]),Object(a["i"])(m,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn",onClick:t[5]||(t[5]=function(){return d.cancel&&d.cancel.apply(d,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[6]||(t[6]=function(){return d.save&&d.save.apply(d,arguments)})},"Save")]})),_:1})]),Object(a["i"])(a["b"],{name:"slide-fade"},{default:Object(a["L"])((function(){return[d.suggestedPeople.length>0?(Object(a["s"])(),Object(a["f"])("div",l,[s,Object(a["i"])("ul",null,[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(d.suggestedPeople,(function(e){return Object(a["s"])(),Object(a["f"])("li",{key:e.uuid,class:["flex justify-between my-2",{"text-gray-400":d.isAlreadyContact(e)}],title:d.isAlreadyContact(e)?"This person is already a contact for this application":""},[Object(a["h"])(Object(a["D"])(e.name)+" ",1),d.isAlreadyContact(e)?(Object(a["s"])(),Object(a["f"])("span",i,"Already a contact")):(Object(a["s"])(),Object(a["f"])("button",{key:0,class:"btn btn-xs",onClick:function(t){return d.addExistingPersonAsContact(e)}}," Add as contact ",8,["onClick"]))],10,["title"])})),128))])])):Object(a["g"])("",!0)]})),_:1})])])}n("4de4"),n("caad"),n("d81d"),n("2532"),n("96cf");var p=n("1da1"),d=n("5530"),b=n("5502"),m=n("033d"),f=n("ec26"),h={props:{},data:function(){return{createNew:!1,newContact:{first_name:null,last_name:null,email:null,phone:null,role:null,uuid:null},errors:{}}},emits:["canceled","saved","done"],computed:Object(d["a"])(Object(d["a"])({},Object(b["b"])({application:"applications/currentItem",people:"people/all"})),{},{suggestedPeople:function(){var e=this;return this.newContact.email?this.people.filter((function(t){return t.email.includes(e.newContact.email)})):[]}}),methods:{clearForm:function(){this.newContact={first_name:null,last_name:null,email:null,phone:null,role:null,uuid:null}},clearErrors:function(){this.errors={}},cancel:function(){this.clearForm(),this.$emit("canceled"),this.$emit("done")},save:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.clearErrors(),t.prev=1,n=Object(d["a"])({},e.newContact),n.uuid=Object(f["a"])(),t.next=6,e.$store.dispatch("people/createPerson",n);case 6:return a=e.$store.getters["people/personWithUuid"],t.next=9,e.$store.dispatch("applications/addContact",{application:e.application,contact:a(n.uuid)});case 9:e.clearForm(),e.$emit("saved"),e.$emit("done"),t.next=20;break;case 14:if(t.prev=14,t.t0=t["catch"](1),!Object(m["a"])(t.t0)){t.next=19;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[1,14]])})))()},addExistingPersonAsContact:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("applications/addContact",{application:t.application,contact:e});case 3:t.clearForm(),t.$emit("saved"),t.$emit("done"),n.next=14;break;case 8:if(n.prev=8,n.t0=n["catch"](0),!Object(m["a"])(n.t0)){n.next=13;break}return t.errors=n.t0.response.data.errors,n.abrupt("return");case 13:throw n.t0;case 14:case"end":return n.stop()}}),n,null,[[0,8]])})))()},isAlreadyContact:function(e){return this.application.contacts.map((function(e){return e.id})).includes(e.id)}},mounted:function(){this.$store.dispatch("people/getAll",{})}};h.render=u;t["default"]=h}}]);
//# sourceMappingURL=new-contact-form.e282d935.js.map