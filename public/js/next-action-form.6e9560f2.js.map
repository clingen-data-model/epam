{"version":3,"sources":["webpack:///./src/components/next_actions/NextActionForm.vue","webpack:///./src/components/next_actions/NextActionForm.vue?b922"],"names":["class","value","title","label","errors","date_created","type","newAction","application","ep_type_id","step","Date","target_date","entry","assignmentErrors","id","assigned_to","assignees","i","key","name","assigned_to_name","placeholder","completed","date_completed","cancel","save","components","StepInput","RichTextEditor","props","required","default","emits","data","computed","this","steps","Object","values","configs","nextActions","watch","immediate","handler","action","findAction","syncAction","methods","clearForm","$emit","console","log","initNewAction","next_actions","find","uuid","created_at","info","$store","dispatch","updatedAction","nextActionData","response","status","unmounted","mounted","render"],"mappings":"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","file":"js/next-action-form.6e9560f2.js","sourcesContent":["<template>\n    <form-container>\n        <h2 class=\"block-title\">{{title}}</h2>\n        <input-row label=\"Creation Date\" :errors=\"errors.date_created\" type=\"date\" v-model=\"newAction.date_created\"></input-row>\n\n        <step-input v-model=\"newAction.step\" :errors=\"errors.step\" v-if=\"application.ep_type_id == 2\"></step-input>\n\n        <input-row label=\"Target\" Date=\"\" :errors=\"errors.target_date\" type=\"date\" v-model=\"newAction.target_date\"></input-row>\n\n        <input-row label=\"Entry\" :errors=\"errors.entry\">\n            <rich-text-editor v-model=\"newAction.entry\"></rich-text-editor>\n        </input-row>\n\n        <input-row label=\"Assigned To\" :errors=\"assignmentErrors\">\n            <select id=\"\" v-model=\"newAction.assigned_to\">\n                <option :value=\"null\">Select...</option>\n                <option v-for=\"i in assignees\" :key=\"i.id\"\n                    :value=\"i.id\"\n                >\n                    {{i.name}}\n                </option>\n            </select>\n            &nbsp;&nbsp;\n            <input type=\"text\" label=\"Name\" v-model=\"newAction.assigned_to_name\" placeholder=\"Name (optional)\">\n        </input-row>\n\n        <div class=\"ml-4\">\n        </div>\n\n        <label class=\"ml-36\">\n            <input type=\"checkbox\" v-model=\"completed\"> This is already completed\n        </label>\n\n        <input-row label=\"Date Completed\" :errors=\"errors.date_completed\" class=\"ml-36\" v-if=\"completed\">\n            <input type=\"date\" v-model=\"newAction.date_completed\">\n        </input-row>\n\n        <button-row>\n            <button class=\"btn\" @click=\"cancel\">Cancel</button>\n            <button class=\"btn blue\" @click=\"save\">Save</button>\n        </button-row>\n    </form-container>\n</template>\n<script>\nimport StepInput from '../forms/StepInput'\nimport {mapGetters} from 'vuex'\nimport RichTextEditor from '../forms/RichTextEditor'\nimport {formatDate} from '@/date_utils'\nimport configs from '@/configs'\n\nexport default {\n    name: 'NextActionForm',\n    components: {\n        StepInput,\n        RichTextEditor\n    },\n    props: {\n        id: {\n            required: false,\n            default: null\n        }\n    },\n    emits: [\n        'saved',\n        'closed',\n        'formCleared',\n        'canceled'\n    ],\n    data() {\n        return {\n            errors: {},\n            newAction: {\n                date_created: new Date(),\n                step: null,\n                date_completed: null,\n                entry: '',\n                assigned_to: null,\n                assigned_to_name: null\n            },\n            completed: false\n        }\n    },\n    computed: {\n        ...mapGetters({application: 'applications/currentItem'}),\n        title () {\n            return this.newAction.id ? 'Update Action' : 'Add Next Action';\n        },\n        steps () {\n            return [1,2,3,4];\n        },\n        assignmentErrors () {\n            let errors = [];\n            if (this.errors.assigned_to) {\n                errors = [...errors, ...this.errors.assigned_to]\n            }\n            if (this.errors.assigned_to_name) {\n                errors = [...errors, ...this.errors.assigned_to_name]\n            }\n            return errors;\n        },\n        assignees () {\n            return Object.values(configs.nextActions.assignees);\n        }\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler: function() {\n                const action = this.findAction();\n                if (action) {\n                    this.syncAction(action)\n                }\n            }\n        },\n        application: {\n            immediate: true,\n            handler: function () {\n                const action = this.findAction();\n                if (action) {\n                    this.syncAction(action);\n                }\n            }\n        }\n    },\n    methods: {\n        cancel () {\n            this.clearForm();\n            this.$emit('canceled');\n        },\n        clearForm() {\n            console.log('clearForm()');\n            this.initNewAction();\n            this.$emit('formCleared')\n        },\n        initNewAction () {\n            this.newAction = {\n                date_created: new Date(),\n                step: null,\n                target_date: null,\n                date_completed: null,\n                entry: '',\n                assigned_to: null,\n                assigned_to_name: null,\n            };      \n        },\n        findAction () {\n            if (this.id === null) {\n                return null;\n            }\n            if (this.application.next_actions) {\n                return this.application.next_actions.find(i => i.id == this.id);\n            }\n        },\n        syncAction (action) {\n            if (!action) {\n                return;\n            }\n            this.newAction = {\n                id: action.id,\n                uuid: action.uuid,\n                date_created: formatDate(action.created_at),\n                step: action.step,\n                target_date: formatDate(action.target_date),\n                date_completed: formatDate(action.date_completed),\n                entry: action.entry ?? '',\n                assigned_to: action.assigned_to,\n                assigned_to_name: action.assigned_to_name\n            }\n        },\n        async save() {\n            console.log('save!');\n            console.info('this.newAction', this.newAction);\n            try {\n                if (this.newAction.id) {\n                    await this.$store.dispatch(\n                        'applications/updateNextAction', \n                        {\n                            application: this.application, \n                            updatedAction: this.newAction,\n                        }\n                    );\n                    this.$emit('saved')\n                    this.clearForm();\n                } else {\n                    await this.$store.dispatch(\n                        'applications/addNextAction', \n                        {\n                            application: this.application, \n                            nextActionData: this.newAction\n                        }\n                    );\n                    this.$emit('saved')\n                    this.clearForm();\n                }\n            } catch (error) {\n                if (error.response && error.response.status == 422 && error.response.data.errors) {\n                    this.errors = error.response.data.errors\n                    return;\n                }\n            }\n        },\n    },\n    unmounted() {\n        this.initNewAction()\n    },\n    mounted() {\n    }\n}\n</script>","import { render } from \"./NextActionForm.vue?vue&type=template&id=08cf9eb2\"\nimport script from \"./NextActionForm.vue?vue&type=script&lang=js\"\nexport * from \"./NextActionForm.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}