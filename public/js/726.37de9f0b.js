"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[726],{6726:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var n=a(641),i=a(3751),r=a(33);const s=(0,n.eW)("Admin"),o=(0,n.Lk)("h1",null,"Invites",-1),l=["onClick"],d=(0,n.Lk)("p",null,"This cannot be undone.",-1),m=(0,n.Lk)("p",null,"Do you want to reset the invite?",-1);function u(e,t,a,u,h,c){const p=(0,n.g2)("note"),b=(0,n.g2)("data-table"),v=(0,n.g2)("button-row"),f=(0,n.g2)("modal-dialog"),g=(0,n.gN)("remaining-height");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(p,null,{default:(0,n.k6)((()=>[s])),_:1}),o,(0,n.bo)(((0,n.uX)(),(0,n.Wv)(b,{data:c.itemProvider,fields:h.fields,sort:h.tableSort,"onUpdate:sort":t[1]||(t[1]=e=>h.tableSort=e),class:"text-sm",paginated:"",ref:"dataTable"},{header:(0,n.k6)((()=>[(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>h.searchTerm=e),placeholder:"filter by name or email",class:"mb-2"},null,512),[[i.Jo,h.searchTerm]])])),"cell-reset":(0,n.k6)((({item:e})=>[e.redeemed_at?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"btn btn-xs",onClick:t=>c.confirmReset(e)}," Reset ",8,l)):(0,n.Q3)("",!0)])),_:1},8,["data","fields","sort"])),[[g]]),((0,n.uX)(),(0,n.Wv)(n.Im,{to:"body"},[(0,n.bF)(f,{title:"Reset Invite",modelValue:h.showConfirmation,"onUpdate:modelValue":t[3]||(t[3]=e=>h.showConfirmation=e)},{default:(0,n.k6)((()=>[(0,n.Lk)("p",null,"You are about to reset the invite for "+(0,r.v_)(h.resettingInvite.first_name)+" "+(0,r.v_)(h.resettingInvite.last_name)+".",1),d,m,(0,n.bF)(v,{"submit-text":"Reset Invite",onSubmitted:t[2]||(t[2]=e=>c.resetInvite(h.resettingInvite))})])),_:1},8,["modelValue"])]))])}var h=a(696),c=a(2425),p={name:"InviteAdmin",props:{},data(){return{resettingInvite:{},tableSort:{field:"id",desc:!1},invites:[],showConfirmation:!1,searchTerm:null,fields:[{name:"id",sortable:!0,type:Number},{name:"person.name",label:"Name",sortable:!0,type:String},{name:"person.email",label:"Email",sortable:!0,type:String},{name:"redeemed_at",sortable:!0,type:Date},{name:"inviter",sortable:!0,type:String,resolveValue:e=>e.inviter?e.inviter.name:null},{name:"code",sortable:!1,type:String},{name:"reset",sortable:!1,type:String}]}},watch:{searchTerm(){this.triggerSearch()}},methods:{async itemProvider(e,t,a,n){const i={page:e,page_size:t,"sort[field]":a.field.name,"sort[dir]":a.desc?"DESC":"ASC","where[keyword]":this.searchTerm},r=await h.FH.get("/api/people/invites",{params:i}).then((e=>e.data));return n(r.meta.total),r.data},async resetInvite(e){try{const t=await h.FH.put(`/api/people/invites/${e.code}/reset`),a=this.invites.findIndex((t=>t.id==e.id));-1==a&&alert("what??"),this.invites[a]=t.data}catch(t){if((0,h.Ah)(t))return void alert("Problem resetting invite!")}this.showConfirmation=!1},confirmReset(e){this.resettingInvite=e,this.showConfirmation=!0}},mounted(){this.triggerSearch=(0,c.A)((()=>this.$refs.dataTable.getItems()),500)}},b=a(6262);const v=(0,b.A)(p,[["render",u]]);var f=v}}]);
//# sourceMappingURL=726.37de9f0b.js.map