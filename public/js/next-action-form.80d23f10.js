(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["next-action-form"],{"76d6":function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),r={class:"block-title"},a=Object(o["createElementVNode"])("option",{value:null},"Select...",-1),c=["value"],i=Object(o["createTextVNode"])("    "),l=Object(o["createElementVNode"])("div",{class:"ml-4"},null,-1);function s(e,t,n,s,d,u){var p=Object(o["resolveComponent"])("input-row"),m=Object(o["resolveComponent"])("step-input"),b=Object(o["resolveComponent"])("rich-text-editor"),f=Object(o["resolveComponent"])("checkbox"),O=Object(o["resolveComponent"])("button-row"),j=Object(o["resolveComponent"])("form-container");return Object(o["openBlock"])(),Object(o["createBlock"])(j,null,{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("h2",r,Object(o["toDisplayString"])(u.title),1),Object(o["createVNode"])(p,{label:"Creation Date",errors:d.errors.date_created,type:"date",modelValue:d.newAction.date_created,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d.newAction.date_created=e})},null,8,["errors","modelValue"]),2==u.application.expert_panel_type_id?(Object(o["openBlock"])(),Object(o["createBlock"])(m,{key:0,modelValue:d.newAction.step,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d.newAction.step=e}),errors:d.errors.step},null,8,["modelValue","errors"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(p,{label:"Target",Date:"",errors:d.errors.target_date,type:"date",modelValue:d.newAction.target_date,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.newAction.target_date=e})},null,8,["errors","modelValue"]),Object(o["createVNode"])(p,{label:"Entry",errors:d.errors.entry},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(b,{modelValue:d.newAction.entry,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d.newAction.entry=e})},null,8,["modelValue"])]})),_:1},8,["errors"]),Object(o["createVNode"])(p,{label:"Assigned To",errors:u.assignmentErrors},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{id:"","onUpdate:modelValue":t[4]||(t[4]=function(e){return d.newAction.assigned_to=e})},[a,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(u.assignees,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("option",{key:e.id,value:e.id},Object(o["toDisplayString"])(e.name),9,c)})),128))],512),[[o["vModelSelect"],d.newAction.assigned_to]]),i,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",label:"Name","onUpdate:modelValue":t[5]||(t[5]=function(e){return d.newAction.assigned_to_name=e}),placeholder:"Name (optional)"},null,512),[[o["vModelText"],d.newAction.assigned_to_name]])]})),_:1},8,["errors"]),l,Object(o["createVNode"])(f,{modelValue:d.completed,"onUpdate:modelValue":t[6]||(t[6]=function(e){return d.completed=e}),label:"This is already completed",class:"ml-36"},null,8,["modelValue"]),d.completed?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:1,label:"Date Completed",errors:d.errors.date_completed,class:"ml-36"},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"date","onUpdate:modelValue":t[7]||(t[7]=function(e){return d.newAction.date_completed=e})},null,512),[[o["vModelText"],d.newAction.date_completed]])]})),_:1},8,["errors"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(O,null,{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("button",{class:"btn",onClick:t[8]||(t[8]=function(){return u.cancel&&u.cancel.apply(u,arguments)})},"Cancel"),Object(o["createElementVNode"])("button",{class:"btn blue",onClick:t[9]||(t[9]=function(){return u.save&&u.save.apply(u,arguments)})},"Save")]})),_:1})]})),_:1})}var d=n("1da1"),u=n("2909"),p=n("5530"),m=(n("96cf"),n("99af"),n("07ac"),n("7db0"),n("d3b7"),n("a06a")),b=n("5502"),f=n("85fe"),O=n("e328"),j=n("4a91"),_={name:"NextActionForm",components:{StepInput:m["default"],RichTextEditor:f["default"]},props:{id:{required:!1,default:null}},emits:["saved","closed","formCleared","canceled"],data:function(){return{errors:{},newAction:{date_created:new Date,step:null,date_completed:null,entry:"",assigned_to:null,assigned_to_name:null},completed:!1}},computed:Object(p["a"])(Object(p["a"])({},Object(b["b"])({group:"groups/currentItemOrNew"})),{},{application:function(){return this.group.expert_panel},title:function(){return this.newAction.id?"Update Action":"Add Next Action"},steps:function(){return[1,2,3,4]},assignmentErrors:function(){var e=[];return this.errors.assigned_to&&(e=[].concat(Object(u["a"])(e),Object(u["a"])(this.errors.assigned_to))),this.errors.assigned_to_name&&(e=[].concat(Object(u["a"])(e),Object(u["a"])(this.errors.assigned_to_name))),e},assignees:function(){return Object.values(j.nextActions.assignees)}}),watch:{id:{immediate:!0,handler:function(){var e=this.findAction();e&&this.syncAction(e)}},application:{immediate:!0,handler:function(){var e=this.findAction();e&&this.syncAction(e)}}},methods:{cancel:function(){this.clearForm(),this.$emit("canceled")},clearForm:function(){this.initNewAction(),this.$emit("formCleared")},initNewAction:function(){this.newAction={date_created:new Date,step:null,target_date:null,date_completed:null,entry:"",assigned_to:null,assigned_to_name:null}},findAction:function(){var e=this;return null===this.id?null:this.application.next_actions?this.application.next_actions.find((function(t){return t.id==e.id})):void 0},syncAction:function(e){var t;e&&(this.newAction={id:e.id,uuid:e.uuid,date_created:Object(O["b"])(e.created_at),step:e.step,target_date:Object(O["b"])(e.target_date),date_completed:Object(O["b"])(e.date_completed),entry:null!==(t=e.entry)&&void 0!==t?t:"",assigned_to:e.assigned_to,assigned_to_name:e.assigned_to_name})},save:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!e.newAction.id){t.next=8;break}return t.next=4,e.$store.dispatch("applications/updateNextAction",{application:e.application,updatedAction:e.newAction});case 4:e.$emit("saved"),e.clearForm(),t.next=12;break;case 8:return t.next=10,e.$store.dispatch("applications/addNextAction",{application:e.application,nextActionData:e.newAction});case 10:e.$emit("saved"),e.clearForm();case 12:t.next=19;break;case 14:if(t.prev=14,t.t0=t["catch"](0),!t.t0.response||422!=t.t0.response.status||!t.t0.response.data.errors){t.next=19;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 19:case"end":return t.stop()}}),t,null,[[0,14]])})))()}},unmounted:function(){this.initNewAction()},mounted:function(){}},w=n("6b0d"),h=n.n(w);const A=h()(_,[["render",s]]);t["default"]=A}}]);
//# sourceMappingURL=next-action-form.80d23f10.js.map