(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["application-detail~group-application~group-detail"],{"268c":function(e,t,r){"use strict";r("b0c0");var n=r("7a23"),o={key:0},a={key:0},c=Object(n["createTextVNode"])(" Affiliation ID "),u=Object(n["createTextVNode"])("admin-only"),i={key:0},l={key:1,class:"text-gray-400"},s={key:1},p={key:2},d=Object(n["createTextVNode"])(" Status: "),m=Object(n["createTextVNode"])("admin-only"),b=Object(n["createTextVNode"])(" Parent group: "),f=Object(n["createTextVNode"])("admin-only");function h(e,t,r,h,g,O){var j=Object(n["resolveComponent"])("input-row"),y=Object(n["resolveComponent"])("dictionary-row"),_=Object(n["resolveComponent"])("note");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[O.canSetType?(Object(n["openBlock"])(),Object(n["createBlock"])(j,{key:0,modelValue:O.group.group_type_id,"onUpdate:modelValue":t[0]||(t[0]=function(e){return O.group.group_type_id=e}),errors:h.errors.group_type_id,type:"select",options:O.typeOptions,label:"Type"},null,8,["modelValue","errors","options"])):(Object(n["openBlock"])(),Object(n["createBlock"])(y,{key:1,label:"Type"},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(O.typeDisplayName),1)]})),_:1})),Object(n["createVNode"])(n["Transition"],{name:"slide-fade-down",mode:"out-in"},{default:Object(n["withCtx"])((function(){return[O.group.group_type_id>2&&O.group.expert_panel?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",o,[Object(n["createVNode"])(j,{label:"Long Base Name",modelValue:O.group.expert_panel.long_base_name,"onUpdate:modelValue":[t[1]||(t[1]=function(e){return O.group.expert_panel.long_base_name=e}),O.emitUpdate],placeholder:"Long base name",errors:h.errors.long_base_name,"input-class":"w-full"},null,8,["modelValue","onUpdate:modelValue","errors"]),Object(n["createVNode"])(j,{label:"Short Base Name",modelValue:O.group.expert_panel.short_base_name,"onUpdate:modelValue":[t[2]||(t[2]=function(e){return O.group.expert_panel.short_base_name=e}),O.emitUpdate],placeholder:"Short base name",errors:h.errors.short_base_name,"input-class":"w-full"},null,8,["modelValue","onUpdate:modelValue","errors"]),e.hasAnyPermission(["groups-manage"])?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",a,[Object(n["createVNode"])(j,{label:"Affiliation ID",modelValue:O.group.expert_panel.affiliation_id,"onUpdate:modelValue":[t[3]||(t[3]=function(e){return O.group.expert_panel.affiliation_id=e}),O.emitUpdate],placeholder:O.affiliationIdPlaceholder,errors:h.errors.affiliation_id,"input-class":"w-full"},{label:Object(n["withCtx"])((function(){return[c,Object(n["createVNode"])(_,null,{default:Object(n["withCtx"])((function(){return[u]})),_:1})]})),_:1},8,["modelValue","placeholder","errors","onUpdate:modelValue"])])):(Object(n["openBlock"])(),Object(n["createBlock"])(y,{key:1,label:"Affiliation ID"},{default:Object(n["withCtx"])((function(){return[O.group.expert_panel.affiliation_id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",i,Object(n["toDisplayString"])(O.group.expert_panel.affiliation_id),1)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",l,Object(n["toDisplayString"])("Not yet assigend")))]})),_:1}))])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",s,[Object(n["createVNode"])(j,{modelValue:O.group.name,"onUpdate:modelValue":[t[4]||(t[4]=function(e){return O.group.name=e}),O.emitUpdate],placeholder:"Name",label:"Name","input-class":"w-full",errors:h.errors.name},null,8,["modelValue","errors","onUpdate:modelValue"])]))]})),_:1}),e.hasPermission("groups-manage")?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",p,[Object(n["createVNode"])(j,{modelValue:O.group.group_status_id,"onUpdate:modelValue":[t[5]||(t[5]=function(e){return O.group.group_status_id=e}),O.emitUpdate],type:"select",options:O.statusOptions,errors:h.errors.group_status_id},{label:Object(n["withCtx"])((function(){return[d,Object(n["createVNode"])(_,null,{default:Object(n["withCtx"])((function(){return[m]})),_:1})]})),_:1},8,["modelValue","options","errors","onUpdate:modelValue"]),Object(n["createVNode"])(j,{modelValue:O.group.parent_id,"onUpdate:modelValue":[t[6]||(t[6]=function(e){return O.group.parent_id=e}),O.emitUpdate],type:"select",options:O.parentOptions,errors:h.errors.parent_id},{label:Object(n["withCtx"])((function(){return[b,Object(n["createVNode"])(_,null,{default:Object(n["withCtx"])((function(){return[f]})),_:1})]})),_:1},8,["modelValue","options","errors","onUpdate:modelValue"])])):Object(n["createCommentVNode"])("",!0)])}var g=r("1da1"),O=(r("96cf"),r("d81d"),r("07ac"),r("d3b7"),r("159b"),r("4de4"),r("3ca3"),r("ddb0"),r("2ef0")),j=r("db04"),y=r("ae23"),_=r("4a91"),v=r("a75a"),w={name:"GroupForm",emits:["canceled","saved","update"],data:function(){return{groupTypes:[{id:1,fullname:"Working Group"},{id:2,fullname:"Clinical Domain Working Group"},{id:3,fullname:"GCEP"},{id:4,fullname:"VCEP"}],groupStatuses:_.groups.statuses,newGroup:new y["a"],parents:[]}},computed:{group:{get:function(){var e=this.$store.getters["groups/currentItem"];return e||this.newGroup},set:function(e){try{this.$store.commit("groups/addItem",e)}catch(t){this.newGroup=e}}},statusOptions:function(){var e=this;return Object.values(this.groupStatuses).map((function(t){return{value:t.id,label:e.titleCase(t.name)}}))},typeOptions:function(){return this.groupTypes.map((function(e){return{value:e.id,label:e.fullname}}))},canSetType:function(){return this.hasPermission("groups-manage")&&!this.group.id},typeDisplayName:function(){return this.group.type?this.group.type.name?this.group.type.id<3?this.group.type.name.toUpperCase():this.group.expert_panel.type.name.toUpperCase():null:"🐇🥚"},affiliationIdPlaceholder:function(){return 5e4},cdwgs:function(){return this.$store.getters["cdwgs/all"]},namesDirty:function(){return this.group.expert_panel.isDirty("long_base_name")||this.group.expert_panel.isDirty("short_base_name")},affiliationIdDirty:function(){return console.log({new:this.group.expert_panel.attributes.affiliation_id,original:this.group.expert_panel.original.affiliation_id}),this.group.expert_panel.isDirty("affiliation_id")},parentOptions:function(){var e=[{value:0,label:"None"}];return this.parents.filter((function(e){return e.type.can_be_parent})).forEach((function(t){e.push({value:t.id,label:t.displayName})})),Object(O["sortBy"])(e,"label")}},methods:{save:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.resetErrors(),t.prev=1,!e.group.id){t.next=7;break}return t.next=5,e.updateGroup();case 5:return e.$emit("saved"),t.abrupt("return");case 7:return t.next=9,e.createGroup().then((function(e){return e.data.data}));case 9:r=t.sent,e.$emit("saved"),e.$store.commit("pushSuccess","Group created."),e.$router.push({name:"AddMember",params:{uuid:r.uuid}}),t.next=19;break;case 15:throw t.prev=15,t.t0=t["catch"](1),Object(j["b"])(t.t0)&&(e.errors=t.t0.response.data.errors),t.t0;case 19:case"end":return t.stop()}}),t,null,[[1,15]])})))()},createGroup:function(){var e=this.group.attributes,t=e.name,r=e.parent_id,n=e.group_type_id,o=e.group_status_id,a=this.group.expert_panel.short_base_name;return null===t&&this.group.expert_panel&&(t=this.group.expert_panel.long_base_name),this.$store.dispatch("groups/create",{name:t,parent_id:r,group_type_id:n,group_status_id:o,short_base_name:a})},updateGroup:function(){var e=[];return e.push(this.saveGroupData()),this.group.expert_panel&&e.push(this.saveEpData()),Promise.all(e)},saveGroupData:function(){var e=[];return this.group.isDirty("parent_id")&&e.push(this.saveParent()),this.group.isDirty("name")&&e.push(this.saveName()),this.group.isDirty("group_status_id")&&e.push(this.saveStatus()),Promise.all(e)},saveEpData:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r,n,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],e.namesDirty&&(n=e.group.expert_panel,o=n.long_base_name,a=n.short_base_name,r.push(e.submitFormData({method:"put",url:"/api/groups/".concat(e.group.uuid,"/expert-panel/name"),data:{long_base_name:o,short_base_name:a}}))),e.affiliationIdDirty&&r.push(e.submitFormData({method:"put",url:"/api/groups/".concat(e.group.uuid,"/expert-panel/affiliation-id"),data:{affiliation_id:e.group.expert_panel.affiliation_id}})),t.next=5,Promise.all(r);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))()},isDirty:function(e){return this.group[e]!=this.group[e]},saveParent:function(){return this.submitFormData({method:"put",url:"/api/groups/".concat(this.group.uuid,"/parent"),data:{parent_id:this.group.parent_id}})},saveName:function(){return this.submitFormData({method:"put",url:"/api/groups/".concat(this.group.uuid,"/name"),data:{name:this.group.name}})},saveStatus:function(){return this.submitFormData({method:"put",url:"/api/groups/".concat(this.group.uuid,"/status"),data:{status_id:this.group.group_status_id}})},resetData:function(){this.group.uuid&&this.$store.dispatch("groups/find",this.group.uuid)},cancel:function(){this.group.uuid&&this.resetData(),this.$emit("canceled")},getParentOptions:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={"where[group_type_id]":[1,2],without:["coordinators","expertPanel"]},t.next=3,j["a"].get("/api/groups",{params:r}).then((function(t){return t.data.filter((function(t){return t.id!=e.group.id})).map((function(e){return new y["a"](e)}))}));case 3:e.parents=t.sent;case 4:case"end":return t.stop()}}),t)})))()},emitUpdate:function(){this.$emit("update")}},beforeMount:function(){this.getParentOptions(),this.$store.dispatch("cdwgs/getAll")},setup:function(e,t){var r=Object(v["a"])(e,t),n=r.errors,o=r.submitFormData,a=r.resetErrors;return{errors:n,submitFormData:o,resetErrors:a}}},k=r("6b0d"),D=r.n(k);const V=D()(w,[["render",h]]);t["a"]=V},a75a:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r("5530"),o=r("1da1"),a=(r("96cf"),r("7a23")),c=r("033d"),u=r("f96b"),i=Object(a["ref"])({}),l=Object(a["ref"])(!1),s=function(){l.value=!1,i.value={}},p=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.method,o=t.url,a=t.data,e.prev=1,e.next=4,Object(u["a"])({method:r,url:o,data:a}).then((function(e){return e.data.data}));case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e["catch"](1),Object(c["a"])(e.t0)&&(i.value=Object(n["a"])(Object(n["a"])({},i),e.t0.response.data.errors));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){i.value={}};t["a"]=function(){return{errors:i,editing:l,hideForm:s,submitFormData:p,resetErrors:d}}},fefd:function(e,t,r){"use strict";var n=r("7a23");function o(e,t,r,o,a,c){var u=Object(n["resolveComponent"])("cspec-summary"),i=Object(n["resolveComponent"])("application-upload-form");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[c.cspecSummaryEnabled?(Object(n["openBlock"])(),Object(n["createBlock"])(u,{key:0})):Object(n["createCommentVNode"])("",!0),c.specificationUpload?(Object(n["openBlock"])(),Object(n["createBlock"])(i,{key:1,"document-type-id":r.docTypeId,"show-notes":!1},null,8,["document-type-id"])):Object(n["createCommentVNode"])("",!0)])}r("a9e3");var a=r("abba"),c={key:0,class:"table"},u=Object(n["createElementVNode"])("th",null,"File",-1),i={key:0},l=Object(n["createElementVNode"])("th",null,"uploaded",-1),s=Object(n["createElementVNode"])("th",null,null,-1),p=["href"],d={class:"note"},m={key:0},b=Object(n["createElementVNode"])("button",{class:"btn btn-xs"},"…",-1),f=Object(n["createTextVNode"])("Download"),h=Object(n["createTextVNode"])("Delete"),g={type:"file",ref:"fileInput"},O={key:0},j={key:0,class:"mb-3"},y=Object(n["createElementVNode"])("p",null,"Are you sure you want to continue?",-1);function _(e,t,r,o,a,_){var v=Object(n["resolveComponent"])("dropdown-item"),w=Object(n["resolveComponent"])("dropdown-menu"),k=Object(n["resolveComponent"])("input-row"),D=Object(n["resolveComponent"])("button-row"),V=Object(n["resolveComponent"])("modal-dialog");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[_.documents.length>0?(Object(n["openBlock"])(),Object(n["createElementBlock"])("table",c,[Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[u,_.docTypeIsArray?(Object(n["openBlock"])(),Object(n["createElementBlock"])("th",i,"Type")):Object(n["createCommentVNode"])("",!0),l,s])]),Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(_.documents,(function(t){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:t.id,class:"p-1 border"},[Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("a",{href:t.download_url},Object(n["toDisplayString"])(t.filename),9,p),Object(n["createElementVNode"])("span",d," (v. "+Object(n["toDisplayString"])(t.version)+")",1)]),_.docTypeIsArray?(Object(n["openBlock"])(),Object(n["createElementBlock"])("td",m,Object(n["toDisplayString"])(t.type.long_name),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(e.formatDate(t.created_at)),1),Object(n["createElementVNode"])("td",null,[Object(n["createVNode"])(w,{hideCheveron:""},{label:Object(n["withCtx"])((function(){return[b]})),default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(v,{onClick:function(e){return _.initDownload(t)}},{default:Object(n["withCtx"])((function(){return[f]})),_:2},1032,["onClick"]),e.hasAnyPermission(["ep-applications-manage",["application-edit",_.group]])?(Object(n["openBlock"])(),Object(n["createBlock"])(v,{key:0,onClick:function(e){return _.initDelete(t)}},{default:Object(n["withCtx"])((function(){return[h]})),_:2},1032,["onClick"])):Object(n["createCommentVNode"])("",!0)]})),_:2},1024)])])})),128))])])):Object(n["createCommentVNode"])("",!0),_.docTypeIsArray?(Object(n["openBlock"])(),Object(n["createBlock"])(k,{key:1,label:"Document type",type:"select",options:_.filteredTypes,modelValue:a.newDocument.document_type_id,"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.newDocument.document_type_id=e})},null,8,["options","modelValue"])):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(k,{label:"Document",errors:a.errors.file},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("input",g,null,512)]})),_:1},8,["errors"]),Object(n["createElementVNode"])("button",{class:"btn blue",onClick:t[1]||(t[1]=function(){return _.save&&_.save.apply(_,arguments)})},"Upload"),(Object(n["openBlock"])(),Object(n["createBlock"])(n["Teleport"],{to:"body"},[Object(n["createVNode"])(V,{modelValue:a.showDeleteConfirmation,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.showDeleteConfirmation=e}),title:"You are about to delete ".concat(a.activeDocument.filename)},{default:Object(n["withCtx"])((function(){return[a.activeDocument?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",O,[a.activeDocument.is_final?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",j," This version has been tagged as the final version of the document. ")):Object(n["createCommentVNode"])("",!0),y,Object(n["createVNode"])(D,{"submit-text":"Delete Document",onCanceled:_.cancelDelete,onSubmitted:_.commitDelete},null,8,["onCanceled","onSubmitted"])])):Object(n["createCommentVNode"])("",!0)]})),_:1},8,["modelValue","title"])]))])}var v=r("1da1"),w=(r("96cf"),r("4de4"),r("d3b7"),r("caad"),r("2532"),r("d81d"),r("07ac"),r("159b"),r("b64b"),r("e328")),k=r("db04"),D=r("4a91"),V={props:{documentTypeId:{type:[Number,Array],required:!0},step:{type:Number,required:!1,default:null},showNotes:{type:Boolean,default:!0}},emits:["saved"],data:function(){return{newDocument:{file:null,date_received:(new Date).toISOString(),step:this.step,document_type_id:this.docTypeIsArray?null:this.documentTypeId},errors:{},activeDocument:{},showDeleteConfirmation:!1}},computed:{group:function(){return this.$store.getters["groups/currentItemOrNew"]},documents:function(){var e=this;return this.group.documents.filter((function(t){return e.docTypeIsArray?e.documentTypeId.includes(t.document_type_id):t.document_type_id==e.documentTypeId}))},docTypeIsArray:function(){return Array.isArray(this.documentTypeId)},filteredTypes:function(){var e=this;return this.docTypeIsArray?(console.log(this.docTypeIsArray,this.documentTypeId),Object.values(D["documentsTypes"]).filter((function(t){return e.documentTypeId.includes(t.id)})).map((function(e){return{label:e.long_name,value:e.id}}))):[]}},methods:{save:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=new FormData,Object.keys(e.newDocument).forEach((function(t){var n=e.newDocument[t];null!=n&&r.append(t,n)})),r.append("file",e.$refs.fileInput.files[0]),t.next=6,e.$store.dispatch("groups/addApplicationDocument",{group:e.group,data:r});case 6:e.clearForm(),e.$emit("saved"),t.next=15;break;case 10:if(t.prev=10,t.t0=t["catch"](0),!Object(k["b"])(t.t0)){t.next=15;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 15:case"end":return t.stop()}}),t,null,[[0,10]])})))()},cancel:function(){this.clearForm(),this.$emit("canceled")},clearForm:function(){this.initNewDocument(),this.clearErrors()},initNewDocument:function(){this.$refs.fileInput.value=null,this.newDocument={file:null,date_received:Object(w["b"])(new Date),date_reviewed:null,step:this.step,document_type_id:this.documentTypeId,notes:null}},clearErrors:function(){this.errors={}},initDownload:function(e){window.location=e.download_url},initDelete:function(e){this.activeDocument=e,this.showDeleteConfirmation=!0},cancelDelete:function(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},commitDelete:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("groups/deleteDocument",{group:e.group,document:e.activeDocument});case 2:e.showDeleteConfirmation=!1,e.resetActiveDocument();case 4:case"end":return t.stop()}}),t)})))()},resetActiveDocument:function(){this.activeDocument={type:{}}}},mounted:function(){this.$store.dispatch("groups/getDocuments",this.group)}},x=r("6b0d"),N=r.n(x);const C=N()(V,[["render",_]]);var B=C,E={name:"SpecificationsSection",props:{docTypeId:{required:!0,type:[Number,Array]}},components:{CspecSummary:a["a"],ApplicationUploadForm:B},data:function(){return{}},computed:{cspecSummaryEnabled:function(){return this.$store.state.systemInfo.app.features.cspec_summary},specificationUpload:function(){return this.$store.state.systemInfo.app.features.specification_upload}},methods:{}};const T=N()(E,[["render",o]]);t["a"]=T}}]);
//# sourceMappingURL=application-detail~group-application~group-detail.9e285c3a.js.map