(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["next-action-form"],{"76d6":function(e,t,n){"use strict";n.r(t);n("b0c0");var o=n("7a23"),a={class:"block-title"},c=Object(o["createVNode"])("option",{value:null},"Select...",-1),r=Object(o["createTextVNode"])("    "),i=Object(o["createVNode"])("div",{class:"ml-4"},null,-1),l={class:"ml-36"},s=Object(o["createTextVNode"])(" This is already completed ");function d(e,t,n,d,u,p){var b=Object(o["resolveComponent"])("input-row"),m=Object(o["resolveComponent"])("step-input"),j=Object(o["resolveComponent"])("rich-text-editor"),O=Object(o["resolveComponent"])("button-row"),f=Object(o["resolveComponent"])("form-container");return Object(o["openBlock"])(),Object(o["createBlock"])(f,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("h2",a,Object(o["toDisplayString"])(p.title),1),Object(o["createVNode"])(b,{label:"Creation Date",errors:u.errors.date_created,type:"date",modelValue:u.newAction.date_created,"onUpdate:modelValue":t[1]||(t[1]=function(e){return u.newAction.date_created=e})},null,8,["errors","modelValue"]),2==e.application.ep_type_id?(Object(o["openBlock"])(),Object(o["createBlock"])(m,{key:0,modelValue:u.newAction.step,"onUpdate:modelValue":t[2]||(t[2]=function(e){return u.newAction.step=e}),errors:u.errors.step},null,8,["modelValue","errors"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(b,{label:"Target",Date:"",errors:u.errors.target_date,type:"date",modelValue:u.newAction.target_date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return u.newAction.target_date=e})},null,8,["errors","modelValue"]),Object(o["createVNode"])(b,{label:"Entry",errors:u.errors.entry},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(j,{modelValue:u.newAction.entry,"onUpdate:modelValue":t[4]||(t[4]=function(e){return u.newAction.entry=e})},null,8,["modelValue"])]})),_:1},8,["errors"]),Object(o["createVNode"])(b,{label:"Assigned To",errors:p.assignmentErrors},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])("select",{id:"","onUpdate:modelValue":t[5]||(t[5]=function(e){return u.newAction.assigned_to=e})},[c,(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(p.assignees,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("option",{key:e.id,value:e.id},Object(o["toDisplayString"])(e.name),9,["value"])})),128))],512),[[o["vModelSelect"],u.newAction.assigned_to]]),r,Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"text",label:"Name","onUpdate:modelValue":t[6]||(t[6]=function(e){return u.newAction.assigned_to_name=e}),placeholder:"Name (optional)"},null,512),[[o["vModelText"],u.newAction.assigned_to_name]])]})),_:1},8,["errors"]),i,Object(o["createVNode"])("label",l,[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=function(e){return u.completed=e})},null,512),[[o["vModelCheckbox"],u.completed]]),s]),u.completed?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:1,label:"Date Completed",errors:u.errors.date_completed,class:"ml-36"},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=function(e){return u.newAction.date_completed=e})},null,512),[[o["vModelText"],u.newAction.date_completed]])]})),_:1},8,["errors"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(O,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("button",{class:"btn",onClick:t[9]||(t[9]=function(){return p.cancel&&p.cancel.apply(p,arguments)})},"Cancel"),Object(o["createVNode"])("button",{class:"btn blue",onClick:t[10]||(t[10]=function(){return p.save&&p.save.apply(p,arguments)})},"Save")]})),_:1})]})),_:1})}n("99af"),n("7db0"),n("07ac"),n("96cf");var u=n("1da1"),p=n("2909"),b=n("5530"),m=n("a06a"),j=n("5502"),O=n("85fe"),f=n("e328"),_=n("4a91"),w={name:"NextActionForm",components:{StepInput:m["a"],RichTextEditor:O["a"]},props:{id:{required:!1,default:null}},emits:["saved","closed","formCleared","canceled"],data:function(){return{errors:{},newAction:{date_created:new Date,step:null,date_completed:null,entry:"",assigned_to:null,assigned_to_name:null},completed:!1}},computed:Object(b["a"])(Object(b["a"])({},Object(j["b"])({application:"applications/currentItem"})),{},{title:function(){return this.newAction.id?"Update Action":"Add Next Action"},steps:function(){return[1,2,3,4]},assignmentErrors:function(){var e=[];return this.errors.assigned_to&&(e=[].concat(Object(p["a"])(e),Object(p["a"])(this.errors.assigned_to))),this.errors.assigned_to_name&&(e=[].concat(Object(p["a"])(e),Object(p["a"])(this.errors.assigned_to_name))),e},assignees:function(){return Object.values(_.nextActions.assignees)}}),watch:{id:{immediate:!0,handler:function(){var e=this.findAction();e&&this.syncAction(e)}},application:{immediate:!0,handler:function(){var e=this.findAction();e&&this.syncAction(e)}}},methods:{cancel:function(){this.clearForm(),this.$emit("canceled")},clearForm:function(){console.log("clearForm()"),this.initNewAction(),this.$emit("formCleared")},initNewAction:function(){this.newAction={date_created:new Date,step:null,target_date:null,date_completed:null,entry:"",assigned_to:null,assigned_to_name:null}},findAction:function(){var e=this;return null===this.id?null:this.application.next_actions?this.application.next_actions.find((function(t){return t.id==e.id})):void 0},syncAction:function(e){var t;e&&(this.newAction={id:e.id,uuid:e.uuid,date_created:Object(f["a"])(e.created_at),step:e.step,target_date:Object(f["a"])(e.target_date),date_completed:Object(f["a"])(e.date_completed),entry:null!==(t=e.entry)&&void 0!==t?t:"",assigned_to:e.assigned_to,assigned_to_name:e.assigned_to_name})},save:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("save!"),console.info("this.newAction",e.newAction),t.prev=2,!e.newAction.id){t.next=10;break}return t.next=6,e.$store.dispatch("applications/updateNextAction",{application:e.application,updatedAction:e.newAction});case 6:e.$emit("saved"),e.clearForm(),t.next=14;break;case 10:return t.next=12,e.$store.dispatch("applications/addNextAction",{application:e.application,nextActionData:e.newAction});case 12:e.$emit("saved"),e.clearForm();case 14:t.next=21;break;case 16:if(t.prev=16,t.t0=t["catch"](2),!t.t0.response||422!=t.t0.response.status||!t.t0.response.data.errors){t.next=21;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 21:case"end":return t.stop()}}),t,null,[[2,16]])})))()}},unmounted:function(){this.initNewAction()},mounted:function(){}};w.render=d;t["default"]=w}}]);
//# sourceMappingURL=next-action-form.6e9560f2.js.map