{"version":3,"sources":["webpack:///./src/views/PersonEdit.vue","webpack:///./src/views/PersonEdit.vue?1701","webpack:///./src/forms/profile_form.js","webpack:///./src/components/people/ProfileForm.vue","webpack:///./src/components/people/ProfileForm.vue?eb3a"],"names":["_createElementBlock","_createVNode","_component_profile_form","person","$options","$event","onSaved","onCanceled","name","components","ProfileForm","props","uuid","required","type","String","computed","this","$store","getters","watch","immediate","handler","dispatch","methods","goBack","$router","go","__exports__","render","lookups","ref","countries","primaryOccupations","races","ethnicities","genders","profileFields","label","component","InstitutionSearchSelect","AddressInput","options","value","TimezoneSearchSelect","demographicFields","placeholder","show","data","primary_occupation_id","race_id","enthnicity_id","gender_id","getLookups","Object","keys","forEach","lkup","api","get","kebabCase","then","response","map","i","id","catch","error","console","_createElementVNode","class","_hoisted_1","_component_data_form","fields","$setup","$data","errors","_hoisted_2","_component_button_row","onSubmitted","submit-text","emits","profile","page","institutionId","timezone","title","initProfile","attributes","save","log","force","commit","$emit","isValidationError","cancel","setup","onMounted","mounted"],"mappings":"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","file":"js/chunk-7d0deda0.f4a740b5.js","sourcesContent":["<template>\n    <div>\n        <profile-form :person=\"person\"\n            v-model=\"person\"\n            @saved=\"goBack()\"\n            @canceled=\"goBack()\"\n        ></profile-form>\n    </div>\n</template>\n<script>\nimport ProfileForm from '@/components/people/ProfileForm'\n\nexport default {\n    name: 'PersonEdit',\n    components: {\n        ProfileForm\n    },\n    props: {\n        uuid: {\n            required: true,\n            type: String\n        }\n    },\n    computed: {\n        person () {\n            return this.$store.getters['people/currentItem'];\n        }\n    },\n    watch: {\n        uuid: {\n            immediate: true,\n            handler () {\n                this.$store.dispatch('people/getPerson', {uuid: this.uuid});\n            }\n        }\n    },\n    methods: {\n        goBack () {\n            this.$router.go(-1);\n        }\n    }\n}\n</script>","import { render } from \"./PersonEdit.vue?vue&type=template&id=147604cc\"\nimport script from \"./PersonEdit.vue?vue&type=script&lang=js\"\nexport * from \"./PersonEdit.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import {ref, computed} from 'vue';\nimport api from '@/http/api';\nimport {kebabCase} from '@/utils'\nimport TimezoneSearchSelect from '@/components/forms/TimezoneSearchSelect'\nimport InstitutionSearchSelect from '@/components/forms/InstitutionSearchSelect'\nimport AddressInput from '@/components/forms/AddressInput'\n\nexport const lookups = ref({\n    countries:[],\n    primaryOccupations:[],\n    races:[],\n    ethnicities:[],\n    genders:[],\n});\n\nexport const profileFields = computed(() => [\n    { name: 'first_name'},\n    { name: 'last_name'},\n    { name: 'email'},\n    {\n        name: 'institution_id',\n        label: 'Institution',\n        type: 'component',\n        component: InstitutionSearchSelect\n    },\n    { name: 'credentials', type: 'large-text'},\n    { name: 'biography', type: 'large-text'},\n    {\n        name: '*', // specifies passing entire modelValue to component.\n        type: 'component',\n        label: 'Address',\n        component: AddressInput\n    },\n    { \n        name: 'country_id', \n        label: 'Country',\n        type: 'select', \n        options: lookups.value.countries\n    },\n    { name: 'phone'},\n    { \n        name: 'timezone', \n        label: 'Timezone',\n        type: 'component', \n        component: TimezoneSearchSelect\n    },\n]);\n\nexport const demographicFields = computed(() => [\n    {\n        name: 'primary_occupation_id',\n        label: 'Primary Occupation',\n        type: 'select',\n        options: lookups.value.primaryOccupations\n    },\n    {\n        name: 'primary_occupation_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.primary_occupation_id == 100\n        }\n    },\n    {\n        name: 'race_id',\n        label: 'Race',\n        type: 'select',\n        options: lookups.value.races\n    },\n    {\n        name: 'race_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.race_id == 100\n        }\n    },\n    {\n        name: 'ethnicity_id',\n        label: 'Ethnicity',\n        type: 'select',\n        options: lookups.value.ethnicities\n    },\n    {\n        name: 'enthnicity_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.enthnicity_id == 100\n        }\n    },\n    {\n        name: 'gender_id',\n        label: 'Gender',\n        type: 'select',\n        options: lookups.value.genders\n    },\n    {\n        name: 'gender_other',\n        label: ' ',\n        type: 'text',\n        placeholder: 'Details',\n        show: (data) => {\n            return data.gender_id == 100\n        }\n    },\n]);\n\nexport const getLookups = () => {\n    Object.keys(lookups.value).forEach(lkup => {\n        api.get(`/api/people/lookups/${kebabCase(lkup)}`)\n            .then(response => {\n                lookups.value[lkup] = response.data.data.map(i => ({value: i.id, label: i.name}));\n            })\n            .catch(error => console.error(error));\n    })\n}\n\nexport default {\n    profileFields,\n    demographicFields,\n    lookups,\n    getLookups,\n}","<template>\n    <div>\n        <h3>Profile</h3>\n        <data-form \n            :fields=\"profileFields\" \n            v-model=\"profile\" \n            :errors=\"errors\"\n        ></data-form>\n        <hr class=\"my-4\">\n\n        <!-- <h3>Demographics</h3>\n        <data-form \n            :fields=\"demographicFields\" \n            v-model=\"profile\" \n            :errors=\"errors\"\n        ></data-form> -->\n\n        <button-row @submitted=\"save\" @canceled=\"cancel()\" submit-text=\"Save\"></button-row>\n    </div>\n</template>\n<script>\nimport isValidationError from '@/http/is_validation_error'\nimport {onMounted} from 'vue'\nimport {getLookups, profileFields, demographicFields, lookups} from '@/forms/profile_form';\n\nexport default {\n    name: 'ProfileForm',\n    props: {\n        person: {\n            type: Object,\n            required: true\n        }\n    },\n    emits: [\n        'saved',\n        'canceled'\n    ],\n    data() {\n        return {\n            errors: {},\n            profile: {},\n            page: 'profile',\n            institutionId: null,\n            timezone: null\n        }\n    },\n    computed: {\n        fields () {\n            return (this.page == 'profile') ? this.profileFields : this.demographicFields;\n        },\n        title () {\n            return this.page == 'profile' ? 'Please fill out your profile' : 'Please share your demographic information.'\n        }\n    },\n    watch: {\n        person () {\n            this.initProfile();\n        }\n    },\n    methods: {\n        initProfile () {\n            this.profile = {...this.person.attributes};\n        },\n        async save () {\n            console.log('ProfileForm.save')\n            try {\n                await this.$store.dispatch(\n                        'people/updateProfile', \n                        {uuid: this.person.uuid, attributes: this.profile}\n                    )                \n                    .then(() => {\n                        this.$store.dispatch('getCurrentUser', {force: true})\n                        this.$store.commit('pushSuccess', 'Your profile has been updated.')\n                    })\n                    \n                this.errors = {};\n                this.$emit('saved');\n            } catch (error) {\n                if (isValidationError(error)) {\n                    this.errors = error.response.data.errors;\n                }\n            }\n        },\n        cancel () {\n            this.initProfile();\n            this.errors = {};\n            this.$emit('canceled');\n        }\n    },\n    setup () {\n        onMounted(() => getLookups());\n\n        return {\n            profileFields,\n            demographicFields,\n            getLookups,\n            lookups,\n        }\n    },\n    async mounted () {\n        this.initProfile()\n    }\n}\n</script>","import { render } from \"./ProfileForm.vue?vue&type=template&id=75b92cd8\"\nimport script from \"./ProfileForm.vue?vue&type=script&lang=js\"\nexport * from \"./ProfileForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}