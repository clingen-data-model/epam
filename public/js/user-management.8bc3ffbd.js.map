{"version":3,"file":"js/user-management.8bc3ffbd.js","mappings":"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","sources":["webpack://epam/./src/composables/router_aware_sort_and_filter.js","webpack://epam/./src/views/users/UserDetail.vue","webpack://epam/./src/views/users/UserDetail.vue?b814","webpack://epam/./src/views/users/UserList.vue","webpack://epam/./src/views/users/UserList.vue?6dab"],"sourcesContent":["import { useRouter, useRoute } from 'vue-router'\nimport {computed} from 'vue'\n\nexport default function (defaultSort = null) {\n    const router = useRouter()\n    const route = useRoute()\n    if (!defaultSort){\n        console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: \"fieldname\", desc: boolean}')\n        defaultSort = (defaultSort) ? defaultSort : {field: 'name', desc: false}\n    }\n    \n    const sort = computed({\n        immediate: true,\n        get() {\n            if (Object.keys(route.query).includes('sort-field')) {\n                return {\n                    field: route.query['sort-field'],\n                    desc: Boolean(parseInt(route.query['sort-desc']))\n                }\n            }\n            return defaultSort;\n        },\n        set(sortObj) {\n            const newSortQuery = {'sort-field': sortObj.field, 'sort-desc': sortObj.desc ? 1 : 0}\n    \n            const newQuery = {\n                ...route.query, \n                ...newSortQuery\n            };\n    \n            router.replace({path: route.path, query: newQuery})\n        }\n    });\n    \n    const filter = computed({\n        set(value) {\n            let currentQuery = route.query;\n            let currentPath = route.path;\n    \n            let updatedQuery = {...currentQuery};\n    \n            if (!value) {\n                delete updatedQuery.filter;\n            } else {\n                updatedQuery = {...currentQuery, ...{'filter': value} };\n            }\n    \n            router.replace({path: currentPath, query: updatedQuery})\n        },\n        get() {\n            return route.query.filter\n        },\n        immediate: true\n    });\n\n    return {\n        sort,\n        filter\n    }\n}\n","<template>\n    <div>\n        <h1>{{user.person.name || 'loading...'}}</h1>\n\n        <object-dictionary :obj=\"userInfo\"></object-dictionary>\n        <button class=\"btn btn-xs\" @click=\"initEdit\" v-if=\"canEditUser\">Edit system roles &amp; permissions</button>\n\n        <h2 class=\"mt-8 mb-2\">Memberships</h2>\n        <data-table :fields=\"membershipFields\" :data=\"membershipInfo\"></data-table>\n\n        <teleport to=\"body\">\n            <modal-dialog\n                v-model=\"showEditForm\"\n                title=\"Edit System Roles & Permissions\"\n            >\n                <h3 class=\"border-b mb-1\">Roles</h3>\n                <ul class=\"flex flex-wrap\">\n                    <li v-for=\"role in availableSystemRoles\" :key=\"role.id\" class=\"w-1/3 h-12\">\n                        <checkbox v-model=\"checkedRoles\" :label=\"titleCase(role.display_name)\" :value=\"role.id\" />\n                    </li>\n                </ul>\n\n                <h3 class=\"border-b mb-1\">Permissions</h3>\n                <ul class=\"flex flex-wrap\">\n                    <li v-for=\"permission in availableSystemPermissions\" :key=\"permission.id\" class=\"w-1/3 h-12\">\n                        <checkbox\n                            v-if=\"checkedRolePermissionIds.includes(permission.id)\"\n                            :modelValue=\"true\" :disabled=\"true\" :label=\"permission.display_name\"\n                        />\n                        <checkbox\n                            v-else\n                            v-model=\"checkedPermissions\"\n                            :label=\"titleCase(permission.display_name)\"\n                            :value=\"permission.id\"\n                        />\n                    </li>\n                </ul>\n\n                <div class=\"px-2 py-1 mb-2 mt-4 bg-gray-100 border relative text-xs\">\n                    <div class=\"flex space-x-2\">\n                    <strong>Legend: </strong>\n                        <checkbox label=\"Not granted\" />\n                        <checkbox :value=\"1\" :modelValue=\"true\" label=\"Granted\" />\n                        <checkbox :value=\"2\" :modelValue=\"true\"  disabled label=\"Granted w/ role\" />\n                    </div>\n                    <div class=\"absolute top-0 left-0 w-full h-full bg-pink-500 opacity-0\">&nbsp;</div>\n                </div>\n\n                <button-row\n                    submit-text=\"Save\"\n                    @submitted=\"saveRolesAndPermissions\"\n                    @canceled=\"closeEditForm\"\n                ></button-row>\n            </modal-dialog>\n        </teleport>\n    </div>\n</template>\n<script>\nimport User from '@/domain/user'\nimport {api} from '@/http'\nimport configs from '@/configs'\n\nexport default {\n    name: 'UserDetail',\n    props: {\n        id: {\n            require: true\n        }\n    },\n    data() {\n        return {\n            user: new User(),\n            membershipFields: [\n                {name: 'id'},\n                {name: 'group'},\n                {name: 'roles'},\n                {name: 'extra_permissions'}\n            ],\n            showEditForm: false,\n            systemRoles: [],\n            systemPermissions: Object.values(configs.system.permissions),\n            configs,\n            checkedRoles: [],\n            checkedPermissions: [],\n        }\n    },\n    computed: {\n        userInfo () {\n            return {\n                name: this.user.person.name,\n                email: this.user.person.email,\n                roles: this.user.roles.map(r => r.name).join(', '),\n                additional_permissions: this.user.permissions.map(r => r.name).join(', '),\n                registered: this.formatDate(this.user.created_at),\n            }\n        },\n        membershipInfo () {\n            return this.user.person.memberships.map(m => ({\n                    id: m.id,\n                    group: m.group.display_name,\n                    roles: m.roles.map(r => r.name).join(', '),\n                    extra_permissions: m.permissions.map(r => r.name).join(', ') || '',\n                    is_contact: m.is_contact ? 'Yes' : 'No',\n                }))\n        },\n        checkedRolePermissionIds () {\n            if (!this.systemRoles) {\n                return [];\n            }\n            const checkedRolePerms = this.systemRoles\n                                        .filter(r => this.checkedRoles.includes(r.id))\n                                        .map(r => r.permissions)\n                                        .flat()\n                                        .map(p => p.id);\n            return [...(new Set(checkedRolePerms))];\n        },\n        availableSystemRoles () {\n            return this.systemRoles.filter(r => {\n                if (this.hasRole('super-user')) return true;\n                if (this.hasRole('super-admin')) {\n                    if (r.name === 'super-user') return false;\n                    return true;\n                }\n                return false;\n            });\n        },\n        availableSystemPermissions () {\n            return this.systemPermissions.filter(p => {\n                if (this.hasRole('super-user')) return true;\n                if (this.hasRole('super-admin')) {\n                    if (p.name === 'logs-view') return false;\n                    return true;\n                }\n                return false;\n            });\n        },\n        canEditUser () {\n            const currentUser = this.$store.getters.currentUser;\n            if (!this.hasPermission('users-manage')) {\n                return false;\n            }\n\n            if (this.currentUserIsUser) {\n                return true;\n            }\n\n            if (currentUser.hasRole('super-user')) {\n                return true;\n            }\n\n            if (currentUser.hasRole('super-admin') && (this.user.hasRole('admin') || this.user.hasNoRole())) {\n                return true;\n            }\n\n            return false;\n\n        },\n        currentUserIsUser () {\n            return this.$store.getters.currentUser.id == this.user.id;\n        }\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler () {\n                this.getUser();\n            }\n        }\n    },\n    methods: {\n        async getUser () {\n            this.user = await api.get(`/api/users/${this.id}`)\n                            .then(response => {\n                                return new User(response.data)\n                            });\n            this.resetCheckedRolesAndPermissions();\n        },\n        resetCheckedRolesAndPermissions () {\n            this.checkedRoles = this.user.roles.map(r => r.id);\n            this.checkedPermissions = this.user.permissions.map(r => r.id);\n        },\n        async getSystemRoles () {\n            this.systemRoles = await api.get(`/api/roles`)\n                                .then(response => response.data);\n        },\n        initEdit () {\n            this.showEditForm = true;\n        },\n        async saveRolesAndPermissions () {\n            const payload = {\n                role_ids: this.checkedRoles,\n                permission_ids: this.checkedPermissions\n            };\n\n            await api.put(`/api/users/${this.user.id}/roles-and-permissions`, payload);\n            this.showEditForm = false;\n\n            this.getUser();\n\n        },\n        closeEditForm () {\n            this.resetCheckedRolesAndPermissions();\n            this.showEditForm = false;\n        }\n    },\n    mounted () {\n        this.getSystemRoles();\n    }\n}\n</script>\n","import { render } from \"./UserDetail.vue?vue&type=template&id=0f72f512\"\nimport script from \"./UserDetail.vue?vue&type=script&lang=js\"\nexport * from \"./UserDetail.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/bpow/src/clingen/gpm/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div>\n        <h1>Users</h1>\n        <data-table\n            :fields=\"fields\"\n            :data=\"getUsers\"\n            v-model:sort=\"sort\"\n            @rowClick=\"goToUser\"\n            row-class=\"cursor-pointer\"\n            ref=\"dataTable\"\n            paginated\n        >\n            <template v-slot:header>\n                <div>Filter: &nbsp;<input type=\"text\" v-model=\"filter\" placeholder=\"name, email\"></div>\n            </template>\n        </data-table>\n    </div>\n</template>\n<script>\nimport {api} from '@/http'\nimport {debounce} from 'lodash-es'\nimport sortAndFilterSetup from '@/composables/router_aware_sort_and_filter'\n\nexport default {\n    name: 'ComponentName',\n    props: {\n\n    },\n    data() {\n        return {\n            users: [],\n            fields: [\n                {\n                    name: 'id',\n                    type: Number,\n                    sortable: true\n                },\n                {\n                    name: 'person.name',\n                    label: 'Name',\n                    type: String,\n                    sortable: true\n                },\n                {\n                    name: 'person.email',\n                    label: 'Email',\n                    type: String,\n                    sortable: true\n                },\n                {\n                    name: 'roles',\n                    label: 'System Roles',\n                    type: String,\n                    sortable: false,\n                    resolveValue (item) {\n                        return item.roles.map(r => r.display_name).join(', ')\n                    }\n                },\n                {\n                    name: 'permissions',\n                    label: '+ Permissions',\n                    type: String,\n                    sortable: false,\n                    resolveValue (item) {\n                        return item.permissions.map(r => r.display_name).join(', ')\n                    },\n                    class: 'text-xs'\n                },\n                // {\n                //     name: 'actions',\n                //     sortable: false,\n                //     label: ''\n                // }\n\n            ]\n        }\n    },\n    computed: {\n        filteredUsers () {\n            if (!this.filter) {\n                return this.users;\n            }\n            const pattern = new RegExp(`.*${this.filter}.*`, 'i')\n            return this.users.filter(u => {\n                return u.person.name.match(pattern)\n                    || u.person.email.match(pattern);\n            });\n        }\n    },\n    watch: {\n        filter: {\n            immediate: true,\n            handler () {\n                if (this.triggerSearch) {\n                    this.triggerSearch()\n                }\n            }\n        },\n        sort: {\n            immediate: true,\n            handler () {\n                 if (this.triggerSearch) {\n                    this.triggerSearch()\n                }\n            }\n        }\n    },\n    methods: {\n        async getUsers (currentPage, pageSize, sort, setTotalItems) {\n            const params = {\n                page: currentPage,\n                page_size: pageSize,\n                'sort[field]': sort.field.name,\n                'sort[dir]': sort.desc ? 'DESC' : 'ASC',\n                'where[filterString]': this.filter,\n                'with': ['roles', 'permissions'],\n                paginated: true\n            }\n            const pageResponse = await api.get('/api/users', {params: params})\n                                .then(response => response.data);\n            setTotalItems(pageResponse.meta.total);\n            return pageResponse.data;\n        },\n        goToUser (user) {\n            this.$router.push({name: 'UserDetail', params: {id: user.id}})\n        }\n    },\n    setup() {\n        const {sort, filter} = sortAndFilterSetup({\n            field: 'person.name',\n            desc: false\n        });\n\n        return {\n            sort,\n            filter,\n        }\n    },\n    created () {\n        this.triggerSearch = debounce(() => this.$refs.dataTable.getItems(), 500)\n    }\n}\n</script>\n","import { render } from \"./UserList.vue?vue&type=template&id=54a2e21a\"\nimport script from \"./UserList.vue?vue&type=script&lang=js\"\nexport * from \"./UserList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/bpow/src/clingen/gpm/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["defaultSort","router","useRouter","route","useRoute","console","log","field","desc","sort","computed","immediate","get","Object","keys","query","includes","Boolean","parseInt","set","sortObj","newSortQuery","newQuery","replace","path","filter","value","currentQuery","currentPath","updatedQuery","_createElementVNode","class","_createElementBlock","$data","person","name","_createVNode","_component_object_dictionary","obj","$options","onClick","_hoisted_1","_component_data_table","fields","data","_createBlock","_Teleport","to","_component_modal_dialog","title","_hoisted_2","_hoisted_3","_Fragment","role","key","id","_component_checkbox","label","_ctx","display_name","_hoisted_4","_hoisted_5","permission","modelValue","disabled","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_component_button_row","onSubmitted","onCanceled","props","require","user","User","membershipFields","showEditForm","systemRoles","systemPermissions","values","configs","system","permissions","checkedRoles","checkedPermissions","userInfo","this","email","roles","map","r","join","additional_permissions","registered","formatDate","created_at","membershipInfo","memberships","m","group","extra_permissions","is_contact","checkedRolePermissionIds","checkedRolePerms","flat","p","Set","availableSystemRoles","hasRole","availableSystemPermissions","canEditUser","currentUser","$store","getters","hasPermission","currentUserIsUser","hasNoRole","watch","handler","getUser","methods","api","then","response","resetCheckedRolesAndPermissions","getSystemRoles","initEdit","saveRolesAndPermissions","payload","role_ids","permission_ids","put","closeEditForm","mounted","__exports__","render","$setup","onRowClick","ref","paginated","header","type","placeholder","users","Number","sortable","String","resolveValue","item","filteredUsers","pattern","RegExp","u","match","triggerSearch","getUsers","currentPage","pageSize","setTotalItems","params","page","page_size","pageResponse","meta","total","goToUser","$router","push","setup","sortAndFilterSetup","created","debounce","$refs","dataTable","getItems"],"sourceRoot":""}