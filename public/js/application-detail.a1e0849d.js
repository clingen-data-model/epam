(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["application-detail","new-contact-form"],{"033d":function(e,t,n){"use strict";t["a"]=function(e){return e.response&&422==e.response.status&&e.response.data.errors}},"0bd6":function(e,t,n){},"0cb2":function(e,t,n){var a=n("7b0b"),i=Math.floor,r="".replace,o=/\$([$&'`]|\d\d?|<[^>]*>)/g,c=/\$([$&'`]|\d\d?)/g;e.exports=function(e,t,n,l,s,u){var p=n+e.length,d=l.length,b=c;return void 0!==s&&(s=a(s),b=o),r.call(u,b,(function(a,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(p);case"<":o=s[r.slice(1,-1)];break;default:var c=+r;if(0===c)return a;if(c>d){var u=i(c/10);return 0===u?a:u<=d?void 0===l[u-1]?r.charAt(1):l[u-1]+r.charAt(1):a}o=l[c-1]}return void 0===o?"":o}))}},"12ac":function(e,t,n){"use strict";n.r(t);n("99af"),n("b0c0");var a=n("7a23"),i={class:"flex space-x-2"},r=Object(a["h"])("Add Next Action"),o=Object(a["h"])("Add Log Entry");function c(e,t,n,c,l,s){var u=this,p=Object(a["A"])("router-link"),d=Object(a["A"])("next-action-banner"),b=Object(a["A"])("ep-attributes-form"),f=Object(a["A"])("progress-chart"),m=Object(a["A"])("step-tabs"),O=Object(a["A"])("tab-item"),j=Object(a["A"])("application-log"),h=Object(a["A"])("tabs-container"),v=Object(a["A"])("card"),w=Object(a["A"])("router-view"),g=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])(v,{title:"".concat(e.application.name," - Current Step: ").concat(e.application.current_step)},{"header-right":Object(a["L"])((function(){return[Object(a["i"])("div",i,[Object(a["i"])(p,{to:{name:"NextAction"},class:"btn btn-sm"},{default:Object(a["L"])((function(){return[r]})),_:1}),Object(a["i"])(p,{to:{name:"LogEntry"},class:"btn btn-sm"},{default:Object(a["L"])((function(){return[o]})),_:1})])]})),default:Object(a["L"])((function(){return[s.hasPendingNextAction?(Object(a["s"])(),Object(a["f"])(d,{key:0,application:e.application,"next-action":e.application.latest_pending_next_action},null,8,["application","next-action"])):Object(a["g"])("",!0),Object(a["i"])(b,{application:e.application},null,8,["application"]),Object(a["i"])(f,{application:e.application,class:"py-4 border-t border-b border-gray-300 my-6"},null,8,["application"]),Object(a["i"])(h,null,{default:Object(a["L"])((function(){return[Object(a["i"])(O,{label:"Application"},{default:Object(a["L"])((function(){return[Object(a["i"])(m,{application:e.application},null,8,["application"])]})),_:1}),Object(a["i"])(O,{label:"Application Log"},{default:Object(a["L"])((function(){return[Object(a["i"])(j,{uuid:e.application.uuid},null,8,["uuid"])]})),_:1}),Object(a["i"])(O,{label:"Dev Tools"},{default:Object(a["L"])((function(){return[Object(a["i"])("pre",null,Object(a["D"])(u.application),1)]})),_:1})]})),_:1})]})),_:1},8,["title"]),Object(a["i"])(g,{modelValue:l.showModal,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.showModal=e}),onClosed:s.handleModalClosed},{default:Object(a["L"])((function(){return[Object(a["i"])(w,{ref:"modalView",onSaved:s.hideModal,onCanceled:s.hideModal},null,8,["onSaved","onCanceled"])]})),_:1},8,["modelValue","onClosed"])])}n("ac1f"),n("5319");var l=n("5530"),s=n("5502"),u={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"};function p(e,t,n,i,r,o){var c=Object(a["A"])("data-table");return Object(a["s"])(),Object(a["f"])("div",null,[o.hasLogEntries?(Object(a["s"])(),Object(a["f"])(c,{key:1,fields:r.fields,data:o.filteredLogEntries,sort:r.sort,"onUpdate:sort":t[1]||(t[1]=function(e){return r.sort=e})},null,8,["fields","data","sort"])):(Object(a["s"])(),Object(a["f"])("div",u,Object(a["D"])(o.noResultsMessage),1))])}n("4de4"),n("a9e3"),n("96cf");var d=n("1da1"),b=[{name:"created_at",label:"Created",sortName:"created_at",sortable:!0,type:Date},{name:"description",label:"Entry",sortable:!0,type:String},{name:"causer.name",label:"User",sortable:!0}],f={props:{step:{required:!1,type:Number}},data:function(){return{fields:b,logEntries:[],sort:{field:"created_at",desc:!0}}},computed:Object(l["a"])(Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),{},{hasLogEntries:function(){return this.filteredLogEntries.length>0},filteredLogEntries:function(){var e=this;return this.application&&this.application.log_entries&&this.step?this.application.log_entries.filter((function(t){return t.properties.step==e.step})):this.application&&this.application.log_entries?this.application.log_entries:[]},noResultsMessage:function(){return"number"==typeof this.step?"No progress log entries have been entered for step ".concat(this.step):"There are no log entries for this application"}}),methods:{getLogEntries:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("applications/getApplication",e.application.uuid);case 2:case"end":return t.stop()}}),t)})))()}},mounted:function(){}};f.render=p;var m=f;function O(e,t,n,i,r,o){var c=Object(a["A"])("input-row"),l=Object(a["A"])("application-contacts");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])(c,{label:"Long Base Name",modelValue:r.appClone.long_base_name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.appClone.long_base_name=e}),placeholder:"Long base name",errors:r.errors.long_base_name,onChange:t[2]||(t[2]=function(e){return o.saveChanges()})},null,8,["modelValue","errors"]),Object(a["i"])(c,{label:"Short Base Name",modelValue:r.appClone.short_base_name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return r.appClone.short_base_name=e}),placeholder:"Short base name",errors:r.errors.short_base_name,onChange:t[4]||(t[4]=function(e){return o.saveChanges()})},null,8,["modelValue","errors"]),Object(a["i"])(c,{label:"Affiliation ID",modelValue:r.appClone.affiliation_id,"onUpdate:modelValue":t[5]||(t[5]=function(e){return r.appClone.affiliation_id=e}),placeholder:o.affiliationIdPlaceholder,errors:r.errors.affiliation_id,onChange:t[6]||(t[6]=function(e){return o.saveChanges()})},null,8,["modelValue","placeholder","errors"]),Object(a["i"])(c,{label:"CDWG",errors:r.errors.cdwg_id},{default:Object(a["L"])((function(){return[Object(a["M"])(Object(a["i"])("select",{name:"",id:"","onUpdate:modelValue":t[7]||(t[7]=function(e){return r.appClone.cdwg_id=e}),onChange:t[8]||(t[8]=function(e){return o.saveChanges()})},[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(o.cdwgs,(function(e){return Object(a["s"])(),Object(a["f"])("option",{value:e.id,key:e.id},Object(a["D"])(e.name),9,["value"])})),128))],544),[[a["H"],r.appClone.cdwg_id]])]})),_:1},8,["errors"]),Object(a["i"])(c,{label:"Contacts"},{default:Object(a["L"])((function(){return[Object(a["i"])(l,{onNewContactInitiated:t[9]||(t[9]=function(e){return o.saveChanges()})})]})),_:1}),Object(a["i"])(c,{label:"Expert Panel URL"},{default:Object(a["L"])((function(){return[Object(a["M"])(Object(a["i"])("div",{class:"text-gray-400"},Object(a["D"])(o.affiliationUrl),513),[[a["J"],!o.hasAffiliationId]]),Object(a["M"])(Object(a["i"])("a",{href:o.affiliationUrl,target:"clingen",class:"text-blue-500 underline"},Object(a["D"])(o.affiliationUrl),9,["href"]),[[a["J"],o.hasAffiliationId]])]})),_:1})])}function j(e,t,n,i,r,o){var c=Object(a["A"])("contact-row"),l=Object(a["A"])("add-contact-control");return Object(a["s"])(),Object(a["f"])("div",null,[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(e.application.contacts,(function(e){return Object(a["s"])(),Object(a["f"])(c,{key:e.id,contact:e},null,8,["contact"])})),128)),Object(a["i"])(l,{onNewContactInitiated:t[1]||(t[1]=function(e){return o.propagateEvent(e)})})])}var h={class:"align-baseline"},v=Object(a["h"])("Add Contact");function w(e,t,n,i,r,o){var c=Object(a["A"])("new-contact-form"),l=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("div",h,[Object(a["i"])("button",{class:"btn btn-xs",onClick:t[1]||(t[1]=function(){return o.initiateAddContact&&o.initiateAddContact.apply(o,arguments)})},[Object(a["z"])(e.$slots,"default",{},(function(){return[v]}))])]),Object(a["i"])(l,{modelValue:r.showForm,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.showForm=e})},{default:Object(a["L"])((function(){return[Object(a["i"])(c,{onDone:t[2]||(t[2]=function(e){r.showForm=!1}),onSaved:o.triggerAddedContact,onNewContactCanceled:t[3]||(t[3]=function(t){return e.$emit("new-contact-canceled")})},null,8,["onSaved"])]})),_:1},8,["modelValue"])])}var g=n("b2aa"),y={name:"AddContactControl",components:{NewContactForm:g["default"]},emits:["new-contact-initiated","contact-added","new-contact-canceled"],data:function(){return{showForm:!1,errors:{}}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{initiateAddContact:function(){this.showForm=!0,this.$emit("new-contact-initiated")},triggerAddedContact:function(){this.$emit("contact-added")}}};y.render=w;var _=y,C=(n("a15b"),Object(a["i"])("h4",{class:"text-lg mb-3 border-b pb-1"},"Confirm Contact Removal",-1)),A={class:"mb-2"},D=Object(a["h"])(" You are about to remove "),x=Object(a["h"])(" as a contact for this application. Do you want to continue? "),k=Object(a["i"])("small",{class:"text-gray-500"},"NOTE: This will not delete the person's record in this system.",-1),R={key:0,class:"bg-red-200 bg-text-900 border-red-900 p-2"};function F(e,t,n,i,r,o){var c=Object(a["A"])("remove-button"),l=Object(a["A"])("button-row"),s=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["h"])(Object(a["D"])(n.contact.name)+" - ",1),Object(a["i"])("a",{class:"text-blue-500 underline",href:"mailto:".concat(n.contact.email)},Object(a["D"])(n.contact.email),9,["href"]),Object(a["h"])(" - "+Object(a["D"])(n.contact.phone)+" ",1),Object(a["i"])(c,{size:"xs",onClick:o.confirmRemove},null,8,["onClick"]),Object(a["i"])(s,{modelValue:r.showRemoveConfirmation,"onUpdate:modelValue":t[3]||(t[3]=function(e){return r.showRemoveConfirmation=e})},{default:Object(a["L"])((function(){return[C,Object(a["i"])("p",A,[D,Object(a["i"])("strong",null,Object(a["D"])(n.contact.name),1),x]),k,r.errors?(Object(a["s"])(),Object(a["f"])("ul",R,[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(r.errors,(function(e,t){return Object(a["s"])(),Object(a["f"])("li",{key:t},Object(a["D"])(t)+": "+Object(a["D"])(e.join(", ")),1)})),128))])):Object(a["g"])("",!0),Object(a["i"])(l,null,{default:Object(a["L"])((function(){return[Object(a["i"])("div",{class:"btn",onClick:t[1]||(t[1]=function(){return o.cancel&&o.cancel.apply(o,arguments)})},"Cancel"),Object(a["i"])("div",{class:"btn blue",onClick:t[2]||(t[2]=function(){return o.save&&o.save.apply(o,arguments)})},"Yes, remove contact")]})),_:1})]})),_:1},8,["modelValue"])])}var L=n("033d");function V(e,t,n,i,r,o){var c=Object(a["A"])("icon-close");return Object(a["s"])(),Object(a["f"])("button",{class:"btn-delete",onClick:t[1]||(t[1]=function(){return e.confirmRemove&&e.confirmRemove.apply(e,arguments)})},[Object(a["i"])(c,{height:o.dimension,width:o.dimension},null,8,["height","width"])])}var S=Object(a["i"])("g",null,[Object(a["i"])("path",{d:"M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"})],-1);function E(e,t,n,i,r,o){var c=Object(a["A"])("icon-base");return Object(a["s"])(),Object(a["f"])(c,null,{default:Object(a["L"])((function(){return[S]})),_:1})}var I={};I.render=E;var $=I,M={components:{IconClose:$},props:{size:{required:!1,default:"md"}},data:function(){return{}},computed:{dimension:function(){return"xs"==this.size?8:"sm"==this.size?10:"md"==this.size?12:"lg"==this.size?14:"xl"==this.size?18:10}},methods:{}};n("4d19");M.render=V;var U=M,q={components:{RemoveButton:U},props:{contact:{type:Object,required:!0}},emits:["saved","canceled","done","deleted"],data:function(){return{showRemoveConfirmation:!1,errors:null}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{confirmRemove:function(){this.showRemoveConfirmation=!0},cancel:function(){this.showRemoveConfirmation=!1,this.$emit("canceled"),this.$emit("done")},save:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("applications/removeContact",{application:e.application,contact:e.contact});case 3:e.showRemoveConfirmation=!1,e.$emit("saved"),e.$emit("deleted"),e.$emit("done"),t.next=15;break;case 9:if(t.prev=9,t.t0=t["catch"](0),!Object(L["a"])(t.t0)){t.next=14;break}return alert(t.t0.response.data.errors),t.abrupt("return");case 14:throw t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,9]])})))()}}};q.render=F;var N=q,T={components:{ContactRow:N,AddContactControl:_},props:{},emits:["new-contact-initiated"],data:function(){return{}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{propagateEvent:function(e){console.log(e),this.$emit("new-contact-initiated")}}};T.render=j;var P=T,B={components:{ApplicationContacts:P},props:{application:{required:!0,type:Object}},data:function(){return{appClone:this.application.clone(),errors:{}}},watch:{application:{immediate:!0,handler:function(){this.appClone=this.application.clone()}}},computed:{affiliationUrl:function(){return"https://clinicalgenome.org/affiliation/".concat(this.appClone.affiliation_id||this.affiliationIdPlaceholder)},affiliationIdPlaceholder:function(){return this.application&&1==this.application.ep_type_id?"4000XX":"5000XX"},cdwgs:function(){return this.$store.state.cdwgs.items},hasAffiliationId:function(){return Boolean(this.appClone.affiliation_id)},hasChanges:function(){var e=["long_base_name","short_base_name","cdwg_id","affiliation_id"];for(var t in e){var n=e[t];if((null!=this.application[n]||""!=this.appClone[n])&&this.application[n]!=this.appClone[n])return!0}return!1},isClean:function(){return!this.hasChanges}},methods:{saveChanges:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.hasChanges){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.clearErrors(),t.next=6,e.$store.dispatch("applications/updateEpAttributes",e.appClone);case 6:t.next=14;break;case 8:if(t.prev=8,t.t0=t["catch"](2),!t.t0.response||422!=t.t0.response.status||!t.t0.response.data.errors){t.next=13;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 13:throw t.t0;case 14:case"end":return t.stop()}}),t,null,[[2,8]])})))()},resetClone:function(){this.appClone=this.application.clone()},clearErrors:function(){this.errors={}}},mounted:function(){this.$store.dispatch("cdwgs/getAll")}};B.render=O;var z=B,G={class:"px-2 py-2 pl-3 bg-blue-200 rounded flex justify-between text-blue-800"},J={class:"leading-6"},Q=Object(a["i"])("strong",null,"Next Action:",-1),Y=Object(a["i"])("h4",{class:"text-lg"},"Complete next action",-1);function H(e,t,n,i,r,o){var c=Object(a["A"])("object-dict"),l=Object(a["A"])("input-row"),s=Object(a["A"])("button-row"),u=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("div",G,[Object(a["i"])("div",J,[Q,Object(a["h"])(" "+Object(a["D"])(n.nextAction.entry),1)]),Object(a["i"])("button",{class:"btn blue btn-xs",onClick:t[1]||(t[1]=function(e){return r.showModal=!0})},"Mark completed")]),Object(a["i"])(u,{modelValue:r.showModal,"onUpdate:modelValue":t[5]||(t[5]=function(e){return r.showModal=e})},{default:Object(a["L"])((function(){return[Y,Object(a["i"])(c,{obj:n.nextAction,show:["date_created","entry","step","target_date"],dates:["target_date","date_created"]},null,8,["obj"]),Object(a["i"])(l,{label:"Date Completed",modelValue:r.dateCompleted,"onUpdate:modelValue":t[2]||(t[2]=function(e){return r.dateCompleted=e}),type:"date",errors:r.errors.date_completed},null,8,["modelValue","errors"]),Object(a["i"])(s,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn white",onClick:t[3]||(t[3]=function(){return o.cancel&&o.cancel.apply(o,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[4]||(t[4]=function(){return o.markComplete&&o.markComplete.apply(o,arguments)})},"Mark Complete")]})),_:1})]})),_:1},8,["modelValue"])])}var X={props:{application:{type:Object,required:!0},nextAction:{type:Object,required:!0}},data:function(){return{showModal:!1,dateCompleted:null,errors:{}}},methods:{clearForm:function(){this.dateCompleted=null},markComplete:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("applications/completeNextAction",{application:e.application,nextAction:e.nextAction,dateCompleted:e.dateCompleted});case 2:e.clearForm(),e.$emit("completed"),e.showModal=!1;case 5:case"end":return t.stop()}}),t)})))()},cancel:function(){this.clearForm(),this.showModal=!1,this.$emit("canceled")}}};X.render=H;var W=X,K=Object(a["P"])("data-v-6fa46a3a");Object(a["v"])("data-v-6fa46a3a");var Z=Object(a["i"])("h4",{class:"pb-2"},"EP Progress",-1),ee={class:"flex flex-row space-x-1"};Object(a["t"])();var te=K((function(e,t,n,i,r,o){var c=Object(a["A"])("progress-step");return Object(a["s"])(),Object(a["f"])("div",null,[Z,Object(a["i"])("div",ee,[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(o.steps,(function(e){return Object(a["s"])(),Object(a["f"])(c,{key:e,step:e,application:n.application},null,8,["step","application"])})),128))])])})),ne={class:"flex-1"},ae={class:"flex flex-row-reverse justify-between bg-transparent mt-1"},ie={key:0};function re(e,t,n,i,r,o){return Object(a["s"])(),Object(a["f"])("div",ne,[Object(a["i"])("div",{class:["progress-step",o.displayClass]},null,2),Object(a["i"])("div",ae,[Object(a["i"])("div",{class:{"-mr-10":!o.isLastStep}},Object(a["D"])(o.approvalDate),3),o.isFirstStep?(Object(a["s"])(),Object(a["f"])("div",ie,Object(a["D"])(o.dateInitiated),1)):Object(a["g"])("",!0)])])}var oe=n("e328"),ce={props:{step:{type:Number,required:!0},application:{type:Object,required:!0}},data:function(){return{}},computed:{dateInitiated:function(){return Object(oe["a"])(this.application.date_initiated)},approvalDate:function(){return this.application.approval_dates&&this.application.approval_dates["step "+this.step]?Object(oe["a"])(this.application.approval_dates["step "+this.step]):" "},displayClass:function(){var e=[];return this.isApproved?e.push("approved"):this.isCurrentStep&&e.push("active"),this.isFirstStep&&e.push("rounded-l"),this.isLastStep&&e.push("rounded-r"),e.join(" ")},isCurrentStep:function(){return this.application.current_step==this.step},isApproved:function(){return this.application.approval_dates&&"undefined"!=typeof this.application.approval_dates["step ".concat(this.step)]},isFirstStep:function(){return 1==this.step},isLastStep:function(){var e=1==this.application.ep_type_id?1:4;return this.step==e}},methods:{}};n("fc85");ce.render=re;var le=ce,se={components:{ProgressStep:le},props:{application:{required:!0,type:Object}},computed:{steps:function(){return 2==this.application.ep_type_id?[1,2,3,4]:[1]}}};n("6dbc");se.render=te,se.__scopeId="data-v-6fa46a3a";var ue=se,pe={key:0};function de(e,t,n,i,r,o){var c=Object(a["A"])("step-one"),l=Object(a["A"])("tab-item"),s=Object(a["A"])("step-two"),u=Object(a["A"])("step-three"),p=Object(a["A"])("step-four"),d=Object(a["A"])("tabs-container");return Object(a["s"])(),Object(a["f"])("div",null,[1==this.application.ep_type_id?(Object(a["s"])(),Object(a["f"])("div",pe,[Object(a["i"])(c)])):Object(a["g"])("",!0),2==this.application.ep_type_id?(Object(a["s"])(),Object(a["f"])(d,{key:1,"tab-location":"right",modelValue:o.activeIndex,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.activeIndex=e})},{default:Object(a["L"])((function(){return[Object(a["i"])(l,{label:"Step 1 - Define"},{default:Object(a["L"])((function(){return[Object(a["i"])(c)]})),_:1}),Object(a["i"])(l,{label:"Step 2 - Draft Rules"},{default:Object(a["L"])((function(){return[Object(a["i"])(s)]})),_:1}),Object(a["i"])(l,{label:"Step 3 - Pilot Rules"},{default:Object(a["L"])((function(){return[Object(a["i"])(u)]})),_:1}),Object(a["i"])(l,{label:"Step 4 - Final Approval"},{default:Object(a["L"])((function(){return[Object(a["i"])(p)]})),_:1})]})),_:1},8,["modelValue"])):Object(a["g"])("",!0)])}function be(e,t,n,i,r,o){var c=Object(a["A"])("coi-log"),l=Object(a["A"])("base-step");return Object(a["s"])(),Object(a["f"])(l,{step:1,"document-name":"Scope and Membership Application",title:"Scope and Membership","document-type":1,"document-gets-reviewed":!0,"approve-button-label":"Approve Scope and Membership"},{default:Object(a["L"])((function(){return[Object(a["i"])(c,{class:"mb-6",application:e.application},null,8,["application"])]})),_:1})}var fe={class:"mb-6"},me={class:"flex justify-between text-lg font-bold pb-2 mb-2 border-b"},Oe={key:0},je={key:0,class:"flex space-x-1"},he={class:"text-white bg-green-600 rounded-xl px-2"},ve={key:1,class:"flex space-x-1"},we={class:"font-bold"},ge={key:0,class:"border border-l-0 border-r-0 py-4 mb-6"},ye={class:"mb-6"},_e={class:"text-md font-bold mb-2"};function Ce(e,t,n,i,r,o){var c=Object(a["A"])("edit-button"),l=Object(a["A"])("date-input"),s=Object(a["A"])("remove-button"),u=Object(a["A"])("document-manager"),p=Object(a["A"])("approve-step-form"),d=Object(a["A"])("modal-dialog"),b=Object(a["A"])("application-log");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("div",fe,[Object(a["i"])("div",me,[Object(a["i"])("h3",null,Object(a["D"])(n.title),1),o.dateApproved?(Object(a["s"])(),Object(a["f"])("div",Oe,[r.editApprovalDate?(Object(a["s"])(),Object(a["f"])("div",ve,[Object(a["i"])(l,{modelValue:r.newApprovalDate,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.newApprovalDate=e})},null,8,["modelValue"]),Object(a["i"])("button",{class:"btn blue",onClick:t[2]||(t[2]=function(){return o.updateApprovalDate&&o.updateApprovalDate.apply(o,arguments)})},"Save"),Object(a["i"])(s,{onClick:t[3]||(t[3]=function(e){return r.editApprovalDate=!1})})])):(Object(a["s"])(),Object(a["f"])("div",je,[Object(a["i"])("div",he," Appproved: "+Object(a["D"])(o.dateApproved),1),Object(a["i"])(c,{class:"text-black",onClick:o.initEditApprovalDate},null,8,["onClick"])]))])):Object(a["g"])("",!0)]),Object(a["z"])(e.$slots,"document",{},(function(){return[Object(a["i"])("h4",we,Object(a["D"])(n.documentName),1),Object(a["i"])(u,{class:"border-b",application:e.application,"document-type-id":n.documentType,getsReviewd:n.documentGetsReviewed,step:n.step},null,8,["application","document-type-id","getsReviewd","step"])]}))]),e.application.stepIsApproved(n.step)?Object(a["g"])("",!0):(Object(a["s"])(),Object(a["f"])("div",ge,[Object(a["i"])("button",{class:"btn btn-lg w-full",onClick:t[4]||(t[4]=function(){return o.startApproveStep&&o.startApproveStep.apply(o,arguments)}),disabled:!o.isCurrentStep,title:o.isCurrentStep?"Approve this step":"You can only approve the application's current step"},Object(a["D"])(n.approveButtonLabel),9,["disabled","title"]),Object(a["i"])(d,{modelValue:r.showApproveForm,"onUpdate:modelValue":t[5]||(t[5]=function(e){return r.showApproveForm=e})},{default:Object(a["L"])((function(){return[Object(a["i"])(p,{onSaved:o.hideApproveForm,onCanceled:o.hideApproveForm},null,8,["onSaved","onCanceled"])]})),_:1},8,["modelValue"])])),Object(a["z"])(e.$slots,"default"),Object(a["z"])(e.$slots,"log",{},(function(){return[Object(a["i"])("div",ye,[Object(a["i"])("h4",_e,"Step "+Object(a["D"])(n.step)+" Progress Log",1),Object(a["i"])(b,{step:n.step},null,8,["step"])])]}))])}var Ae={key:1};function De(e,t,n,i,r,o){var c=Object(a["A"])("final-document-view"),l=Object(a["A"])("document-list"),s=Object(a["A"])("document-upload-form"),u=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[n.application.stepIsApproved(n.step)?(Object(a["s"])(),Object(a["f"])(c,{key:0,application:n.application,"document-type-id":n.documentTypeId,step:n.step},null,8,["application","document-type-id","step"])):(Object(a["s"])(),Object(a["f"])("div",Ae,[Object(a["i"])("button",{class:"btn mb-2",onClick:t[1]||(t[1]=function(e){return r.showUploadForm=!0})}," Upload a new version "),Object(a["i"])(l,{application:n.application,"document-type-id":n.documentTypeId},null,8,["application","document-type-id"]),Object(a["i"])(u,{modelValue:r.showUploadForm,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.showUploadForm=e}),onClosed:t[5]||(t[5]=function(t){return e.$refs.uploadform.clearForm()})},{default:Object(a["L"])((function(){return[Object(a["i"])(s,{application:n.application,"document-type-id":n.documentTypeId,step:n.step,onCanceled:t[2]||(t[2]=function(e){return r.showUploadForm=!1}),onSaved:t[3]||(t[3]=function(e){return r.showUploadForm=!1}),ref:"uploadform"},null,8,["application","document-type-id","step"])]})),_:1},8,["modelValue"])]))])}var xe={class:"flex space-x-1"};function ke(e,t,n,i,r,o){var c=Object(a["A"])("icon-checkmark"),l=Object(a["A"])("icon-download"),s=Object(a["A"])("icon-edit"),u=Object(a["A"])("data-table"),p=Object(a["A"])("document-edit-form"),d=Object(a["A"])("modal-dialog"),b=Object(a["A"])("document-reviewed-form");return Object(a["s"])(),Object(a["f"])("div",null,[o.filteredDocuments.length>0?(Object(a["s"])(),Object(a["f"])(u,{key:0,fields:o.filteredFields,data:o.filteredDocuments,sort:{field:r.fields[0].name,desc:!0}},{"cell-is_final":Object(a["L"])((function(e){var t=e.item;return[t.is_final?Object(a["g"])("",!0):(Object(a["s"])(),Object(a["f"])(c,{key:0,onClick:function(e){return o.markFinal(t)},title:"Mark this the final version.",class:"text-gray-300 cursor-pointer inline"},null,8,["onClick"])),t.is_final?(Object(a["s"])(),Object(a["f"])(c,{key:1,class:"text-green-600 inline",title:"This is the final document"})):Object(a["g"])("",!0)]})),"cell-id":Object(a["L"])((function(e){var t=e.item;return[Object(a["i"])("div",xe,[Object(a["i"])("button",{class:"btn btn-xs",onClick:function(e){return o.downloadDocument(t)}},[Object(a["i"])(l,{width:"12",height:"16"})],8,["onClick"]),Object(a["i"])("button",{class:"btn btn-xs",onClick:function(e){return o.openEditForm(t)}},[Object(a["i"])(s,{width:"12",height:"16"})],8,["onClick"])])]})),_:1},8,["fields","data","sort"])):Object(a["g"])("",!0),Object(a["i"])(d,{modelValue:r.showEditForm,"onUpdate:modelValue":t[3]||(t[3]=function(e){return r.showEditForm=e})},{default:Object(a["L"])((function(){return[Object(a["i"])(p,{document:r.activeDocument,application:n.application,onCanceled:t[1]||(t[1]=function(e){return r.showEditForm=!1}),onSaved:t[2]||(t[2]=function(e){return r.showEditForm=!1}),onTriggermarkreviewed:o.showMarkReviewed},null,8,["document","application","onTriggermarkreviewed"])]})),_:1},8,["modelValue"]),Object(a["i"])(d,{modelValue:r.showReviewedForm,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.showReviewedForm=e})},{default:Object(a["L"])((function(){return[Object(a["i"])(b,{document:r.activeDocument,application:n.application,onCanceled:o.hideReviewedForm,onSaved:o.hideReviewedForm},null,8,["document","application","onCanceled","onSaved"])]})),_:1},8,["modelValue"])])}n("7db0"),n("c740"),n("fb6a");var Re=n("2909"),Fe=Object(a["i"])("g",null,[Object(a["i"])("path",{d:"M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"})],-1);function Le(e,t,n,i,r,o){var c=Object(a["A"])("icon-base");return Object(a["s"])(),Object(a["f"])(c,null,{default:Object(a["L"])((function(){return[Fe]})),_:1})}var Ve={};Ve.render=Le;var Se=Ve,Ee=Object(a["i"])("path",{d:"M0 11l2-2 5 5L18 3l2 2L7 18z"},null,-1);function Ie(e,t,n,i,r,o){var c=Object(a["A"])("icon-base");return Object(a["s"])(),Object(a["f"])(c,{"icon-name":n.title||"checkmark icon"},{default:Object(a["L"])((function(){return[Ee]})),_:1},8,["icon-name"])}var $e={props:{title:{required:!1,type:String}}};$e.render=Ie;var Me=$e,Ue=Object(a["i"])("g",null,[Object(a["i"])("path",{d:"M12.3 3.7l4 4L4 20H0v-4L12.3 3.7zm1.4-1.4L16 0l4 4-2.3 2.3-4-4z"})],-1);function qe(e,t,n,i,r,o){var c=Object(a["A"])("icon-base");return Object(a["s"])(),Object(a["f"])(c,null,{default:Object(a["L"])((function(){return[Ue]})),_:1})}var Ne={};Ne.render=qe;var Te=Ne,Pe=Object(a["i"])("h3",{class:"text-lg border-b pb-1 mb-3"},"Mark Document Reviewed",-1);function Be(e,t,n,i,r,o){var c=Object(a["A"])("input-row"),l=Object(a["A"])("button-row");return Object(a["s"])(),Object(a["f"])("div",null,[Pe,Object(a["i"])(c,{modelValue:r.dateReviewed,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.dateReviewed=e}),label:"Date Reviewed",errors:r.errors.date_reviewed,type:"date"},null,8,["modelValue","errors"]),Object(a["i"])(l,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn",onClick:t[2]||(t[2]=function(){return o.cancel&&o.cancel.apply(o,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[3]||(t[3]=function(){return o.saveDateReviewed&&o.saveDateReviewed.apply(o,arguments)})},"Mark Reviewed")]})),_:1})])}var ze={name:"DocumentReviewForm",props:{application:{type:Object,required:!0},document:{type:Object,required:!0}},data:function(){return{dateReviewed:null,isFinal:!1,errors:{}}},computed:{isReviewed:function(){return Boolean(this.dateReviewed)}},methods:{saveDateReviewed:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("applications/markDocumentReviewed",{application:e.application,document:e.document,dateReviewed:e.dateReviewed,isFinal:e.isFinal});case 3:e.clearForm(),e.$emit("saved"),t.next=12;break;case 7:if(t.prev=7,t.t0=t["catch"](0),!Object(L["a"])(t.t0)){t.next=12;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 12:case"end":return t.stop()}}),t,null,[[0,7]])})))()},cancel:function(){this.clearForm(),this.$emit("canceled")},clearForm:function(){this.dateReviewed=null}}};ze.render=Be;var Ge=ze,Je={class:"text-lg border-b pb-1 mb-3"};function Qe(e,t,n,i,r,o){var c=Object(a["A"])("dictionary-row"),l=Object(a["A"])("input-row"),s=Object(a["A"])("button-row");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("h3",Je,"Edit "+Object(a["D"])(o.type)+" version "+Object(a["D"])(n.document.version)+" Info",1),Object(a["i"])(c,{label:"File"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(n.document.filename),1)]})),_:1}),Object(a["i"])(l,{modelValue:r.docProxy.date_received,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.docProxy.date_received=e}),label:"Date Received",type:"date",errors:r.errors.date_received},null,8,["modelValue","errors"]),Object(a["i"])(s,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn",onClick:t[2]||(t[2]=function(){return o.cancelEdit&&o.cancelEdit.apply(o,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[3]||(t[3]=function(){return o.saveEdits&&o.saveEdits.apply(o,arguments)})},"Save")]})),_:1})])}var Ye={name:"DocumentEditForm",props:{document:{required:!0,type:Object},application:{required:!0,type:Object}},emits:["triggermarkreviewed"],data:function(){return{docProxy:{},errors:{}}},computed:{type:function(){return this.document.type?this.document.type.long_name:""}},watch:{document:{immediate:!0,handler:function(){console.log(this.document),this.docProxy=JSON.parse(JSON.stringify(this.document))}}},methods:{cancelEdit:function(){this.docProxy={},this.$emit("canceled")},saveEdits:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("applications/updateDocumentInfo",{application:e.application,document:e.docProxy});case 3:e.docProxy={},e.$emit("saved"),t.next=11;break;case 7:throw t.prev=7,t.t0=t["catch"](0),Object(L["a"])(t.t0)&&(e.errors=t.t0.response.data.errors),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()}}};Ye.render=Qe;var He=Ye,Xe={components:{IconDownload:Se,IconCheckmark:Me,DocumentReviewedForm:Ge,DocumentEditForm:He,IconEdit:Te},props:{application:{type:Object,required:!0},documentTypeId:{type:Number,required:!0},getsReviewed:{type:Boolean,required:!1,default:!0}},data:function(){return{showReviewedForm:!1,showEditForm:!1,activeDocument:{},fields:[{name:"version",label:"Version",type:Number},{name:"filename",label:"File",type:String},{name:"date_received",label:"Date Received",type:Date},{name:"is_final",label:"Final",type:Boolean,sortable:!1,class:["text-center"],headerClass:["text-center"]},{name:"id",label:"",sortable:!1}]}},computed:{filteredFields:function(){var e=Object(Re["a"])(this.fields);if(!this.getsReviewed){var t=e.findIndex((function(e){return e&&"date_reviewed"==e.name}));e=e.slice(0,t)}return e},filteredDocuments:function(){var e=this;return this.application&&this.application.documents?this.application.documents.filter((function(t){return t.document_type_id==e.documentTypeId})):[]},hasFinalVersion:function(){return this.filteredDocuments.findIndex((function(e){return e.is_final}))>-1},finalVersion:function(){return this.filteredDocuments.find((function(e){return e.is_final}))||{}}},methods:{showMarkReviewed:function(e){this.activeDocument=e,this.showReviewedForm=!0},hideReviewedForm:function(){this.showReviewedForm=!1},downloadDocument:function(e){window.location=e.download_url},confirmNewFinal:function(e){var t="There is already a version of this document marked as final.  Only one version can be marked as final.  Do you want to mark this version (version ".concat(e.version,") as final instead of ").concat(this.finalVersion.version);return confirm(t)},markFinal:function(e){this.hasFinalVersion&&!this.confirmNewFinal(e)||this.$store.dispatch("applications/markDocumentVersionFinal",{application:this.application,document:e})},openEditForm:function(e){this.showEditForm=!0,this.activeDocument=e}}};Xe.render=ke;var We=Xe,Ke={class:"text-xl font-semibold pb-2 border-b mb-4"},Ze={type:"file",ref:"fileInput"};function et(e,t,n,i,r,o){var c=Object(a["A"])("input-row"),l=Object(a["A"])("button-row");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("h4",Ke,"Upload "+Object(a["D"])(o.documentType.long_name)+" document(s)",1),Object(a["i"])(c,{label:"Document",errors:r.errors.file},{default:Object(a["L"])((function(){return[Object(a["i"])("input",Ze,null,512)]})),_:1},8,["errors"]),Object(a["i"])(c,{label:"Date Received",type:"date",modelValue:r.newDocument.date_received,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.newDocument.date_received=e}),errors:r.errors.date_receoved},null,8,["modelValue","errors"]),Object(a["i"])(l,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn white",onClick:t[2]||(t[2]=function(){return o.cancel&&o.cancel.apply(o,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[3]||(t[3]=function(){return o.saveDocument&&o.saveDocument.apply(o,arguments)})},"Save")]})),_:1})])}n("4160"),n("b64b"),n("159b");var tt={props:{application:{type:Object,required:!0},documentTypeId:{type:Number,required:!0},step:{type:Number,required:!1,default:null}},data:function(){return{newDocument:{file:null,date_received:new Date,date_reviewed:null,step:this.step,document_type_id:this.documentTypeId},errors:{}}},computed:Object(l["a"])(Object(l["a"])({},Object(s["c"])({documentTypes:function(e){return e.doctypes.items}})),{},{isReviewed:function(){return Boolean(this.newDocument.date_reviewed)},documentType:function(){return 0==this.documentTypes.length?{}:this.$store.getters["doctypes/getItemById"](this.documentTypeId)}}),methods:{saveDocument:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=new FormData,Object.keys(e.newDocument).forEach((function(t){var a=e.newDocument[t];null!=a&&n.append(t,a)})),n.append("file",e.$refs.fileInput.files[0]),t.next=6,e.$store.dispatch("applications/addDocument",{application:e.application,documentData:n});case 6:e.clearForm(),e.$emit("saved"),t.next=15;break;case 10:if(t.prev=10,t.t0=t["catch"](0),!Object(L["a"])(t.t0)){t.next=15;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 15:case"end":return t.stop()}}),t,null,[[0,10]])})))()},cancel:function(){this.clearForm(),this.$emit("canceled")},clearForm:function(){this.initNewDocument(),this.clearErrors()},initNewDocument:function(){this.$refs.fileInput.value=null,this.newDocument={file:null,date_received:Object(oe["a"])(new Date),date_reviewed:null,step:this.step,document_type_id:this.documentTypeId}},clearErrors:function(){this.errors={}}},mounted:function(){this.$store.dispatch("doctypes/getItems")}};tt.render=et;var nt=tt,at={key:1};function it(e,t,n,i,r,o){var c=Object(a["A"])("dictionary-row"),l=Object(a["A"])("edit-button"),s=Object(a["A"])("date-input"),u=Object(a["A"])("remove-button"),p=Object(a["A"])("document-edit-form"),d=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])(c,{label:"Final Document"},{default:Object(a["L"])((function(){return[Object(a["i"])("div",null,[o.finalDocument.filename?(Object(a["s"])(),Object(a["f"])("a",{key:0,href:o.finalDocument.download_url,class:"text-blue-500 underline"},Object(a["D"])(o.finalDocument.filename),9,["href"])):(Object(a["s"])(),Object(a["f"])("span",at,"none on file"))])]})),_:1}),Object(a["i"])(c,{label:"Date Received"},{default:Object(a["L"])((function(){return[Object(a["M"])(Object(a["i"])("div",null,[Object(a["h"])(Object(a["D"])(o.firstDateReceived)+" ",1),Object(a["i"])(l,{onClick:o.initEditReceived},null,8,["onClick"])],512),[[a["J"],!r.editDateReceived]]),Object(a["M"])(Object(a["i"])("div",null,[Object(a["i"])(s,{modelValue:r.newDateReceived,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.newDateReceived=e}),class:"inline-block"},null,8,["modelValue"]),Object(a["i"])("button",{class:"btn btn-sm blue",onClick:t[2]||(t[2]=function(){return o.saveDateReceived&&o.saveDateReceived.apply(o,arguments)})},"Save"),Object(a["i"])(u,{class:"ml-1",onClick:t[3]||(t[3]=function(e){return r.editDateReceived=!1})})],512),[[a["J"],r.editDateReceived]])]})),_:1}),Object(a["i"])(d,{modelValue:r.showEditForm,"onUpdate:modelValue":t[6]||(t[6]=function(e){return r.showEditForm=e})},{default:Object(a["L"])((function(){return[Object(a["i"])(p,{document:o.finalDocument,application:n.application,onCanceled:t[4]||(t[4]=function(e){return r.showEditForm=!1}),onSaved:t[5]||(t[5]=function(e){return r.showEditForm=!1})},null,8,["document","application"])]})),_:1},8,["modelValue"])])}var rt={class:"btn btn-xs"};function ot(e,t,n,i,r,o){var c=Object(a["A"])("icon-edit");return Object(a["s"])(),Object(a["f"])("button",rt,[Object(a["i"])(c,{width:"12",height:"16"})])}var ct={components:{IconEdit:Te},props:{},data:function(){return{}},computed:{},methods:{}};ct.render=ot;var lt=ct,st={components:{DocumentEditForm:He,EditButton:lt,RemoveButton:U},props:{application:{type:Object,required:!0},documentTypeId:{type:Number,required:!0},step:{type:Number,required:!1,default:null}},data:function(){return{showEditForm:!1,editDateReceived:!1,newDateReceived:null,editDateReviewed:!1,newDateReviewed:null}},computed:{finalDocument:function(){return this.application.finalDocumentOfType(this.documentTypeId)},firstDocument:function(){return this.application.firstDocumentOfType(this.documentTypeId)},finalDateReviewed:function(){return this.finalDocument.date_reviewed?Object(oe["a"])(this.finalDocument.date_reviewed):"--"},firstDateReceived:function(){return this.firstDocument.date_received?Object(oe["a"])(this.firstDocument.date_received):"--"}},methods:{initEditReceived:function(){this.editDateReceived=!0,this.newDateReceived=this.firstDateReceived},saveDateReceived:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("applications/updateDocumentInfo",{application:e.application,document:{uuid:e.firstDocument.uuid,date_received:e.newDateReceived,date_reviewed:e.firstDocument.date_reviewed}});case 3:e.editDateReceived=!1,t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),Object(L["a"])(t.t0)&&console.info("saveDateReceived errors: ",t.t0.response.data.errors);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},initEditReviewed:function(){this.editDateReviewed=!0,this.newDateReviewed=this.finalDateReviewed},saveDateReviewed:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.finalDocument),t.prev=1,t.next=4,e.$store.dispatch("applications/updateDocumentInfo",{application:e.application,document:{uuid:e.finalDocument.uuid,date_reviewed:e.newDateReviewed,date_received:e.finalDocument.date_received}});case 4:e.editDateReviewed=!1,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1),Object(L["a"])(t.t0)&&console.info("saveDateReviewd errors: ",t.t0.response.data.errors);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))()}}};st.render=it;var ut=st,pt={name:"DocumentManager",components:{DocumentUploadForm:nt,FinalDocumentView:ut,DocumentList:We},props:{application:{type:Object,required:!0},documentTypeId:{type:Number,required:!0},getsReviewed:{type:Boolean,required:!1,default:!0},step:{type:Number,required:!1,default:null}},data:function(){return{showUploadForm:!1}}};pt.render=De;var dt=pt,bt={class:"text-lg"},ft={class:"text-sm"},mt=Object(a["h"])(" Send notification email to contacts ");function Ot(e,t,n,i,r,o){var c=Object(a["A"])("input-row"),l=Object(a["A"])("dictionary-row"),s=Object(a["A"])("button-row");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("h3",bt,"Approve Step "+Object(a["D"])(e.application.current_step),1),Object(a["i"])(c,{modelValue:r.dateApproved,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.dateApproved=e}),type:"date",errors:r.errors.date_approved,label:"Date Approved"},null,8,["modelValue","errors"]),Object(a["i"])(l,{label:""},{default:Object(a["L"])((function(){return[Object(a["i"])("label",ft,[Object(a["M"])(Object(a["i"])("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.notifyContacts=e}),value:!0},null,512),[[a["F"],r.notifyContacts]]),mt])]})),_:1}),Object(a["i"])(s,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn",onClick:t[3]||(t[3]=function(){return o.cancel&&o.cancel.apply(o,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[4]||(t[4]=function(){return o.save&&o.save.apply(o,arguments)})},"Approve step "+Object(a["D"])(e.application.current_step),1)]})),_:1})])}var jt={props:{},emits:["canceled","saved"],data:function(){return{dateApproved:null,notifyContacts:!1,notifyClinGen:!1,errors:{}}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{clearForm:function(){this.dateApproved=null},cancel:function(){this.clearForm(),this.$emit("canceled")},save:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={application:e.application,dateApproved:e.dateApproved,notifyContacts:e.notifyContacts,notifyClingen:e.notifyClinGen},t.prev=1,t.next=4,e.$store.dispatch("applications/approveCurrentStep",n);case 4:e.clearForm(),e.$emit("saved"),t.next=13;break;case 8:if(t.prev=8,t.t0=t["catch"](1),!Object(L["a"])(t.t0)){t.next=13;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 13:case"end":return t.stop()}}),t,null,[[1,8]])})))()}}};jt.render=Ot;var ht=jt,vt={components:{ApplicationLog:m,DocumentManager:dt,ApproveStepForm:ht,EditButton:lt,RemoveButton:U},props:{title:{type:String,required:!1,default:"YOU SHOULD SET A TITLE"},step:{type:Number,required:!0},documentName:{type:String,required:!1,default:'Set a document-type attribute if you don\'t use the "document" slot'},documentType:{type:Number,required:!1,default:1},documentGetsReviewed:{type:Boolean,required:!1,default:!0},approveButtonLabel:{type:String,required:!1,default:'Set "approve-button-label" if not overriding slot "approve-button"'}},emits:["documentUploaded","stepApproved"],data:function(){return{showApproveForm:!1,editApprovalDate:!1,newApprovalDate:null}},computed:Object(l["a"])(Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),{},{isCurrentStep:function(){return this.step==this.application.current_step},dateApproved:function(){return this.application.approvalDateForStep(this.step)?Object(oe["a"])(this.application.approvalDateForStep(this.step)):null}}),methods:{startApproveStep:function(){this.showApproveForm=!0},approveStep:function(){this.$store.dispatch("applications/approveCurrentStep",{application:this.application,step:this.step})},hideApproveForm:function(){this.showApproveForm=!1},initEditApprovalDate:function(){this.editApprovalDate=!0,this.newApprovalDate=this.dateApproved},updateApprovalDate:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("applications/updateApprovalDate",{application:e.application,dateApproved:e.newApprovalDate,step:e.step});case 3:e.editApprovalDate=!1,t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),Object(L["a"])(t.t0)&&(e.errors=t.t0.response.data.errors);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()}}};vt.render=Ce;var wt=vt,gt={class:"flex justify-between"},yt=Object(a["i"])("h4",{class:"text-md font-bold"},"Conflict of Interest",-1),_t={class:"my-2 flex justify-between"},Ct=Object(a["h"])(" COI URL: "),At=Object(a["h"])("   "),Dt={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"},xt={key:1};function kt(e,t,n,i,r,o){var c=Object(a["A"])("coi-legacy-upload"),l=Object(a["A"])("router-link"),s=Object(a["A"])("add-contact-control"),u=Object(a["A"])("icon-refresh"),p=Object(a["A"])("data-table"),d=Object(a["A"])("coi-detail"),b=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("div",gt,[yt,e.$store.state.features.legacyCoi?(Object(a["s"])(),Object(a["f"])(c,{key:0,application:n.application},null,8,["application"])):Object(a["g"])("",!0)]),Object(a["i"])("div",_t,[Object(a["i"])("div",null,[Ct,Object(a["i"])(l,{to:n.application.coi_url,class:"text-blue-500"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(e.$store.state.hostname)+Object(a["D"])(n.application.coi_url),1)]})),_:1},8,["to"]),At,Object(a["M"])(Object(a["i"])("a",{href:o.mailtoLink,class:"btn btn-xs",ref:"mailtobutton"},"Send url to contacts.",8,["href"]),[[a["J"],n.application.hasContacts]]),Object(a["M"])(Object(a["i"])(s,{class:"inline-block"},null,512),[[a["J"],!n.application.hasContacts]])]),Object(a["i"])(u,{height:14,width:14,class:{"animate-spin":r.refreshing},onClick:o.refresh},null,8,["class","onClick"])]),o.hasCois?Object(a["g"])("",!0):(Object(a["s"])(),Object(a["f"])("div",Dt," No Conflict of interest surveys completed ")),o.hasCois?(Object(a["s"])(),Object(a["f"])("div",xt,[Object(a["i"])(p,{fields:r.fields,data:n.application.cois},{"cell-id":Object(a["L"])((function(e){var t=e.item;return[Object(a["i"])("button",{class:"btn btn-xs",onClick:function(e){return o.showResponse(t)}},"view",8,["onClick"])]})),_:1},8,["fields","data"]),Object(a["i"])(b,{modelValue:r.showResponseDialog,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.showResponseDialog=e}),size:"xl"},{default:Object(a["L"])((function(){return[Object(a["i"])(d,{response:r.currentResponse},null,8,["response"])]})),_:1},8,["modelValue"])])):Object(a["g"])("",!0)])}n("d81d");var Rt=Object(a["i"])("g",null,[Object(a["i"])("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[Object(a["i"])("path",{d:"M10 3v2a5 5 0 0 0-3.54 8.54l-1.41 1.41A7 7 0 0 1 10 3zm4.95 2.05A7 7 0 0 1 10 17v-2a5 5 0 0 0 3.54-8.54l1.41-1.41zM10 20l-4-4 4-4v8zm0-12V0l4 4-4 4z"})])],-1);function Ft(e,t,n,i,r,o){var c=Object(a["A"])("icon-base");return Object(a["s"])(),Object(a["f"])(c,null,{default:Object(a["L"])((function(){return[Rt]})),_:1})}var Lt={props:{},data:function(){return{}},computed:{},methods:{}};Lt.render=Ft;var Vt=Lt,St={key:0},Et={class:"text-lg border-b pb-2 mb-4 font-bold"},It={key:0,class:" text-sm"},$t={key:1};function Mt(e,t,n,i,r,o){var c=Object(a["A"])("dictionary-row");return n.response?(Object(a["s"])(),Object(a["f"])("div",St,[Object(a["i"])("h4",Et," COI response for "+Object(a["D"])(n.response.first_name.response)+" "+Object(a["D"])(n.response.last_name.response),1),o.isLegacy?(Object(a["s"])(),Object(a["f"])("div",$t," This is a legacy response. ")):(Object(a["s"])(),Object(a["f"])("div",It,[Object(a["i"])(c,{label:"Email","label-class":"font-bold",class:"pb-1 mb-1 border-b"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(n.response.email.response),1)]})),_:1}),Object(a["i"])(c,{label:"Name","label-class":"font-bold",class:"pb-1 mb-1 border-b"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(n.response.first_name.response)+" "+Object(a["D"])(n.response.last_name.response),1)]})),_:1}),Object(a["i"])(c,{label:n.response.work_fee_lab.question,vertical:!0,class:"pb-1 mb-1 border-b","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.work_fee_lab.response)),1)]})),_:1},8,["label"]),Object(a["i"])(c,{label:n.response.contributions_to_gd_in_ep.question,vertical:!0,class:"pb-1 mb-1 border-b","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.contributions_to_gd_in_ep.response))+" ",1),1==n.response.contributions_to_gd_in_ep.response?(Object(a["s"])(),Object(a["f"])(c,{key:0,label:n.response.contributions_to_genes.question,vertical:!0,class:"pb-1 mb-1 ml-4","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.contributions_to_genes.response)),1)]})),_:1},8,["label"])):Object(a["g"])("",!0)]})),_:1},8,["label"]),Object(a["i"])(c,{label:n.response.independent_efforts.question,vertical:!0,class:"pb-1 mb-1 border-b","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.independent_efforts.response))+" ",1),1==n.response.independent_efforts.response?(Object(a["s"])(),Object(a["f"])(c,{key:0,label:n.response.independent_efforts_details.question,vertical:!0,class:"pb-1 mb-1 ml-4","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.independent_efforts_details.response)),1)]})),_:1},8,["label"])):Object(a["g"])("",!0)]})),_:1},8,["label"]),Object(a["i"])(c,{label:n.response.coi.question,vertical:!0,class:"pb-1 mb-1","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.coi.response))+" ",1),1==n.response.coi.response?(Object(a["s"])(),Object(a["f"])(c,{key:0,label:n.response.coi_details.question,vertical:!0,class:"pb-1 mb-1 ml-4","label-class":"font-bold"},{default:Object(a["L"])((function(){return[Object(a["h"])(Object(a["D"])(o.getQuestionValue(n.response.coi_details.response)),1)]})),_:1},8,["label"])):Object(a["g"])("",!0)]})),_:1},8,["label"])]))])):Object(a["g"])("",!0)}var Ut={props:{response:{type:Object||null,required:!0}},data:function(){return{}},computed:{isLegacy:function(){return!1}},methods:{getQuestionValue:function(e){return 1===e?"Yes":0===e?"No":e}}};Ut.render=Mt;var qt=Ut,Nt=Object(a["i"])("h4",{class:"text-lg"},"Upload a legacy COI file",-1),Tt=Object(a["h"])("   "),Pt={type:"file",ref:"fileInput"};function Bt(e,t,n,i,r,o){var c=Object(a["A"])("input-row"),l=Object(a["A"])("button-row"),s=Object(a["A"])("modal-dialog");return Object(a["s"])(),Object(a["f"])("div",null,[Object(a["i"])("button",{class:"btn btn-xs",onClick:t[1]||(t[1]=function(e){return r.showModal=!0})},"Upload COI file"),Object(a["i"])(s,{modelValue:r.showModal,"onUpdate:modelValue":t[5]||(t[5]=function(e){return r.showModal=e})},{default:Object(a["L"])((function(){return[Nt,Object(a["i"])(c,{label:"Name",type:"text",errors:o.nameErrors},{default:Object(a["L"])((function(){return[Object(a["M"])(Object(a["i"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.newCoi.first_name=e}),placeholder:"First"},null,512),[[a["I"],r.newCoi.first_name]]),Tt,Object(a["M"])(Object(a["i"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return r.newCoi.last_name=e}),placeholder:"Last"},null,512),[[a["I"],r.newCoi.last_name]])]})),_:1},8,["errors"]),Object(a["i"])(c,{label:"Email",type:"email",modelValue:r.newCoi.email,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.newCoi.email=e}),placeholder:"email@example.com",errors:r.errors.email},null,8,["modelValue","errors"]),Object(a["i"])(c,{label:"COI File",errors:r.errors.file},{default:Object(a["L"])((function(){return[Object(a["i"])("input",Pt,null,512)]})),_:1},8,["errors"]),Object(a["i"])(l,{onSubmitClicked:o.save,onCancelClicked:o.cancel,"submit-text":"Save"},null,8,["onSubmitClicked","onCancelClicked"])]})),_:1},8,["modelValue"])])}var zt=n("da95"),Gt=n("f96b"),Jt={props:{application:{type:zt["a"],required:!0}},data:function(){return{showModal:!1,newCoi:{email:null,first_name:null,last_name:null},errors:{}}},computed:{nameErrors:function(){var e=[];return this.errors.first_name&&e.push(this.errors.first_name),this.errors.last_name&&e.push(this.errors.last_name),e}},methods:{save:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.assembleFormData(e.$refs["fileInput"],e.newCoi),Gt["a"].post("/api/applications/".concat(e.application.uuid),n);case 2:case"end":return t.stop()}}),t)})))()},cancel:function(){this.clearForm(),this.showModal=!1},clearForm:function(){}},setup:function(){var e=function(e,t){var n=new FormData;return Object.keys(t).forEach((function(e){var a=t[e];null!=a&&n.append(e,a)})),n.append("file",e.files[0]),n};return{assembleFormData:e}}};Jt.render=Bt;var Qt=Jt,Yt={components:{IconRefresh:Vt,CoiDetail:qt,CoiLegacyUpload:Qt,AddContactControl:_},props:{application:{required:!0,type:Object}},data:function(){return{showResponseDialog:!1,currentResponse:null,fields:[{name:"data.first_name",label:"Name",type:String,sortable:!0,resolveValue:function(e){return"".concat(e.data.first_name," ").concat(e.data.last_name)}},{name:"data.email",label:"Email",type:String,sortable:!0},{name:"created_at",label:"Date Completed",type:Date,sortable:!0},{name:"id",label:"",sortale:!1}],refreshing:!1}},computed:{hasCois:function(){return this.application.cois&&this.application.cois.length>0},mailtoLink:function(){return"mailto:".concat(this.application.contacts.map((function(e){return e.email})).join(";"),"?subject=Your COI Link for your Expert Panel Application&body=Your expert panel's COI form: ").concat(this.$store.state.hostname).concat(this.application.coi_url,".")}},methods:{showResponse:function(e){this.currentResponse=e.response_document,this.showResponseDialog=!0},refresh:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.refreshing=!0,t.next=3,e.$store.dispatch("applications/getApplication",e.application.uuid);case 3:e.refreshing=!1;case 4:case"end":return t.stop()}}),t)})))()},mailToContacts:function(){this.$refs.mailtobutton.click()}}};Yt.render=kt;var Ht=Yt,Xt={name:"StepOne",components:{BaseStep:wt,CoiLog:Ht},data:function(){return{}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{}};Xt.render=be;var Wt=Xt;function Kt(e,t,n,i,r,o){var c=Object(a["A"])("base-step");return Object(a["s"])(),Object(a["f"])(c,{step:2,"document-type":2,"document-name":"Draft Specifications","document-gets-reviewed":!1,"approve-button-label":"Approve Draft Specifications",title:"Draft AMCG Guideline Specifications"})}var Zt={name:"StepTwo",components:{BaseStep:wt},props:{},data:function(){return{}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{}};Zt.render=Kt;var en=Zt,tn=Object(a["i"])("h3",{class:"text-lg font-bold mb-1"},"Final Specifications",-1),nn=Object(a["i"])("h3",{class:"text-lg font-bold mb-1"},"Pilot Classifications",-1);function an(e,t,n,i,r,o){var c=Object(a["A"])("document-manager"),l=Object(a["A"])("base-step");return Object(a["s"])(),Object(a["f"])(l,{step:3,"approve-button-label":"Approve Pilot and Specifications",title:"Pilot AMCG Guideline Specificiations"},{document:Object(a["L"])((function(){return[tn,Object(a["i"])(c,{application:e.application,"document-type-id":3,getsReviewd:!1,step:3,class:"mb-4"},null,8,["application"]),nn,Object(a["i"])(c,{application:e.application,"document-type-id":4,getsReviewd:!1,step:3,class:"mb-6"},null,8,["application"])]})),_:1})}var rn={name:"StepThree",components:{BaseStep:wt,DocumentManager:dt},props:{},data:function(){return{}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{formatDate:function(e){return Object(oe["a"])(e)}}};rn.render=an;var on=rn;function cn(e,t,n,i,r,o){var c=Object(a["A"])("base-step");return Object(a["s"])(),Object(a["f"])(c,{step:4,"document-type":5,"document-name":"Final Approved Application","document-gets-reviewed":!0,"approve-button-label":"Approve Final Application",title:"Final Approval"})}var ln={name:"StepFour",components:{BaseStep:wt},props:{},data:function(){return{}},computed:Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),methods:{}};ln.render=cn;var sn=ln,un={components:{StepOne:Wt,StepTwo:en,StepThree:on,StepFour:sn},data:function(){return{activeStep:1}},computed:Object(l["a"])(Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),{},{activeIndex:{deep:!0,get:function(){return this.application&&this.application.current_step?this.application.current_step-1:0},set:function(e){this.activeStep=e+1}}})};un.render=de;var pn=un,dn={name:"ApplicationDetail",components:{ApplicationLog:m,EpAttributesForm:z,NextActionBanner:W,ProgressChart:ue,StepTabs:pn},props:{uuid:{type:String,required:!0}},data:function(){return{showModal:!1}},watch:{$route:function(){this.showModal=!!this.$route.meta.showModal&&Boolean(this.$route.meta.showModal)}},computed:Object(l["a"])(Object(l["a"])({},Object(s["b"])({application:"applications/currentItem"})),{},{hasPendingNextAction:function(){return"undefined"!=typeof this.application&&this.application.latest_pending_next_action}}),methods:{hideModal:function(){this.$router.replace({name:"ApplicationDetail",params:{uuid:this.uuid}})},handleModalClosed:function(e){this.clearModalForm(e),this.$router.push({name:"ApplicationDetail",params:{uuid:this.uuid}})},clearModalForm:function(){"function"===typeof this.$refs.modalView.clearForm&&this.$refs.modalView.clearForm()}},mounted:function(){this.$store.dispatch("applications/getApplication",this.uuid),this.showModal=Boolean(this.$route.meta.showModal)}};dn.render=c;t["default"]=dn},"43c2":function(e,t,n){},"4d19":function(e,t,n){"use strict";n("9079")},5319:function(e,t,n){"use strict";var a=n("d784"),i=n("825a"),r=n("50c4"),o=n("a691"),c=n("1d80"),l=n("8aa5"),s=n("0cb2"),u=n("14c3"),p=Math.max,d=Math.min,b=function(e){return void 0===e?e:String(e)};a("replace",2,(function(e,t,n,a){var f=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,m=a.REPLACE_KEEPS_$0,O=f?"$":"$0";return[function(n,a){var i=c(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i,a):t.call(String(i),n,a)},function(e,a){if(!f&&m||"string"===typeof a&&-1===a.indexOf(O)){var c=n(t,e,this,a);if(c.done)return c.value}var j=i(e),h=String(this),v="function"===typeof a;v||(a=String(a));var w=j.global;if(w){var g=j.unicode;j.lastIndex=0}var y=[];while(1){var _=u(j,h);if(null===_)break;if(y.push(_),!w)break;var C=String(_[0]);""===C&&(j.lastIndex=l(h,r(j.lastIndex),g))}for(var A="",D=0,x=0;x<y.length;x++){_=y[x];for(var k=String(_[0]),R=p(d(o(_.index),h.length),0),F=[],L=1;L<_.length;L++)F.push(b(_[L]));var V=_.groups;if(v){var S=[k].concat(F,R,h);void 0!==V&&S.push(V);var E=String(a.apply(void 0,S))}else E=s(k,h,R,F,V,a);R>=D&&(A+=h.slice(D,R)+E,D=R+k.length)}return A+h.slice(D)}]}))},"6dbc":function(e,t,n){"use strict";n("43c2")},9079:function(e,t,n){},b2aa:function(e,t,n){"use strict";n.r(t);n("b0c0");var a=n("7a23"),i=Object(a["i"])("h4",{class:"text-lg"},"Add a contact",-1),r={class:"flex space-x-4"},o={class:"flex-1"},c={key:0,class:"pt-2 border-l pl-2 flex-1"},l=Object(a["i"])("h5",{class:"font-bold border-b mb-1 pb-1"},"Matching people",-1),s={key:1,class:"text-xs"};function u(e,t,n,u,p,d){var b=Object(a["A"])("input-row"),f=Object(a["A"])("button-row");return Object(a["s"])(),Object(a["f"])("div",null,[i,Object(a["i"])("div",r,[Object(a["i"])("div",o,[Object(a["i"])(b,{type:"text",modelValue:p.newContact.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return p.newContact.email=e}),errors:p.errors.email,placeholder:"elenor@medplace.com",label:"Email"},null,8,["modelValue","errors"]),Object(a["i"])(b,{type:"text",modelValue:p.newContact.first_name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return p.newContact.first_name=e}),errors:p.errors.first_name,placeholder:"Elenor",label:"First name"},null,8,["modelValue","errors"]),Object(a["i"])(b,{type:"text",modelValue:p.newContact.last_name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return p.newContact.last_name=e}),errors:p.errors.last_name,placeholder:"Shelstrop",label:"Last name"},null,8,["modelValue","errors"]),Object(a["i"])(b,{type:"text",modelValue:p.newContact.phone,"onUpdate:modelValue":t[4]||(t[4]=function(e){return p.newContact.phone=e}),errors:p.errors.phone,placeholder:"1-555-867-5309",label:"Phone"},null,8,["modelValue","errors"]),Object(a["i"])(f,null,{default:Object(a["L"])((function(){return[Object(a["i"])("button",{class:"btn",onClick:t[5]||(t[5]=function(){return d.cancel&&d.cancel.apply(d,arguments)})},"Cancel"),Object(a["i"])("button",{class:"btn blue",onClick:t[6]||(t[6]=function(){return d.save&&d.save.apply(d,arguments)})},"Save")]})),_:1})]),Object(a["i"])(a["b"],{name:"slide-fade"},{default:Object(a["L"])((function(){return[d.suggestedPeople.length>0?(Object(a["s"])(),Object(a["f"])("div",c,[l,Object(a["i"])("ul",null,[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(d.suggestedPeople,(function(e){return Object(a["s"])(),Object(a["f"])("li",{key:e.uuid,class:["flex justify-between my-2",{"text-gray-400":d.isAlreadyContact(e)}],title:d.isAlreadyContact(e)?"This person is already a contact for this application":""},[Object(a["h"])(Object(a["D"])(e.name)+" ",1),d.isAlreadyContact(e)?(Object(a["s"])(),Object(a["f"])("span",s,"Already a contact")):(Object(a["s"])(),Object(a["f"])("button",{key:0,class:"btn btn-xs",onClick:function(t){return d.addExistingPersonAsContact(e)}}," Add as contact ",8,["onClick"]))],10,["title"])})),128))])])):Object(a["g"])("",!0)]})),_:1})])])}n("4de4"),n("caad"),n("d81d"),n("2532"),n("96cf");var p=n("1da1"),d=n("5530"),b=n("5502"),f=n("033d"),m=n("ec26"),O={props:{},data:function(){return{createNew:!1,newContact:{first_name:null,last_name:null,email:null,phone:null,role:null,uuid:null},errors:{}}},emits:["canceled","saved","done"],computed:Object(d["a"])(Object(d["a"])({},Object(b["b"])({application:"applications/currentItem",people:"people/all"})),{},{suggestedPeople:function(){var e=this;return this.newContact.email?this.people.filter((function(t){return t.email.includes(e.newContact.email)})):[]}}),methods:{clearForm:function(){this.newContact={first_name:null,last_name:null,email:null,phone:null,role:null,uuid:null}},clearErrors:function(){this.errors={}},cancel:function(){this.clearForm(),this.$emit("canceled"),this.$emit("done")},save:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.clearErrors(),t.prev=1,n=Object(d["a"])({},e.newContact),n.uuid=Object(m["a"])(),t.next=6,e.$store.dispatch("people/createPerson",n);case 6:return a=e.$store.getters["people/personWithUuid"],t.next=9,e.$store.dispatch("applications/addContact",{application:e.application,contact:a(n.uuid)});case 9:e.clearForm(),e.$emit("saved"),e.$emit("done"),t.next=20;break;case 14:if(t.prev=14,t.t0=t["catch"](1),!Object(f["a"])(t.t0)){t.next=19;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[1,14]])})))()},addExistingPersonAsContact:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("applications/addContact",{application:t.application,contact:e});case 3:t.clearForm(),t.$emit("saved"),t.$emit("done"),n.next=14;break;case 8:if(n.prev=8,n.t0=n["catch"](0),!Object(f["a"])(n.t0)){n.next=13;break}return t.errors=n.t0.response.data.errors,n.abrupt("return");case 13:throw n.t0;case 14:case"end":return n.stop()}}),n,null,[[0,8]])})))()},isAlreadyContact:function(e){return this.application.contacts.map((function(e){return e.id})).includes(e.id)}},mounted:function(){this.$store.dispatch("people/getAll",{})}};O.render=u;t["default"]=O},fc85:function(e,t,n){"use strict";n("0bd6")}}]);
//# sourceMappingURL=application-detail.a1e0849d.js.map