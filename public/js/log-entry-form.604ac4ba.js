"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[279],{6932:function(e,t,n){n.d(t,{Jd:function(){return o},KB:function(){return c},W8:function(){return d},l8:function(){return l},wn:function(){return u}});var r=n(953),a=n(641),i=n(7684);const s=(0,r.KR)([]),o=(0,a.EW)((()=>s.value)),l=async e=>{s.value=await i.A.get(e).then((e=>e.data.data))},u=async(e,t)=>await i.A.post(e,t).then((e=>(s.value.push(e.data),e.data))),d=async(e,t)=>await i.A.put(e,t).then((e=>{const t=s.value.findIndex((t=>t.id==e.data.id));return s.value[t]=e.data,e.data})),c=async(e,t)=>await i.A.delete(`${e}/${t}`).then((e=>{const n=s.value.findIndex((e=>e.id==t));return s.value.splice(n,1),e}))},509:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var r=n(641);function a(e,t,n,a,i,s){const o=(0,r.g2)("input-row"),l=(0,r.g2)("step-input"),u=(0,r.g2)("rich-text-editor"),d=(0,r.g2)("button-row"),c=(0,r.g2)("form-container");return(0,r.uX)(),(0,r.Wv)(c,{class:"log-entry-form",ref:"form-container"},{default:(0,r.k6)((()=>[(0,r.bF)(o,{label:"Log Date",modelValue:i.newEntry.log_date,"onUpdate:modelValue":t[0]||(t[0]=e=>i.newEntry.log_date=e),errors:i.errors.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),2==s.application.expert_panel_type_id?((0,r.uX)(),(0,r.Wv)(l,{key:0,modelValue:i.newEntry.step,"onUpdate:modelValue":t[1]||(t[1]=e=>i.newEntry.step=e),errors:i.errors.step},null,8,["modelValue","errors"])):(0,r.Q3)("",!0),(0,r.bF)(o,{label:"Entry",errors:i.errors.entry},{default:(0,r.k6)((()=>[(0,r.bF)(u,{modelValue:i.newEntry.entry,"onUpdate:modelValue":t[2]||(t[2]=e=>i.newEntry.entry=e)},null,8,["modelValue"])])),_:1},8,["errors"]),(0,r.bF)(d,null,{default:(0,r.k6)((()=>[(0,r.Lk)("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,r.Lk)("button",{class:"btn blue",onClick:t[4]||(t[4]=(...e)=>s.save&&s.save(...e))},"Save")])),_:1})])),_:1},512)}n(3725),n(2598);var i=n(6278),s=n(1877),o=n(1606),l=n(5079),u=n(6932),d={name:"LogEntryForm",components:{StepInput:o["default"],RichTextEditor:l["default"]},props:{id:{required:!1,default:null}},data(){return{newEntry:{log_date:new Date,step:null,entry:""},errors:{}}},computed:{...(0,i.L8)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},watch:{id:{immediate:!0,handler:function(){const e=this.findEntry();e&&this.syncEntry(e)}},application:{immediate:!0,handler:function(){const e=this.findEntry();e&&this.syncEntry(e)}}},methods:{findEntry(){return null===this.id?null:this.logEntries?this.logEntries.find((e=>e.id==this.id)):void 0},initNewEntry(){this.newEntry={log_date:(0,s.Yq)(new Date),step:null,entry:""}},syncEntry(e){e&&(this.newEntry={id:e.id,log_date:(0,s.Yq)(new Date(Date.parse(e.created_at))),step:parseInt(e.step),entry:e.description})},cancel(){this.initNewEntry(),this.$emit("canceled")},async save(){try{this.newEntry.id?(0,u.W8)(`/api/groups/${this.group.uuid}/activity-logs/${this.newEntry.id}`,this.newEntry):(0,u.wn)(`/api/groups/${this.group.uuid}/activity-logs`,this.newEntry),this.initNewEntry(),this.$emit("saved")}catch(e){if(e.response&&422==e.response.status&&e.response.data.errors)return void(this.errors=e.response.data.errors)}}},mounted(){this.$el.querySelectorAll("input")[0].focus()},setup(){return{logEntries:u.Jd}}},c=n(6262);const p=(0,c.A)(d,[["render",a]]);var y=p}}]);
//# sourceMappingURL=log-entry-form.604ac4ba.js.map