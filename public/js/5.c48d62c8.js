"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[5],{3621:function(e,t,a){a.d(t,{A:function(){return $}});var n=a(641),r=a(3751),s=a(33);const o={key:0},i={class:"text-lg pr-4"},l={key:1,class:"well text-center"},u={class:"text-lg pr-4"};function d(e,t,a,d,m,c){const p=(0,n.g2)("evidence-summary"),h=(0,n.g2)("evidence-summary-form");return(0,n.uX)(),(0,n.CE)("div",null,[m.summaries.length>0?((0,n.uX)(),(0,n.CE)("ul",o,[(0,n.bF)(r.F,{name:"slide-fade-down"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.group.expert_panel.evidence_summaries,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{class:"my-4 flex",key:t},[(0,n.Lk)("div",i,(0,s.v_)(t+1),1),(0,n.bF)(p,{summary:e,group:c.group,onSaved:c.handleSavedSummary,onDeleted:c.handleDeleted,class:"flex-1",readonly:a.readonly},null,8,["summary","group","onSaved","onDeleted","readonly"])])))),128))])),_:1})])):m.loading?((0,n.uX)(),(0,n.CE)("div",l,"Loading...")):((0,n.uX)(),(0,n.CE)("div",{key:2,class:(0,s.C4)(["well text-center",{"cursor-pointer":!a.readonly}]),onClick:t[0]||(t[0]=(...e)=>c.startNewSummary&&c.startNewSummary(...e))},"No example evidence summaries have been added.",2)),(0,n.bo)((0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.newSummaries,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{class:"my-4 flex",key:t},[(0,n.Lk)("div",u,(0,s.v_)(t+1+m.summaries.length),1),(0,n.bF)(h,{class:"flex-1",group:c.group,summary:e,onSaved:c.handleSavedSummary,onCanceled:c.cancelAdd},null,8,["group","summary","onSaved","onCanceled"])])))),128))],512),[[r.aG,c.adding]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bo)((0,n.Lk)("button",{class:"btn btn-xs",onClick:t[1]||(t[1]=(...e)=>c.startNewSummary&&c.startNewSummary(...e))},"Add Summary",512),[[r.aG,!c.adding]])],512),[[r.aG,!c.adding&&c.canEdit]])])}const m={key:0,class:"p-2 border rounded"},c={class:"flex justify-between"},p=(0,n.Lk)("button",{class:"btn btn-xs"},"…",-1),h=(0,n.eW)("Edit"),y=(0,n.eW)("Delete"),g=["href"];function v(e,t,a,o,i,l){const u=(0,n.g2)("dropdown-item"),d=(0,n.g2)("dropdown-menu"),v=(0,n.g2)("evidence-summary-form"),f=(0,n.g2)("button-row"),b=(0,n.g2)("modal-dialog");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(r.eB,{mode:"out-in",name:"fade"},{default:(0,n.k6)((()=>[i.editing?((0,n.uX)(),(0,n.Wv)(v,{key:1,summary:a.summary,group:a.group,onSaved:l.handleSaved,onCanceled:l.cancelEdit},null,8,["summary","group","onSaved","onCanceled"])):((0,n.uX)(),(0,n.CE)("div",m,[(0,n.Lk)("header",c,[(0,n.Lk)("h4",null,(0,s.v_)(a.summary.gene.gene_symbol)+" - "+(0,s.v_)(a.summary.variant),1),l.canEdit?((0,n.uX)(),(0,n.Wv)(d,{key:0,"hide-cheveron":!0,class:"relative"},{label:(0,n.k6)((()=>[p])),default:(0,n.k6)((()=>[(0,n.bF)(u,{onClick:t[0]||(t[0]=e=>l.edit())},{default:(0,n.k6)((()=>[h])),_:1}),(0,n.bF)(u,{onClick:t[1]||(t[1]=e=>l.confirmDelete())},{default:(0,n.k6)((()=>[y])),_:1})])),_:1})):(0,n.Q3)("",!0)]),(0,n.Lk)("p",null,(0,s.v_)(a.summary.summary),1),a.summary.vci_url?((0,n.uX)(),(0,n.CE)("a",{key:0,class:"link",href:a.summary.vci_url,target:"_blank"}," View in the VCI ",8,g)):(0,n.Q3)("",!0)]))])),_:1}),((0,n.uX)(),(0,n.Wv)(n.Im,{to:"body"},[(0,n.bF)(b,{modelValue:i.showDeleteConfirm,"onUpdate:modelValue":t[2]||(t[2]=e=>i.showDeleteConfirm=e),title:"You are about to delete an example evidence summary."},{default:(0,n.k6)((()=>[(0,n.eW)(" You are about to delete an evidence summary for "+(0,s.v_)(a.summary.gene.gene_symbol)+" - "+(0,s.v_)(a.summary.variant)+". Are you sure you want to continue? ",1),(0,n.bF)(f,{onSubmit:l.deleteSummary,onCancel:l.cancelDelete,"submit-text":"Delete Summary"},null,8,["onSubmit","onCancel"])])),_:1},8,["modelValue"])]))])}var f=a(7684);const b={class:"flex space-x-2"},k=(0,n.Lk)("option",{value:null},"Select...",-1),C=["value"];function w(e,t,a,o,i,l){const u=(0,n.g2)("input-row"),d=(0,n.g2)("button-row");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",b,[(0,n.bF)(u,{class:"mt-0 mb-0",vertical:!0,label:"Gene",errors:i.errors.gene_id},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.summaryClone.gene_id=e)},[k,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.groupGenes,(e=>((0,n.uX)(),(0,n.CE)("option",{value:e.id,key:e.id},(0,s.v_)(e.gene_symbol),9,C)))),128))],512),[[r.u1,i.summaryClone.gene_id]])])),_:1},8,["errors"]),(0,n.bF)(u,{class:"mt-0 mb-0",modelValue:i.summaryClone.variant,"onUpdate:modelValue":t[1]||(t[1]=e=>i.summaryClone.variant=e),vertical:!0,label:"Variant",errors:i.errors.variant},null,8,["modelValue","errors"])]),(0,n.bF)(u,{class:"mt-0 mb-0",label:"Summary",vertical:!0,errors:i.errors.summary},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.Lk)("textarea",{rows:"5",class:"w-full","onUpdate:modelValue":t[2]||(t[2]=e=>i.summaryClone.summary=e)},null,512),[[r.Jo,i.summaryClone.summary]])])),_:1},8,["errors"]),(0,n.bF)(u,{class:"mt-0",modelValue:i.summaryClone.vci_url,"onUpdate:modelValue":t[3]||(t[3]=e=>i.summaryClone.vci_url=e),label:"VCI URL",vertical:!0,"input-class":"w-full",errors:i.errors.vci_url},null,8,["modelValue","errors"]),(0,n.bF)(d,{"submit-text":"save",onSubmit:l.save,onCancel:l.cancel},null,8,["onSubmit","onCancel"])])}var S=a(8751),_={name:"EvidenceSummaryForm",props:{group:{required:!0,type:Object},summary:{required:!0,type:Object}},emits:["saved","canceled"],data(){return{groupGenes:[],summaryClone:{gene:{}},errors:{}}},computed:{},watch:{group:{immediate:!0,handler:function(){this.group&&this.group.id&&this.getGroupGenes()}},summary:{immediate:!0,handler:function(){this.summaryClone={...this.summary}}}},methods:{async save(){try{let e=`/api/groups/${this.group.uuid}/expert-panel/evidence-summaries`,t="post";this.summaryClone.id&&(e+=`/${this.summaryClone.id}`,t="put");const a=await(0,f.A)({method:t,url:e,data:this.summaryClone}).then((e=>e.data.data));this.$emit("saved",a),this.$store.commit("pushSuccess","Saved example evidence summary"),this.editing=!1}catch(e){(0,S.A)(e)&&(this.errors=e.response.data.errors)}},cancel(){this.initSummaryClone(),this.$emit("canceled")},edit(e){e.editing=!0},async getGroupGenes(){this.groupGenes=await f.A.get(`/api/groups/${this.group.uuid}/expert-panel/genes`).then((e=>e.data))},initSummaryClone(){this.summaryClone={gene:{}}}}},D=a(6262);const E=(0,D.A)(_,[["render",w]]);var L=E,I={components:{EvidenceSummaryForm:L},name:"EvidenceSummary",props:{summary:{required:!0,type:Object},group:{required:!0,type:Object},readonly:{type:Boolean,required:!1,default:!1}},emits:["edit","saved","deleted"],data(){return{editing:!1,showDeleteConfirm:!1}},computed:{canEdit(){return this.hasAnyPermission(["ep-applications-manage",["application-edit",this.group]])&&!this.readonly}},methods:{handleSaved(e){this.$emit("saved",e),this.editing=!1},edit(){this.editing=!0},cancelEdit(){this.editing=!1},confirmDelete(){this.showDeleteConfirm=!0},async deleteSummary(){try{await f.A.delete(`/api/groups/${this.group.uuid}/application/evidence-summaries/${this.summary.id}`),this.$emit("deleted",this.summary)}catch(e){console.error(e)}this.showDeleteConfirm=!1},cancelDelete(){this.showDeleteConfirm=!1}}};const A=(0,D.A)(I,[["render",v]]);var F=A,X={name:"EvidenceSummaryList",components:{EvidenceSummary:F,EvidenceSummaryForm:L},emits:["summaries-added"],props:{readonly:{type:Boolean,required:!1,default:!1}},data(){return{newSummaries:[],errors:{},summaries:[],showDeleteConfirm:!1,selectedSummary:{gene:{}},loading:!1}},computed:{group:{get(){return this.$store.getters["groups/currentItemOrNew"]},set(e){this.$store.commit("groups/addItem",e)}},meetsRequirements(){return this.summaries.length>4},adding(){return this.newSummaries.length>0},canEdit(){return this.hasAnyPermission(["ep-applications-manage",["application-edit",this.group]])&&!this.readonly}},watch:{group:{immediate:!0,handler:function(){this.group&&this.group.id&&this.getEvidenceSummaries()}}},methods:{async getEvidenceSummaries(){this.loading=!0;try{this.summaries=await this.$store.dispatch("groups/getEvidenceSummaries",this.group)}catch(e){console.log(e)}this.loading=!1},startNewSummary(){this.readonly||this.newSummaries.push({gene:null,variant:null,summary:null})},clearNewSummaries(){this.newSummaries=[]},handleSavedSummary(){this.getEvidenceSummaries(),this.clearNewSummaries(),this.$emit("summaries-added")},handleDeleted(e){const t=this.summaries.findIndex((t=>t.id==e.id));t>-1&&this.summaries.splice(t,1),this.getEvidenceSummaries()},cancelAdd(){this.clearNewSummaries()},mergeSummary(e){const t=this.summaries.findIndex((t=>t.id==e.id));t>-1?this.summaries.splice(t,1,e):this.summaries.push(e)}}};const x=(0,D.A)(X,[["render",d]]);var $=x},8097:function(e,t,a){a.d(t,{A:function(){return P}});var n=a(641);const r=(0,n.Lk)("h3",null,"Legacy document-based specifications",-1);function s(e,t,a,s,o,i){const l=(0,n.g2)("cspec-summary"),u=(0,n.g2)("application-upload-form"),d=(0,n.g2)("collapsible");return(0,n.uX)(),(0,n.CE)("div",null,[i.cspecSummaryEnabled?((0,n.uX)(),(0,n.Wv)(l,{key:0,readonly:a.readonly},null,8,["readonly"])):(0,n.Q3)("",!0),(0,n.bF)(d,{class:"mt-4"},{title:(0,n.k6)((()=>[r])),default:(0,n.k6)((()=>[i.specificationUpload?((0,n.uX)(),(0,n.Wv)(u,{key:0,"document-type-id":a.docTypeId,"show-notes":!1,readonly:a.readonly},null,8,["document-type-id","readonly"])):(0,n.Q3)("",!0)])),_:1})])}var o=a(33);const i={key:0,class:"well mb-2"},l={key:1},u={class:"mb-2"},d=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"Specification Name"),(0,n.Lk)("th",null,"Status"),(0,n.Lk)("th",null,"Last Updated"),(0,n.Lk)("th",null," ")])],-1),m=["href"],c=["disabled"],p=(0,n.eW)(" Go to the CSpec Registry "),h=(0,n.eW)("It may take up to an hour for the latest updates in the CSPEC Registry to display here.");function y(e,t,a,r,s,y){const g=(0,n.g2)("icon-arrow-right"),v=(0,n.g2)("note");return(0,n.uX)(),(0,n.CE)("div",null,[y.hasSpecifications?((0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("table",u,[d,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(y.specifications,(t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.id},[(0,n.Lk)("td",null,(0,o.v_)(t.name),1),(0,n.Lk)("td",null,(0,o.v_)(t.status),1),(0,n.Lk)("td",null,(0,o.v_)(e.formatDate(t.updated_at)),1),(0,n.Lk)("td",null,[(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,[(0,n.Lk)("a",{target:"cspec_edit",href:`https://cspec.genome.network/cspec/ed/svi/doc/${t.cspec_id}`},"Edit",8,m)])])])])))),128))])])])):((0,n.uX)(),(0,n.CE)("div",i," No specifications on record in the CSPEC Registry. ")),(0,n.Lk)("a",{class:"btn btn-lg blue",target:"cspec-editor",disabled:a.readonly,href:"https://cspec.genome.network/"},[p,(0,n.bF)(g,{class:"inline"})],8,c),(0,n.bF)(v,{class:"mt-2"},{default:(0,n.k6)((()=>[h])),_:1})])}var g={name:"CspecSummary",props:{readonly:{type:Boolean,default:!1}},data(){return{sort:{field:"id",desc:!1},specFields:[{name:"name",type:String,sortable:!0},{name:"status",label:"Status",type:String,sortable:!0},{name:"updated_at",label:"Last Updated",type:Date,sortable:!0}]}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},hasSpecifications(){return this.group.expert_panel.specifications&&this.group.expert_panel.specifications.length>0},specifications(){return this.group.expert_panel.specifications}},watch:{group(e){this.$store.dispatch("groups/getSpecifications",e)}},methods:{goToCspec(){window.location="https://cspec.genome.network/"}},mounted(){this.$store.dispatch("groups/getSpecifications",this.group)}},v=a(6262);const f=(0,v.A)(g,[["render",y]]);var b=f;const k={key:0,class:"table"},C=(0,n.Lk)("th",null,"File",-1),w={key:0},S=(0,n.Lk)("th",null,"uploaded",-1),_=(0,n.Lk)("th",null,null,-1),D=["href"],E={class:"note"},L={key:0},I=(0,n.Lk)("button",{class:"btn btn-xs"},"…",-1),A=(0,n.eW)("Download"),F=(0,n.eW)("Delete"),X={key:1},x={type:"file",ref:"fileInput"},$={key:0},T={key:0,class:"mb-3"},V=(0,n.Lk)("p",null,"Are you sure you want to continue?",-1);function N(e,t,a,r,s,i){const l=(0,n.g2)("dropdown-item"),u=(0,n.g2)("dropdown-menu"),d=(0,n.g2)("input-row"),m=(0,n.g2)("button-row"),c=(0,n.g2)("modal-dialog");return(0,n.uX)(),(0,n.CE)("div",null,[i.documents.length>0?((0,n.uX)(),(0,n.CE)("table",k,[(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[C,i.docTypeIsArray?((0,n.uX)(),(0,n.CE)("th",w,"Type")):(0,n.Q3)("",!0),S,_])]),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.documents,(t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.id,class:"p-1 border"},[(0,n.Lk)("td",null,[(0,n.Lk)("a",{href:t.download_url},(0,o.v_)(t.filename),9,D),(0,n.Lk)("span",E," (v. "+(0,o.v_)(t.version)+")",1)]),i.docTypeIsArray?((0,n.uX)(),(0,n.CE)("td",L,(0,o.v_)(t.type.long_name),1)):(0,n.Q3)("",!0),(0,n.Lk)("td",null,(0,o.v_)(e.formatDate(t.created_at)),1),(0,n.Lk)("td",null,[(0,n.bF)(u,{hideCheveron:""},{label:(0,n.k6)((()=>[I])),default:(0,n.k6)((()=>[(0,n.bF)(l,{onClick:e=>i.initDownload(t)},{default:(0,n.k6)((()=>[A])),_:2},1032,["onClick"]),e.hasAnyPermission(["ep-applications-manage",["application-edit",i.group]])?((0,n.uX)(),(0,n.Wv)(l,{key:0,onClick:e=>i.initDelete(t)},{default:(0,n.k6)((()=>[F])),_:2},1032,["onClick"])):(0,n.Q3)("",!0)])),_:2},1024)])])))),128))])])):(0,n.Q3)("",!0),a.readonly?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",X,[i.docTypeIsArray?((0,n.uX)(),(0,n.Wv)(d,{key:0,label:"Document type",type:"select",options:i.filteredTypes,modelValue:s.newDocument.document_type_id,"onUpdate:modelValue":t[0]||(t[0]=e=>s.newDocument.document_type_id=e)},null,8,["options","modelValue"])):(0,n.Q3)("",!0),(0,n.bF)(d,{label:"Document",errors:s.errors.file},{default:(0,n.k6)((()=>[(0,n.Lk)("input",x,null,512)])),_:1},8,["errors"]),(0,n.Lk)("button",{class:"btn blue",onClick:t[1]||(t[1]=(...e)=>i.save&&i.save(...e))},"Upload")])),((0,n.uX)(),(0,n.Wv)(n.Im,{to:"body"},[(0,n.bF)(c,{modelValue:s.showDeleteConfirmation,"onUpdate:modelValue":t[2]||(t[2]=e=>s.showDeleteConfirmation=e),title:`You are about to delete ${s.activeDocument.filename}`},{default:(0,n.k6)((()=>[s.activeDocument?((0,n.uX)(),(0,n.CE)("div",$,[s.activeDocument.is_final?((0,n.uX)(),(0,n.CE)("p",T," This version has been tagged as the final version of the document. ")):(0,n.Q3)("",!0),V,(0,n.bF)(m,{"submit-text":"Delete Document",onCanceled:i.cancelDelete,onSubmitted:i.commitDelete},null,8,["onCanceled","onSubmitted"])])):(0,n.Q3)("",!0)])),_:1},8,["modelValue","title"])]))])}a(3725),a(5019),a(1339),a(9838);var W=a(1877),U=a(696),G=a(7752);const Q=G.documentsTypes;var q={props:{documentTypeId:{type:[Number,Array],required:!0},step:{type:Number,required:!1,default:null},showNotes:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},emits:["saved"],data(){return{newDocument:{file:null,date_received:(new Date).toISOString(),step:this.step},errors:{},activeDocument:{},showDeleteConfirmation:!1}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},documents(){return this.group.documents.filter((e=>this.docTypeIsArray?this.documentTypeId.includes(e.document_type_id):e.document_type_id==this.documentTypeId))},docTypeIsArray(){return Array.isArray(this.documentTypeId)},filteredTypes(){return this.docTypeIsArray?Object.values(Q).filter((e=>this.documentTypeId.includes(e.id))).map((e=>({label:e.long_name,value:e.id}))):[]},document_type_id(){return this.docTypeIsArray?null:this.documentTypeId}},methods:{async save(){try{let e=new FormData;Object.keys(this.newDocument).forEach((t=>{const a=this.newDocument[t];null!=a&&e.append(t,a)})),e.append("file",this.$refs.fileInput.files[0]),e.append("document_type_id",this.documentTypeId),await this.$store.dispatch("groups/addApplicationDocument",{group:this.group,data:e}),this.clearForm(),this.$emit("saved")}catch(e){if((0,U.Ah)(e))return void(this.errors=e.response.data.errors)}},cancel(){this.clearForm(),this.$emit("canceled")},clearForm(){this.initNewDocument(),this.clearErrors()},initNewDocument(){this.$refs.fileInput.value=null,this.newDocument={file:null,date_received:(0,W.Yq)(new Date),date_reviewed:null,step:this.step,document_type_id:this.documentTypeId,notes:null}},clearErrors(){this.errors={}},initDownload(e){window.location=e.download_url},initDelete(e){this.activeDocument=e,this.showDeleteConfirmation=!0},cancelDelete(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},async commitDelete(){await this.$store.dispatch("groups/deleteDocument",{group:this.group,document:this.activeDocument}),this.showDeleteConfirmation=!1,this.resetActiveDocument()},resetActiveDocument(){this.activeDocument={type:{}}}},mounted(){this.$store.dispatch("groups/getDocuments",this.group)}};const O=(0,v.A)(q,[["render",N]]);var j=O,B={name:"SpecificationsSection",props:{docTypeId:{required:!0,type:[Number,Array]},readonly:{type:Boolean,default:!1}},components:{CspecSummary:b,ApplicationUploadForm:j},data(){return{}},computed:{cspecSummaryEnabled(){return this.$store.state.systemInfo.app.features.cspec_summary},specificationUpload(){return this.$store.state.systemInfo.app.features.specification_upload}},methods:{}};const K=(0,v.A)(B,[["render",s]]);var P=K}}]);
//# sourceMappingURL=5.c48d62c8.js.map