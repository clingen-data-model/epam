{"version":3,"sources":["webpack:///./src/components/people/PersonDetail.vue","webpack:///./src/components/people/MembershipList.vue","webpack:///./src/components/people/MembershipList.vue?3648","webpack:///./src/components/people/PersonDetail.vue?a770"],"names":["class","_createElementVNode","_createElementBlock","_createVNode","_component_router_link","to","_ctx","name","_component_note","_toDisplayString","id","_createBlock","$props","_component_icon_edit","width","heigh","_component_dictionary_row","label","_hoisted_4","email","_hoisted_5","institution","_component_tabs_container","_component_tab_item","_component_membership_list","person","_component_person_profile","_component_coi_list","visible","$options","length","first_name","_Fragment","_renderList","key","$setup","created_at","subject","innerHTML","body","onClick","_hoisted_8","_hoisted_10","_Teleport","_component_modal_dialog","$event","title","meta","_component_router_view","$data","_component_custom_email_form","mail-data","onSent","onCanceled","_hoisted_11","_hoisted_12","_hoisted_13","_component_button_row","submit-text","onSubmitted","submit-variant","_component_data_table","fields","data","sort","rowClickHandler","row-class","props","type","Object","required","field","desc","String","sortable","resolveValue","item","roles","map","r","join","permissions","p","Date","computed","memberships","this","m","group","Group","methods","goToGroup","$router","push","params","uuid","__exports__","components","TabsContainer","MembershipList","PersonProfile","CoiList","emails","currentEmail","showResendDialog","showDeleteConfirmation","watch","immediate","handler","$store","dispatch","mapGetters","showModal","get","$route","set","value","sortedMailLog","mailLog","a","b","parse","initResend","cleanupResend","initDelete","commitDelete","go","cancelDelete","setup","formatDate","mounted","render"],"mappings":"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","file":"js/chunk-2d0d6d92.1f781606.js","sourcesContent":["<template>\n    <div>\n        <header class=\"pb-4\">\n            <router-link class=\"note\" to=\"/people\">People</router-link>\n            <h1 class=\"flex justify-between items-center\">\n                <div>\n                    {{person.name}}\n                    <note>ID: {{person.id}}</note>\n                </div>\n                <router-link \n                    :to=\"`/people/${uuid}/edit`\"\n                    class=\"btn btn-xs flex-grow-0\"\n                    v-if=\"(hasPermission('people-manage') || userIsPerson(person))\"\n                >\n                    <icon-edit width=\"16\" heigh=\"16\" />\n                </router-link>\n\n            </h1>\n            <dictionary-row label=\"Email\">\n                <template v-slot:label><strong>Email:</strong></template>\n                {{person.email}}\n            </dictionary-row>\n            <dictionary-row label=\"Institution\">\n                <template v-slot:label><strong>Institution:</strong></template>\n                {{person.institution ? person.institution.name : null}}\n            </dictionary-row>\n        </header>\n        <tabs-container>\n            <tab-item label=\"groups\">\n                <membership-list :person=\"person\"></membership-list>\n            </tab-item>\n            <tab-item label=\"Info\">\n                <person-profile :person=\"person\"></person-profile>\n            </tab-item>\n            <tab-item label=\"Conflict of Interest\">\n                <coi-list :person=\"person\"></coi-list>\n            </tab-item>\n            <!-- <tab-item label=\"Documents\">\n                docs\n            </tab-item> -->\n            <!-- <tab-item label=\"Training &amp; Attestations\">\n            </tab-item> -->\n            <tab-item label=\"Email Log\" :visible=\"hasPermission('people-manage') || userIsPerson(person)\">\n                <div v-if=\"sortedMailLog.length == 0\" class=\"well\">\n                    {{person.first_name}} has not received any mail via the GPM.\n                </div>\n                <div class=\"w-3/4 my-4 p-4 border\" v-for=\"email in sortedMailLog\" :key=\"email.id\">\n                    <dictionary-row label=\"Date/Time\">\n                        {{formatDate(email.created_at)}}\n                    </dictionary-row>\n                    <dictionary-row label=\"Subject\">\n                        {{email.subject}}\n                    </dictionary-row>\n                    <dictionary-row label=\"Body\">\n                        <div v-html=\"email.body\"></div>\n                    </dictionary-row>\n                    <button class=\"btn btn-xs\" @click.stop=\"initResend(email)\" v-if=\"hasPermission('people-manage')\">Resend</button>\n                </div>\n            </tab-item>\n            <tab-item label=\"Admin\" :visible=\"hasPermission('people-manage')\">\n                <section class=\"border my-4 p-4 bg-red-100 border-red-200 rounded\">\n                <h2 class=\"mb-4 text-red-800\">\n                    Here be dragons. Proceed with caution.\n                </h2>\n                <button class=\"btn btn red\" @click=\"initDelete\">Delete Person</button>\n                </section>\n            </tab-item>\n        </tabs-container>\n        <teleport to=\"body\">\n            <modal-dialog v-model=\"showModal\" :title=\"$route.meta.title\">\n                <router-view name=\"modal\"></router-view>\n            </modal-dialog>\n            <modal-dialog title=\"Resend Email\" v-model=\"showResendDialog\">\n                <custom-email-form :mail-data=\"currentEmail\" @sent=\"cleanupResend\" @canceled=\"cleanupResend\"></custom-email-form>\n            </modal-dialog>\n            <modal-dialog :title=\"`You are about to delete ${person.name}`\" v-model=\"showDeleteConfirmation\">\n                <p>You are about to delete this person.  All related data will also be deleted including:</p>\n                <ul class=\"list-disc pl-6\">\n                    <li>User record, system roles, and system permissions (if account is activated)</li>\n                    <li>Invite</li>\n                    <li>Group Memberships and group roles (if any)</li>\n                </ul>\n                <div class=\"border my-4 px-2 py-1 font-bold bg-red-100 border-red-200 rounded text-red-800\">\n                    This cannot be undone.\n                </div>\n                <button-row \n                    :submit-text=\"`Delete ${person.name}`\" \n                    @submitted=\"commitDelete\"  \n                    @canceled=\"cancelDelete\" \n                    submit-variant=\"red\"\n                />\n            </modal-dialog>\n        </teleport>\n    </div>\n</template>\n<script>\nimport { mapGetters } from 'vuex'\nimport {formatDateTime as formatDate} from '@/date_utils'\n\nimport TabsContainer from '../TabsContainer.vue'\nimport MembershipList from './MembershipList.vue'\nimport PersonProfile from '@/components/people/PersonProfile'\nimport CoiList from '@/components/people/CoiList'\n\nexport default {\n    name: 'PersonDetail',\n    components: { \n        TabsContainer,\n        MembershipList,\n        PersonProfile,\n        CoiList,\n    },\n    props: {\n        uuid: {\n            required: true,\n            type: String\n        }\n    },\n    data() {\n        return {\n            emails: [],\n            currentEmail: {},\n            showResendDialog: null,\n            showDeleteConfirmation: false\n        }\n    },\n    watch: {\n        uuid: {\n            immediate: true,\n            handler: function () {\n                this.$store.dispatch('people/getPerson', {uuid: this.uuid})\n            }\n        }\n    },\n    computed: {\n        ...mapGetters({\n            person: 'people/currentItem'\n        }),\n        showModal: {\n            get() {\n                return this.$route.meta.showModal\n            },\n            set(value) {\n                if (value) {\n                    this.$router.push({name: 'PersonEdit', params: {uuid: this.person.uuid}})\n                }\n                this.$router.push({name: 'PersonDetail', params: {uuid: this.person.uuid}})\n            }\n        },\n        sortedMailLog () {\n            return [...this.person.mailLog].sort((a,b) => {\n                if (a.created_at == b.created_at) {\n                    return 0;\n                }\n                return (Date.parse(a.created_at) > Date.parse(b.created_at))\n                    ? -1 : 1;\n            })\n        }\n    },\n    methods: {\n        initResend (email) {\n            this.currentEmail = {...email};\n            this.showResendDialog = true;\n        },\n        cleanupResend () {\n            this.currentEmail = {},\n            this.showResendDialog = false;\n            this.$store.dispatch('people/getMail', this.person);\n        },\n        initDelete () {\n            this.showDeleteConfirmation = true;\n        },\n        async commitDelete () {\n            await this.$store.dispatch('people/deletePerson', this.person);\n            this.showDeleteConfirmation = false;\n            this.$router.go(-1);\n        },\n        cancelDelete () {\n            this.showDeleteConfirmation = false;\n        }\n    },\n    setup() {\n        return {\n            formatDate: formatDate\n        }\n    },\n    async mounted() {\n        await this.$store.dispatch('people/getPerson', {uuid: this.uuid})\n        this.$store.dispatch('people/getMail', this.person);\n    }\n}\n</script>","<template>\n    <div>\n        <data-table \n            :fields=\"fields\" \n            :data=\"memberships\" \n            v-model:sort=\"sort\"\n            :rowClickHandler=\"goToGroup\"\n            :row-class=\"() => 'cursor-pointer'\"\n        ></data-table>\n    </div>\n</template>\n<script>\nimport {Group} from '@/domain'\n\nexport default {\n    name: 'MembershipList',\n    props: {\n        person: {\n            type: Object,\n            required: true\n        }\n    },\n    data() {\n        return {\n            sort: {\n                field: 'group.displayName',\n                desc: false\n            },\n            fields: [\n                {\n                    name: 'group.displayName',\n                    type: String,\n                    sortable: true,\n                    label: 'Name'\n                },\n                {\n                    name: 'group.type.name',\n                    type: String,\n                    sortable: true,\n                    label: 'Type'\n                },\n                {\n                    name: 'roles',\n                    type: String,\n                    sortable: false,\n                    label: 'Roles',\n                    resolveValue (item) {\n                        return item.roles.map(r => r.name).join(', ');\n                    }\n                },\n                {\n                    name: 'permissions',\n                    type: String,\n                    sortable: false,\n                    label: 'Permissions',\n                    resolveValue (item) {\n                        return item.permissions.map(p => p.name).join(', ');\n                    }\n                },\n                {\n                    name: 'start_date',\n                    type: Date,\n                    sortable: true,\n                    label: 'Started'\n                },\n                {\n                    name: 'end_date',\n                    type: Date,\n                    sortable: true,\n                    label: 'Ended'\n                }\n\n\n            ]\n        }\n    },\n    computed: {\n        memberships () {\n            if (this.person.memberships) {\n                return this.person.memberships.map(m => {\n                    if (m.group) {\n                        m.group = new Group(m.group);\n                    }\n                    return m;\n                })\n            }\n\n            return [];\n        }\n    },\n    methods: {\n        goToGroup(item) {\n            this.$router.push({name: 'GroupDetail', params: {uuid: item.group.uuid}})\n        }\n\n    }\n}\n</script>","import { render } from \"./MembershipList.vue?vue&type=template&id=7757f912\"\nimport script from \"./MembershipList.vue?vue&type=script&lang=js\"\nexport * from \"./MembershipList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./PersonDetail.vue?vue&type=template&id=2118d1a6\"\nimport script from \"./PersonDetail.vue?vue&type=script&lang=js\"\nexport * from \"./PersonDetail.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/yugen/code/epam/resources/app/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}