(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["log-entry-form"],{"598d":function(e,t,n){"use strict";n.r(t);var r=n("7a23"),o={class:"pb-2 border-b my-2 text-xl"};function a(e,t,n,a,i,c){var l=this,s=Object(r["resolveComponent"])("input-row"),u=Object(r["resolveComponent"])("step-input"),d=Object(r["resolveComponent"])("rich-text-editor"),p=Object(r["resolveComponent"])("button-row"),b=Object(r["resolveComponent"])("form-container");return Object(r["openBlock"])(),Object(r["createBlock"])(b,{class:"log-entry-form",ref:"form-container"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])("h4",o,Object(r["toDisplayString"])(l.$route.meta.title),1),Object(r["createVNode"])(s,{label:"Log Date",modelValue:i.newEntry.log_date,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.newEntry.log_date=e}),errors:i.errors.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),2==e.application.ep_type_id?(Object(r["openBlock"])(),Object(r["createBlock"])(u,{key:0,modelValue:i.newEntry.step,"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.newEntry.step=e}),errors:i.errors.step},null,8,["modelValue","errors"])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(s,{label:"Entry",errors:i.errors.entry},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,{modelValue:i.newEntry.entry,"onUpdate:modelValue":t[3]||(t[3]=function(e){return i.newEntry.entry=e})},null,8,["modelValue"])]})),_:1},8,["errors"]),Object(r["createVNode"])(p,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])("button",{class:"btn",onClick:t[4]||(t[4]=function(){return c.cancel&&c.cancel.apply(c,arguments)})},"Cancel"),Object(r["createVNode"])("button",{class:"btn blue",onClick:t[5]||(t[5]=function(){return c.save&&c.save.apply(c,arguments)})},"Save")]})),_:1})]})),_:1},512)}n("a4d3"),n("e01a"),n("7db0"),n("96cf");var i=n("1da1"),c=n("5530"),l=n("5502"),s=n("e328"),u=n("a06a"),d=n("fb3d"),p=n.n(d),b=n("85fe"),y={name:"LogEntryForm",components:{StepInput:u["a"],RichTextEditor:b["a"]},props:{id:{required:!1,default:null}},data:function(){return{newEntry:{log_date:new Date,step:null,entry:null},errors:{},editor:p.a,editorConfig:{toolbar:["bold","italic","|","link"]}}},computed:Object(c["a"])({},Object(l["b"])({application:"applications/currentItem"})),watch:{id:{immediate:!0,handler:function(){var e=this.findEntry();e&&this.syncEntry(e)}},application:{immediate:!0,handler:function(){var e=this.findEntry();e&&this.syncEntry(e)}}},methods:{findEntry:function(){var e=this;return null===this.id?null:this.application.log_entries?this.application.log_entries.find((function(t){return t.id==e.id})):void 0},initNewEntry:function(){this.newEntry={log_date:Object(s["a"])(new Date),step:null,entry:""}},syncEntry:function(e){e&&(this.newEntry={id:e.id,log_date:Object(s["a"])(new Date(Date.parse(e.created_at))),step:e.properties.step,entry:e.description})},cancel:function(){this.initNewEntry(),this.$emit("canceled")},save:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!e.newEntry.id){t.next=6;break}return t.next=4,e.$store.dispatch("applications/updateLogEntry",{application:e.application,updatedEntry:e.newEntry});case 4:t.next=8;break;case 6:return t.next=8,e.$store.dispatch("applications/addLogEntry",{application:e.application,logEntryData:e.newEntry});case 8:e.initNewEntry(),e.$emit("saved"),t.next=17;break;case 12:if(t.prev=12,t.t0=t["catch"](0),!t.t0.response||422!=t.t0.response.status||!t.t0.response.data.errors){t.next=17;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 17:case"end":return t.stop()}}),t,null,[[0,12]])})))()}},mounted:function(){this.$el.querySelectorAll("input")[0].focus()}};y.render=a;t["default"]=y}}]);
//# sourceMappingURL=log-entry-form.7b14b83e.js.map