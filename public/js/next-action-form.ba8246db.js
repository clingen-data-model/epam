(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["next-action-form"],{"76d6":function(e,t,n){"use strict";n.r(t);var o=n("7a23"),a={class:"block-title"},r=Object(o["createVNode"])("option",{value:null},"Select...",-1),c=Object(o["createVNode"])("option",{value:"Expert Panel"},"Expert Panel",-1),i=Object(o["createVNode"])("option",{value:"CDWG OC"},"CDWG OC",-1),l=Object(o["createTextVNode"])("    "),d=Object(o["createVNode"])("div",{class:"ml-4"},null,-1),s={class:"ml-36"},u=Object(o["createTextVNode"])(" This is already completed ");function p(e,t,n,p,m,b){var O=Object(o["resolveComponent"])("input-row"),f=Object(o["resolveComponent"])("step-input"),j=Object(o["resolveComponent"])("rich-text-editor"),_=Object(o["resolveComponent"])("button-row"),w=Object(o["resolveComponent"])("form-container");return Object(o["openBlock"])(),Object(o["createBlock"])(w,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("h2",a,Object(o["toDisplayString"])(b.title),1),Object(o["createVNode"])(O,{label:"Creation Date",errors:m.errors.date_created,type:"date",modelValue:m.newAction.date_created,"onUpdate:modelValue":t[1]||(t[1]=function(e){return m.newAction.date_created=e})},null,8,["errors","modelValue"]),2==e.application.ep_type_id?(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:0,modelValue:m.newAction.step,"onUpdate:modelValue":t[2]||(t[2]=function(e){return m.newAction.step=e}),errors:m.errors.step},null,8,["modelValue","errors"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(O,{label:"Target",Date:"",errors:m.errors.target_date,type:"date",modelValue:m.newAction.target_date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return m.newAction.target_date=e})},null,8,["errors","modelValue"]),Object(o["createVNode"])(O,{label:"Entry",errors:m.errors.entry},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(j,{modelValue:m.newAction.entry,"onUpdate:modelValue":t[4]||(t[4]=function(e){return m.newAction.entry=e})},null,8,["modelValue"])]})),_:1},8,["errors"]),Object(o["createVNode"])(O,{label:"Assigned To",errors:b.assignmentErrors},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])("select",{id:"","onUpdate:modelValue":t[5]||(t[5]=function(e){return m.newAction.assigned_to=e})},[r,c,i],512),[[o["vModelSelect"],m.newAction.assigned_to]]),l,Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"text",label:"Name","onUpdate:modelValue":t[6]||(t[6]=function(e){return m.newAction.assigned_to_name=e}),placeholder:"Name (optional)"},null,512),[[o["vModelText"],m.newAction.assigned_to_name]])]})),_:1},8,["errors"]),d,Object(o["createVNode"])("label",s,[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=function(e){return m.completed=e})},null,512),[[o["vModelCheckbox"],m.completed]]),u]),m.completed?(Object(o["openBlock"])(),Object(o["createBlock"])(O,{key:1,label:"Date Completed",errors:m.errors.date_completed,class:"ml-36"},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=function(e){return m.newAction.date_completed=e})},null,512),[[o["vModelText"],m.newAction.date_completed]])]})),_:1},8,["errors"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(_,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("button",{class:"btn",onClick:t[9]||(t[9]=function(){return b.cancel&&b.cancel.apply(b,arguments)})},"Cancel"),Object(o["createVNode"])("button",{class:"btn blue",onClick:t[10]||(t[10]=function(){return b.save&&b.save.apply(b,arguments)})},"Save")]})),_:1})]})),_:1})}n("99af"),n("7db0"),n("96cf");var m=n("1da1"),b=n("2909"),O=n("5530"),f=n("a06a"),j=n("5502"),_=n("85fe"),w=n("e328"),h={name:"NextActionForm",components:{StepInput:f["a"],RichTextEditor:_["a"]},props:{id:{required:!1,default:null}},emits:["saved","closed","formCleared","canceled"],data:function(){return{errors:{},newAction:{date_created:new Date,step:null,date_completed:null,entry:"",assigned_to:null,assigned_to_name:null},completed:!1}},computed:Object(O["a"])(Object(O["a"])({},Object(j["b"])({application:"applications/currentItem"})),{},{title:function(){return this.newAction.id?"Update Action":"Add Next Action"},steps:function(){return[1,2,3,4]},assignmentErrors:function(){var e=[];return this.errors.assigned_to&&(e=[].concat(Object(b["a"])(e),Object(b["a"])(this.errors.assigned_to))),this.errors.assigned_to_name&&(e=[].concat(Object(b["a"])(e),Object(b["a"])(this.errors.assigned_to_name))),e}}),watch:{id:{immediate:!0,handler:function(){var e=this.findAction();e&&this.syncAction(e)}},application:{immediate:!0,handler:function(){var e=this.findAction();e&&this.syncAction(e)}}},methods:{cancel:function(){this.clearForm(),this.$emit("canceled")},clearForm:function(){console.log("clearForm()"),this.initNewAction(),this.$emit("formCleared")},initNewAction:function(){this.newAction={date_created:new Date,step:null,target_date:null,date_completed:null,entry:"",assigned_to:null,assigned_to_name:null}},findAction:function(){var e=this;return null===this.id?null:this.application.next_actions?this.application.next_actions.find((function(t){return t.id==e.id})):void 0},syncAction:function(e){var t;e&&(this.newAction={id:e.id,uuid:e.uuid,date_created:Object(w["a"])(e.created_at),step:e.step,target_date:Object(w["a"])(e.target_date),date_completed:Object(w["a"])(e.date_completed),entry:null!==(t=e.entry)&&void 0!==t?t:"",assigned_to:e.assigned_to,assigned_to_name:e.assigned_to_name})},save:function(){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("save!"),console.info("this.newAction",e.newAction),t.prev=2,!e.newAction.id){t.next=10;break}return t.next=6,e.$store.dispatch("applications/updateNextAction",{application:e.application,updatedAction:e.newAction});case 6:e.$emit("saved"),e.clearForm(),t.next=14;break;case 10:return t.next=12,e.$store.dispatch("applications/addNextAction",{application:e.application,nextActionData:e.newAction});case 12:e.$emit("saved"),e.clearForm();case 14:t.next=21;break;case 16:if(t.prev=16,t.t0=t["catch"](2),!t.t0.response||422!=t.t0.response.status||!t.t0.response.data.errors){t.next=21;break}return e.errors=t.t0.response.data.errors,t.abrupt("return");case 21:case"end":return t.stop()}}),t,null,[[2,16]])})))()}},unmounted:function(){this.initNewAction()},mounted:function(){}};h.render=p;t["default"]=h}}]);
//# sourceMappingURL=next-action-form.ba8246db.js.map